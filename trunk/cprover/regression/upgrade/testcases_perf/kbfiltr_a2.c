
void abort(void);
/* Generated by Frontc */


#define __cdecl
#define _cdecl
#define __int64 long long
#define __stdcall 
#define __declspec(x) 
#define _fastcall 
#define __inline

#pragma pack(push, 8)

typedef enum _EXCEPTION_DISPOSITION {
	ExceptionContinueExecution,
	ExceptionContinueSearch,
	ExceptionNestedException,
	ExceptionCollidedUnwind
} EXCEPTION_DISPOSITION ;


struct _EXCEPTION_RECORD ;


struct _CONTEXT ;

EXCEPTION_DISPOSITION __cdecl _except_handler(struct _EXCEPTION_RECORD * 
	ExceptionRecord , void *  EstablisherFrame , struct _CONTEXT * 
	ContextRecord , void *  DispatcherContext ) ;

unsigned long __cdecl _exception_code(void  ) ;
void * __cdecl _exception_info(void  ) ;
int __cdecl _abnormal_termination(void  ) ;



#pragma pack(pop)


#pragma once


#pragma once

typedef unsigned short wchar_t ;


typedef wchar_t wint_t ;


typedef wchar_t wctype_t ;


int __cdecl _isctype(int  , int  ) ;
int __cdecl isalpha(int  ) ;
int __cdecl isupper(int  ) ;
int __cdecl islower(int  ) ;
int __cdecl isdigit(int  ) ;
int __cdecl isxdigit(int  ) ;
int __cdecl isspace(int  ) ;
int __cdecl ispunct(int  ) ;
int __cdecl isalnum(int  ) ;
int __cdecl isprint(int  ) ;
int __cdecl isgraph(int  ) ;
int __cdecl iscntrl(int  ) ;
int __cdecl toupper(int  ) ;
int __cdecl tolower(int  ) ;
int __cdecl _tolower(int  ) ;
int __cdecl _toupper(int  ) ;
int __cdecl __isascii(int  ) ;
int __cdecl __toascii(int  ) ;
int __cdecl __iscsymf(int  ) ;
int __cdecl __iscsym(int  ) ;

int __cdecl iswalpha(wint_t ) ;
int __cdecl iswupper(wint_t ) ;
int __cdecl iswlower(wint_t ) ;
int __cdecl iswdigit(wint_t ) ;
int __cdecl iswxdigit(wint_t ) ;
int __cdecl iswspace(wint_t ) ;
int __cdecl iswpunct(wint_t ) ;
int __cdecl iswalnum(wint_t ) ;
int __cdecl iswprint(wint_t ) ;
int __cdecl iswgraph(wint_t ) ;
int __cdecl iswcntrl(wint_t ) ;
int __cdecl iswascii(wint_t ) ;
int __cdecl isleadbyte(int  ) ;

wchar_t __cdecl towupper(wchar_t ) ;
wchar_t __cdecl towlower(wchar_t ) ;

int __cdecl iswctype(wint_t , wctype_t ) ;

int __cdecl is_wctype(wint_t , wctype_t ) ;


typedef unsigned long POINTER_64_INT ;



#pragma once

typedef int LONG32 , *  PLONG32 ;


typedef int INT32 , *  PINT32 ;


typedef unsigned int ULONG32 , *  PULONG32 ;


typedef unsigned int DWORD32 , *  PDWORD32 ;


typedef unsigned int UINT32 , *  PUINT32 ;


typedef int INT_PTR , *  PINT_PTR ;


typedef unsigned int UINT_PTR , *  PUINT_PTR ;

typedef long LONG_PTR , *  PLONG_PTR ;


typedef unsigned long ULONG_PTR , *  PULONG_PTR ;


typedef unsigned short UHALF_PTR , *  PUHALF_PTR ;


typedef short HALF_PTR , *  PHALF_PTR ;


typedef unsigned long HANDLE_PTR ;


typedef ULONG_PTR SIZE_T , *  PSIZE_T ;


typedef LONG_PTR SSIZE_T , *  PSSIZE_T ;


typedef ULONG_PTR DWORD_PTR , *  PDWORD_PTR ;


typedef __int64 LONG64 , *  PLONG64 ;


typedef __int64 INT64 , *  PINT64 ;


typedef unsigned __int64 ULONG64 , *  PULONG64 ;


typedef unsigned __int64 DWORD64 , *  PDWORD64 ;


typedef unsigned __int64 UINT64 , *  PUINT64 ;


typedef void *  PVOID ;


typedef void *  PVOID64 ;


typedef char CHAR ;


typedef short SHORT ;


typedef long LONG ;


typedef wchar_t WCHAR ;


typedef WCHAR *  PWCHAR ;


typedef WCHAR *  LPWCH , *  PWCH ;


typedef const WCHAR *  LPCWCH , *  PCWCH ;


typedef WCHAR *  NWPSTR ;


typedef WCHAR *  LPWSTR , *  PWSTR ;

typedef const WCHAR *  LPCWSTR , *  PCWSTR ;


typedef CHAR *  PCHAR ;


typedef CHAR *  LPCH , *  PCH ;

typedef const CHAR *  LPCCH , *  PCCH ;


typedef CHAR *  NPSTR ;


typedef CHAR *  LPSTR , *  PSTR ;


typedef const CHAR *  LPCSTR , *  PCSTR ;


typedef char TCHAR , *  PTCHAR ;


typedef unsigned char TUCHAR , *  PTUCHAR ;


typedef LPSTR LPTCH , PTCH ;


typedef LPSTR PTSTR , LPTSTR ;


typedef LPCSTR PCTSTR , LPCTSTR ;


typedef double DOUBLE ;

typedef struct _QUAD {
	double DoNotUseThisField ;
} QUAD ;


typedef SHORT *  PSHORT ;


typedef LONG *  PLONG ;


typedef QUAD *  PQUAD ;


typedef unsigned char UCHAR ;


typedef unsigned short USHORT ;


typedef unsigned long ULONG ;


typedef QUAD UQUAD ;


typedef UCHAR *  PUCHAR ;


typedef USHORT *  PUSHORT ;


typedef ULONG *  PULONG ;


typedef UQUAD *  PUQUAD ;


typedef signed char SCHAR ;


typedef SCHAR *  PSCHAR ;


typedef void *  HANDLE ;


typedef HANDLE *  PHANDLE ;


typedef UCHAR FCHAR ;


typedef USHORT FSHORT ;


typedef ULONG FLONG ;


typedef LONG HRESULT ;


typedef char CCHAR ;


typedef short CSHORT ;


typedef ULONG CLONG ;

typedef CCHAR *  PCCHAR ;


typedef CSHORT *  PCSHORT ;


typedef CLONG *  PCLONG ;


typedef ULONG LCID ;


typedef PULONG PLCID ;


typedef USHORT LANGID ;


typedef ULONG LOGICAL ;


typedef ULONG *  PLOGICAL ;


typedef LONG NTSTATUS ;

typedef NTSTATUS *  PNTSTATUS ;


typedef struct _FLOAT128 {
	__int64 LowPart ;
	__int64 HighPart ;
} FLOAT128 ;

typedef FLOAT128 *  PFLOAT128 ;


typedef __int64 LONGLONG ;


typedef unsigned __int64 ULONGLONG ;


typedef LONGLONG *  PLONGLONG ;


typedef ULONGLONG *  PULONGLONG ;


typedef LONGLONG USN ;


typedef union _LARGE_INTEGER {
	struct  {
		ULONG LowPart ;
		LONG HighPart ;
	}  ;
	struct  {
		ULONG LowPart ;
		LONG HighPart ;
	} u ;
	LONGLONG QuadPart ;
} LARGE_INTEGER ;


typedef LARGE_INTEGER *  PLARGE_INTEGER ;


typedef union _ULARGE_INTEGER {
	struct  {
		ULONG LowPart ;
		ULONG HighPart ;
	}  ;
	struct  {
		ULONG LowPart ;
		ULONG HighPart ;
	} u ;
	ULONGLONG QuadPart ;
} ULARGE_INTEGER ;


typedef ULARGE_INTEGER *  PULARGE_INTEGER ;


typedef struct _LUID {
	ULONG LowPart ;
	LONG HighPart ;
} LUID , *  PLUID ;


typedef ULONGLONG DWORDLONG ;


typedef DWORDLONG *  PDWORDLONG ;


typedef LARGE_INTEGER PHYSICAL_ADDRESS , *  PPHYSICAL_ADDRESS ;


ULONGLONG __stdcall Int64ShllMod32(ULONGLONG Value , ULONG ShiftCount ) ;

LONGLONG __stdcall Int64ShraMod32(LONGLONG Value , ULONG ShiftCount ) ;

ULONGLONG __stdcall Int64ShrlMod32(ULONGLONG Value , ULONG ShiftCount ) ;



#pragma warning(push)

#pragma warning(disable:4035)
__inline ULONGLONG __stdcall Int64ShllMod32___0(ULONGLONG Value , ULONG
	ShiftCount )
{
	
/*
	__asm {
        mov     ecx, ShiftCount
        mov     eax, dword ptr [Value]
        mov     edx, dword ptr [Value+4]
        shld    edx, eax, cl
        shl     eax, cl
    
		};
*/
}


__inline LONGLONG __stdcall Int64ShraMod32___0(LONGLONG Value , ULONG ShiftCount
	)
{
	
/*
	__asm {
        mov     ecx, ShiftCount
        mov     eax, dword ptr [Value]
        mov     edx, dword ptr [Value+4]
        shrd    eax, edx, cl
        sar     edx, cl
    
		};
*/
}


__inline ULONGLONG __stdcall Int64ShrlMod32___0(ULONGLONG Value , ULONG
	ShiftCount )
{
	
/*
	__asm {
        mov     ecx, ShiftCount
        mov     eax, dword ptr [Value]
        mov     edx, dword ptr [Value+4]
        shrd    eax, edx, cl
        shr     edx, cl
    
		};
*/
}


#pragma warning(pop)

typedef enum _EVENT_TYPE {
	NotificationEvent,
	SynchronizationEvent
} EVENT_TYPE ;


typedef enum _TIMER_TYPE {
	NotificationTimer,
	SynchronizationTimer
} TIMER_TYPE ;


typedef enum _WAIT_TYPE {
	WaitAll,
	WaitAny
} WAIT_TYPE ;


typedef CHAR *  PSZ ;


typedef const char *  PCSZ ;


typedef struct _STRING {
	USHORT Length ;
	USHORT MaximumLength ;
	PCHAR Buffer ;
} STRING ;


typedef STRING *  PSTRING ;

typedef STRING ANSI_STRING ;


typedef PSTRING PANSI_STRING ;

typedef STRING OEM_STRING ;


typedef PSTRING POEM_STRING ;


typedef struct _CSTRING {
	USHORT Length ;
	USHORT MaximumLength ;
	const char *  Buffer ;
} CSTRING ;


typedef CSTRING *  PCSTRING ;


typedef STRING CANSI_STRING ;


typedef PSTRING PCANSI_STRING ;


typedef struct _UNICODE_STRING {
	USHORT Length ;
	USHORT MaximumLength ;
	PWSTR Buffer ;
} UNICODE_STRING ;


typedef UNICODE_STRING *  PUNICODE_STRING ;


typedef const UNICODE_STRING *  PCUNICODE_STRING ;


typedef UCHAR BOOLEAN ;


typedef BOOLEAN *  PBOOLEAN ;


typedef struct _LIST_ENTRY {
	struct _LIST_ENTRY *  Flink ;
	struct _LIST_ENTRY *  Blink ;
} LIST_ENTRY , *  PLIST_ENTRY , *  PRLIST_ENTRY ;


typedef struct _SINGLE_LIST_ENTRY {
	struct _SINGLE_LIST_ENTRY *  Next ;
} SINGLE_LIST_ENTRY , *  PSINGLE_LIST_ENTRY ;


typedef struct LIST_ENTRY32 {
	ULONG Flink ;
	ULONG Blink ;
} LIST_ENTRY32 ;


typedef LIST_ENTRY32 *  PLIST_ENTRY32 ;

typedef struct LIST_ENTRY64 {
	ULONGLONG Flink ;
	ULONGLONG Blink ;
} LIST_ENTRY64 ;


typedef LIST_ENTRY64 *  PLIST_ENTRY64 ;


__inline void ListEntry32To64(PLIST_ENTRY32 l32 , PLIST_ENTRY64 l64 )
{
	
	l64->Flink = (ULONGLONG )((LONGLONG )((LONG )l32->Flink));
	l64->Blink = (ULONGLONG )((LONGLONG )((LONG )l32->Blink));
}

__inline void ListEntry64To32(PLIST_ENTRY64 l64 , PLIST_ENTRY32 l32 )
{
	
	l32->Flink = (ULONG )l64->Flink;
	l32->Blink = (ULONG )l64->Blink;
}


typedef struct _STRING32 {
	USHORT Length ;
	USHORT MaximumLength ;
	ULONG Buffer ;
} STRING32 ;


typedef STRING32 *  PSTRING32 ;

typedef STRING32 UNICODE_STRING32 ;


typedef UNICODE_STRING32 *  PUNICODE_STRING32 ;

typedef STRING32 ANSI_STRING32 ;


typedef ANSI_STRING32 *  PANSI_STRING32 ;


typedef struct _STRING64 {
	USHORT Length ;
	USHORT MaximumLength ;
	ULONGLONG Buffer ;
} STRING64 ;


typedef STRING64 *  PSTRING64 ;

typedef STRING64 UNICODE_STRING64 ;


typedef UNICODE_STRING64 *  PUNICODE_STRING64 ;

typedef STRING64 ANSI_STRING64 ;


typedef ANSI_STRING64 *  PANSI_STRING64 ;


typedef struct _OBJECT_ATTRIBUTES {
	ULONG Length ;
	HANDLE RootDirectory ;
	PUNICODE_STRING ObjectName ;
	ULONG Attributes ;
	PVOID SecurityDescriptor ;
	PVOID SecurityQualityOfService ;
} OBJECT_ATTRIBUTES ;


typedef OBJECT_ATTRIBUTES *  POBJECT_ATTRIBUTES ;


typedef struct _GUID {
	unsigned long Data1 ;
	unsigned short Data2 ;
	unsigned short Data3 ;
	unsigned char Data4[8] ;
} GUID ;


typedef GUID *  LPGUID ;


typedef const GUID *  LPCGUID ;


typedef GUID IID ;


typedef IID *  LPIID ;


typedef GUID CLSID ;


typedef CLSID *  LPCLSID ;


typedef GUID FMTID ;


typedef FMTID *  LPFMTID ;



#pragma once

typedef unsigned int size_t ;


void __cdecl memcpy(void *  p, const void *  , size_t ) {};
int __cdecl memcmp(const void *  , const void *  , size_t ) ;
void __cdecl memset(void *  p, int  , size_t ) {}
char * __cdecl _strset(char *  , int  ) ;
char * __cdecl strcpy(char *  , const char *  ) ;
char * __cdecl strcat(char *  , const char *  ) ;
int __cdecl strcmp(const char *  , const char *  ) ;
size_t __cdecl strlen(const char *  ) ;

void * __cdecl _memccpy(void *  , const void *  , int  , size_t ) ;
void * __cdecl memchr(const void *  , int  , size_t ) ;
int __cdecl _memicmp(const void *  , const void *  , size_t ) ;

void * __cdecl memmove(void *  , const void *  , size_t ) ;

char * __cdecl strchr(const char *  , int  ) ;
int __cdecl _strcmpi(const char *  , const char *  ) ;
int __cdecl _stricmp(const char *  , const char *  ) ;
int __cdecl strcoll(const char *  , const char *  ) ;
int __cdecl _stricoll(const char *  , const char *  ) ;
int __cdecl _strncoll(const char *  , const char *  , size_t ) ;
int __cdecl _strnicoll(const char *  , const char *  , size_t ) ;
size_t __cdecl strcspn(const char *  , const char *  ) ;
char * __cdecl _strdup(const char *  ) ;
char * __cdecl _strerror(const char *  ) ;
char * __cdecl strerror(int  ) ;
char * __cdecl _strlwr(char *  ) ;
char * __cdecl strncat(char *  , const char *  , size_t ) ;
int __cdecl strncmp(const char *  , const char *  , size_t ) ;
int __cdecl _strnicmp(const char *  , const char *  , size_t ) ;
char * __cdecl strncpy(char *  , const char *  , size_t ) ;
char * __cdecl _strnset(char *  , int  , size_t ) ;
char * __cdecl strpbrk(const char *  , const char *  ) ;
char * __cdecl strrchr(const char *  , int  ) ;
char * __cdecl _strrev(char *  ) ;
size_t __cdecl strspn(const char *  , const char *  ) ;
char * __cdecl strstr(const char *  , const char *  ) ;
char * __cdecl strtok(char *  , const char *  ) ;
char * __cdecl _strupr(char *  ) ;
size_t __cdecl strxfrm(char *  , const char *  , size_t ) ;

void * __cdecl memccpy(void *  , const void *  , int  , size_t ) ;
int __cdecl memicmp(const void *  , const void *  , size_t ) ;
int __cdecl strcmpi(const char *  , const char *  ) ;
int __cdecl stricmp(const char *  , const char *  ) ;
char * __cdecl strdup(const char *  ) ;
char * __cdecl strlwr(char *  ) ;
int __cdecl strnicmp(const char *  , const char *  , size_t ) ;
char * __cdecl strnset(char *  , int  , size_t ) ;
char * __cdecl strrev(char *  ) ;
char * __cdecl strset(char *  , int  ) ;
char * __cdecl strupr(char *  ) ;

wchar_t * __cdecl wcscat(wchar_t *  , const wchar_t *  ) ;
wchar_t * __cdecl wcschr(const wchar_t *  , wchar_t ) ;
int __cdecl wcscmp(const wchar_t *  , const wchar_t *  ) ;
wchar_t * __cdecl wcscpy(wchar_t *  , const wchar_t *  ) ;
size_t __cdecl wcscspn(const wchar_t *  , const wchar_t *  ) ;
size_t __cdecl wcslen(const wchar_t *  ) ;
wchar_t * __cdecl wcsncat(wchar_t *  , const wchar_t *  , size_t ) ;
int __cdecl wcsncmp(const wchar_t *  , const wchar_t *  , size_t ) ;
wchar_t * __cdecl wcsncpy(wchar_t *  , const wchar_t *  , size_t ) ;
wchar_t * __cdecl wcspbrk(const wchar_t *  , const wchar_t *  ) ;
wchar_t * __cdecl wcsrchr(const wchar_t *  , wchar_t ) ;
size_t __cdecl wcsspn(const wchar_t *  , const wchar_t *  ) ;
wchar_t * __cdecl wcsstr(const wchar_t *  , const wchar_t *  ) ;
wchar_t * __cdecl wcstok(wchar_t *  , const wchar_t *  ) ;

wchar_t * __cdecl _wcsdup(const wchar_t *  ) ;
int __cdecl _wcsicmp(const wchar_t *  , const wchar_t *  ) ;
int __cdecl _wcsnicmp(const wchar_t *  , const wchar_t *  , size_t ) ;
wchar_t * __cdecl _wcsnset(wchar_t *  , wchar_t , size_t ) ;
wchar_t * __cdecl _wcsrev(wchar_t *  ) ;
wchar_t * __cdecl _wcsset(wchar_t *  , wchar_t ) ;

wchar_t * __cdecl _wcslwr(wchar_t *  ) ;
wchar_t * __cdecl _wcsupr(wchar_t *  ) ;
size_t __cdecl wcsxfrm(wchar_t *  , const wchar_t *  , size_t ) ;
int __cdecl wcscoll(const wchar_t *  , const wchar_t *  ) ;
int __cdecl _wcsicoll(const wchar_t *  , const wchar_t *  ) ;
int __cdecl _wcsncoll(const wchar_t *  , const wchar_t *  , size_t ) ;
int __cdecl _wcsnicoll(const wchar_t *  , const wchar_t *  , size_t ) ;

wchar_t * __cdecl wcsdup(const wchar_t *  ) ;
int __cdecl wcsicmp(const wchar_t *  , const wchar_t *  ) ;
int __cdecl wcsnicmp(const wchar_t *  , const wchar_t *  , size_t ) ;
wchar_t * __cdecl wcsnset(wchar_t *  , wchar_t , size_t ) ;
wchar_t * __cdecl wcsrev(wchar_t *  ) ;
wchar_t * __cdecl wcsset(wchar_t *  , wchar_t ) ;
wchar_t * __cdecl wcslwr(wchar_t *  ) ;
wchar_t * __cdecl wcsupr(wchar_t *  ) ;
int __cdecl wcsicoll(const wchar_t *  , const wchar_t *  ) ;


typedef struct _OBJECTID {
	GUID Lineage ;
	ULONG Uniquifier ;
} OBJECTID ;


struct _CONTEXT ;


struct _EXCEPTION_RECORD ;

typedef EXCEPTION_DISPOSITION ( *  PEXCEPTION_ROUTINE
	)(struct _EXCEPTION_RECORD *  ExceptionRecord , PVOID EstablisherFrame ,
	struct _CONTEXT *  ContextRecord , PVOID DispatcherContext ) ;


typedef UCHAR KIRQL ;

typedef KIRQL *  PKIRQL ;


typedef enum _NT_PRODUCT_TYPE {
	NtProductWinNt = 1,
	NtProductLanManNt,
	NtProductServer
} NT_PRODUCT_TYPE , *  PNT_PRODUCT_TYPE ;


typedef enum _SUITE_TYPE {
	SmallBusiness,
	Enterprise,
	BackOffice,
	CommunicationServer,
	TerminalServer,
	SmallBusinessRestricted,
	EmbeddedNT,
	DataCenter,
	SingleUserTS,
	MaxSuiteType
} SUITE_TYPE ;


typedef struct _KTHREAD *  PKTHREAD ;


typedef struct _ETHREAD *  PETHREAD ;


typedef struct _EPROCESS *  PEPROCESS ;


typedef struct _PEB *  PPEB ;


typedef struct _KINTERRUPT *  PKINTERRUPT ;


typedef struct _IO_TIMER *  PIO_TIMER ;


typedef struct _OBJECT_TYPE *  POBJECT_TYPE ;


typedef struct _CALLBACK_OBJECT *  PCALLBACK_OBJECT___0 ;


typedef struct _DEVICE_HANDLER_OBJECT *  PDEVICE_HANDLER_OBJECT ;


typedef struct _BUS_HANDLER *  PBUS_HANDLER ;


PKTHREAD __stdcall KeGetCurrentThread() ;

extern PCCHAR KeNumberProcessors ;


typedef union _SLIST_HEADER {
	ULONGLONG Alignment ;
	struct  {
		SINGLE_LIST_ENTRY Next ;
		USHORT Depth ;
		USHORT Sequence ;
	}  ;
} SLIST_HEADER , *  PSLIST_HEADER ;


typedef CCHAR KPROCESSOR_MODE ;

typedef enum _MODE {
	KernelMode,
	UserMode,
	MaximumMode
} MODE ;


struct _KAPC ;

typedef void ( *  PKNORMAL_ROUTINE )(PVOID NormalContext , PVOID SystemArgument1
	, PVOID SystemArgument2 ) ;


typedef void ( *  PKKERNEL_ROUTINE )(struct _KAPC *  Apc , PKNORMAL_ROUTINE * 
	NormalRoutine , PVOID *  NormalContext , PVOID *  SystemArgument1 ,
	PVOID *  SystemArgument2 ) ;


typedef void ( *  PKRUNDOWN_ROUTINE )(struct _KAPC *  Apc ) ;


typedef BOOLEAN ( *  PKSYNCHRONIZE_ROUTINE )(PVOID SynchronizeContext ) ;


typedef BOOLEAN ( *  PKTRANSFER_ROUTINE )(void  ) ;


typedef struct _KAPC {
	CSHORT Type ;
	CSHORT Size ;
	ULONG Spare0 ;
	struct _KTHREAD *  Thread ;
	LIST_ENTRY ApcListEntry ;
	PKKERNEL_ROUTINE KernelRoutine ;
	PKRUNDOWN_ROUTINE RundownRoutine ;
	PKNORMAL_ROUTINE NormalRoutine ;
	PVOID NormalContext ;
	PVOID SystemArgument1 ;
	PVOID SystemArgument2 ;
	CCHAR ApcStateIndex ;
	KPROCESSOR_MODE ApcMode ;
	BOOLEAN Inserted ;
} KAPC , *  PKAPC , *  PRKAPC ;


struct _KDPC ;

typedef void ( *  PKDEFERRED_ROUTINE )(struct _KDPC *  Dpc , PVOID
	DeferredContext , PVOID SystemArgument1 , PVOID SystemArgument2 ) ;


typedef enum _KDPC_IMPORTANCE {
	LowImportance,
	MediumImportance,
	HighImportance
} KDPC_IMPORTANCE ;


typedef struct _KDPC {
	CSHORT Type ;
	UCHAR Number ;
	UCHAR Importance ;
	LIST_ENTRY DpcListEntry ;
	PKDEFERRED_ROUTINE DeferredRoutine ;
	PVOID DeferredContext ;
	PVOID SystemArgument1 ;
	PVOID SystemArgument2 ;
	PULONG_PTR Lock ;
} KDPC , *  PKDPC , *  PRKDPC ;


typedef PVOID PKIPI_CONTEXT ;

typedef void ( *  PKIPI_WORKER )(PKIPI_CONTEXT PacketContext , PVOID Parameter1
	, PVOID Parameter2 , PVOID Parameter3 ) ;


typedef struct _KIPI_COUNTS {
	ULONG Freeze ;
	ULONG Packet ;
	ULONG DPC ;
	ULONG APC ;
	ULONG FlushSingleTb ;
	ULONG FlushMultipleTb ;
	ULONG FlushEntireTb ;
	ULONG GenericCall ;
	ULONG ChangeColor ;
	ULONG SweepDcache ;
	ULONG SweepIcache ;
	ULONG SweepIcacheRange ;
	ULONG FlushIoBuffers ;
	ULONG GratuitousDPC ;
} KIPI_COUNTS , *  PKIPI_COUNTS ;


typedef struct _MDL {
	struct _MDL *  Next ;
	CSHORT Size ;
	CSHORT MdlFlags ;
	struct _EPROCESS *  Process ;
	PVOID MappedSystemVa ;
	PVOID StartVa ;
	ULONG ByteCount ;
	ULONG ByteOffset ;
} MDL , *  PMDL ;


typedef PVOID PACCESS_TOKEN ;


typedef PVOID PSECURITY_DESCRIPTOR ;


typedef PVOID PSID ;

typedef ULONG ACCESS_MASK ;


typedef ACCESS_MASK *  PACCESS_MASK ;


typedef struct _GENERIC_MAPPING {
	ACCESS_MASK GenericRead ;
	ACCESS_MASK GenericWrite ;
	ACCESS_MASK GenericExecute ;
	ACCESS_MASK GenericAll ;
} GENERIC_MAPPING ;


typedef GENERIC_MAPPING *  PGENERIC_MAPPING ;



#pragma warning(disable:4103)

#pragma pack(push, 4)

typedef struct _LUID_AND_ATTRIBUTES {
	LUID Luid ;
	ULONG Attributes ;
} LUID_AND_ATTRIBUTES , *  PLUID_AND_ATTRIBUTES ;


typedef LUID_AND_ATTRIBUTES LUID_AND_ATTRIBUTES_ARRAY[1] ;


typedef LUID_AND_ATTRIBUTES_ARRAY *  PLUID_AND_ATTRIBUTES_ARRAY ;



#pragma warning(disable:4103)

#pragma pack(pop)

typedef struct _ACL {
	UCHAR AclRevision ;
	UCHAR Sbz1 ;
	USHORT AclSize ;
	USHORT AceCount ;
	USHORT Sbz2 ;
} ACL ;


typedef ACL *  PACL ;


typedef struct _PRIVILEGE_SET {
	ULONG PrivilegeCount ;
	ULONG Control ;
	LUID_AND_ATTRIBUTES Privilege[1] ;
} PRIVILEGE_SET , *  PPRIVILEGE_SET ;


typedef enum _SECURITY_IMPERSONATION_LEVEL {
	SecurityAnonymous,
	SecurityIdentification,
	SecurityImpersonation,
	SecurityDelegation
} SECURITY_IMPERSONATION_LEVEL , *  PSECURITY_IMPERSONATION_LEVEL ;


typedef BOOLEAN SECURITY_CONTEXT_TRACKING_MODE , * 
	PSECURITY_CONTEXT_TRACKING_MODE ;


typedef struct _SECURITY_QUALITY_OF_SERVICE {
	ULONG Length ;
	SECURITY_IMPERSONATION_LEVEL ImpersonationLevel ;
	SECURITY_CONTEXT_TRACKING_MODE ContextTrackingMode ;
	BOOLEAN EffectiveOnly ;
} SECURITY_QUALITY_OF_SERVICE , *  PSECURITY_QUALITY_OF_SERVICE ;


typedef struct _SE_IMPERSONATION_STATE {
	PACCESS_TOKEN Token ;
	BOOLEAN CopyOnOpen ;
	BOOLEAN EffectiveOnly ;
	SECURITY_IMPERSONATION_LEVEL Level ;
} SE_IMPERSONATION_STATE , *  PSE_IMPERSONATION_STATE ;


typedef ULONG SECURITY_INFORMATION , *  PSECURITY_INFORMATION ;


typedef ULONG KAFFINITY ;


typedef KAFFINITY *  PKAFFINITY ;


typedef LONG KPRIORITY ;


typedef ULONG_PTR KSPIN_LOCK ;


typedef KSPIN_LOCK *  PKSPIN_LOCK ;


typedef void ( *  PKINTERRUPT_ROUTINE )(void  ) ;


typedef enum _KPROFILE_SOURCE {
	ProfileTime,
	ProfileAlignmentFixup,
	ProfileTotalIssues,
	ProfilePipelineDry,
	ProfileLoadInstructions,
	ProfilePipelineFrozen,
	ProfileBranchInstructions,
	ProfileTotalNonissues,
	ProfileDcacheMisses,
	ProfileIcacheMisses,
	ProfileCacheMisses,
	ProfileBranchMispredictions,
	ProfileStoreInstructions,
	ProfileFpInstructions,
	ProfileIntegerInstructions,
	Profile2Issue,
	Profile3Issue,
	Profile4Issue,
	ProfileSpecialInstructions,
	ProfileTotalCycles,
	ProfileIcacheIssues,
	ProfileDcacheAccesses,
	ProfileMemoryBarrierCycles,
	ProfileLoadLinkedIssues,
	ProfileMaximum
} KPROFILE_SOURCE ;


__declspec(dllimport) void __stdcall RtlGetCallersAddress(PVOID * 
	CallersAddress , PVOID *  CallersCaller ) ;

__declspec(dllimport) ULONG __stdcall RtlWalkFrameChain(PVOID *  Callers , ULONG
	Count , ULONG Flags ) ;


typedef NTSTATUS (__stdcall *  PRTL_QUERY_REGISTRY_ROUTINE )(PWSTR ValueName ,
	ULONG ValueType , PVOID ValueData , ULONG ValueLength , PVOID Context ,
	PVOID EntryContext ) ;


typedef struct _RTL_QUERY_REGISTRY_TABLE {
	PRTL_QUERY_REGISTRY_ROUTINE QueryRoutine ;
	ULONG Flags ;
	PWSTR Name ;
	PVOID EntryContext ;
	ULONG DefaultType ;
	PVOID DefaultData ;
	ULONG DefaultLength ;
} RTL_QUERY_REGISTRY_TABLE , *  PRTL_QUERY_REGISTRY_TABLE ;


__declspec(dllimport) NTSTATUS __stdcall RtlQueryRegistryValues(ULONG RelativeTo
	, PCWSTR Path , PRTL_QUERY_REGISTRY_TABLE QueryTable , PVOID Context ,
	PVOID Environment ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlWriteRegistryValue(ULONG RelativeTo
	, PCWSTR Path , PCWSTR ValueName , ULONG ValueType , PVOID ValueData ,
	ULONG ValueLength ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlDeleteRegistryValue(ULONG RelativeTo
	, PCWSTR Path , PCWSTR ValueName ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlCreateRegistryKey(ULONG RelativeTo ,
	PWSTR Path ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlCheckRegistryKey(ULONG RelativeTo ,
	PWSTR Path ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlCharToInteger(PCSZ String , ULONG
	Base , PULONG Value ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlIntegerToUnicodeString(ULONG Value ,
	ULONG Base , PUNICODE_STRING String ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlInt64ToUnicodeString(ULONGLONG Value
	, ULONG Base , PUNICODE_STRING String ) ;

__declspec(dllimport) NTSTATUS __stdcall
	RtlUnicodeStringToInteger(PUNICODE_STRING String , ULONG Base , PULONG
	Value ) ;

extern BOOLEAN ( *  NlsMbCodePageTag ) ;
extern BOOLEAN ( *  NlsMbOemCodePageTag ) ;

__declspec(dllimport) void __stdcall RtlInitString(PSTRING DestinationString ,
	PCSZ SourceString ) ;

__declspec(dllimport) void __stdcall RtlInitAnsiString(PANSI_STRING
	DestinationString , PCSZ SourceString ) ;

__declspec(dllimport) void __stdcall RtlInitUnicodeString(PUNICODE_STRING
	DestinationString , PCWSTR SourceString ) ;

__declspec(dllimport) void __stdcall RtlCopyString(PSTRING DestinationString ,
	PSTRING SourceString ) ;

__declspec(dllimport) CHAR __stdcall RtlUpperChar(CHAR Character ) ;

__declspec(dllimport) LONG __stdcall RtlCompareString(PSTRING String1 , PSTRING
	String2 , BOOLEAN CaseInSensitive ) ;

__declspec(dllimport) BOOLEAN __stdcall RtlEqualString(PSTRING String1 , PSTRING
	String2 , BOOLEAN CaseInSensitive ) ;

__declspec(dllimport) void __stdcall RtlUpperString(PSTRING DestinationString ,
	PSTRING SourceString ) ;

__declspec(dllimport) NTSTATUS __stdcall
	RtlAnsiStringToUnicodeString(PUNICODE_STRING DestinationString ,
	PANSI_STRING SourceString , BOOLEAN AllocateDestinationString ) ;

__declspec(dllimport) NTSTATUS __stdcall
	RtlUnicodeStringToAnsiString(PANSI_STRING DestinationString ,
	PUNICODE_STRING SourceString , BOOLEAN AllocateDestinationString ) ;

__declspec(dllimport) LONG __stdcall RtlCompareUnicodeString(PUNICODE_STRING
	String1 , PUNICODE_STRING String2 , BOOLEAN CaseInSensitive ) ;

__declspec(dllimport) BOOLEAN __stdcall RtlEqualUnicodeString(const
	UNICODE_STRING *  String1 , const UNICODE_STRING *  String2 , BOOLEAN
	CaseInSensitive ) ;

__declspec(dllimport) BOOLEAN __stdcall RtlPrefixUnicodeString(PUNICODE_STRING
	String1 , PUNICODE_STRING String2 , BOOLEAN CaseInSensitive ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlUpcaseUnicodeString(PUNICODE_STRING
	DestinationString , PCUNICODE_STRING SourceString , BOOLEAN
	AllocateDestinationString ) ;

__declspec(dllimport) void __stdcall RtlCopyUnicodeString(PUNICODE_STRING
	DestinationString , PUNICODE_STRING SourceString ) ;

__declspec(dllimport) NTSTATUS __stdcall
	RtlAppendUnicodeStringToString(PUNICODE_STRING Destination ,
	PUNICODE_STRING Source ) ;

__declspec(dllimport) NTSTATUS __stdcall
	RtlAppendUnicodeToString(PUNICODE_STRING Destination , PCWSTR Source ) ;

__declspec(dllimport) WCHAR __stdcall RtlUpcaseUnicodeChar(WCHAR SourceCharacter
	) ;

__declspec(dllimport) void __stdcall RtlFreeUnicodeString(PUNICODE_STRING
	UnicodeString ) ;

__declspec(dllimport) void __stdcall RtlFreeAnsiString(PANSI_STRING AnsiString )
	;

__declspec(dllimport) ULONG __stdcall RtlxAnsiStringToUnicodeSize(PANSI_STRING
	AnsiString ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlStringFromGUID(const GUID * const
	Guid , PUNICODE_STRING GuidString ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlGUIDFromString(PUNICODE_STRING
	GuidString , GUID *  Guid ) ;

__declspec(dllimport) SIZE_T __stdcall RtlCompareMemory(const void *  Source1 ,
	const void *  Source2 , SIZE_T Length ) ;

void __stdcall DbgBreakPoint(void  ) ;

__declspec(dllimport) void __stdcall DbgBreakPointWithStatus(ULONG Status ) ;

ULONG _cdecl DbgPrint(PCH Format , ...) ;

ULONG _cdecl DbgPrintReturnControlC(PCH Format , ...) ;


__inline LARGE_INTEGER __stdcall RtlLargeIntegerAdd(LARGE_INTEGER Addend1 ,
	LARGE_INTEGER Addend2 )
{
	
	LARGE_INTEGER Sum ;
	
	Sum.QuadPart = Addend1.QuadPart + Addend2.QuadPart;
	return Sum;
}


__inline LARGE_INTEGER __stdcall RtlEnlargedIntegerMultiply(LONG Multiplicand ,
	LONG Multiplier )
{
	
	LARGE_INTEGER Product ;
	
	Product.QuadPart = (LONGLONG )Multiplicand * (ULONGLONG )Multiplier;
	return Product;
}


__inline LARGE_INTEGER __stdcall RtlEnlargedUnsignedMultiply(ULONG Multiplicand
	, ULONG Multiplier )
{
	
	LARGE_INTEGER Product ;
	
	Product.QuadPart = (ULONGLONG )Multiplicand * (ULONGLONG )Multiplier;
	return Product;
}


__inline ULONG __stdcall RtlEnlargedUnsignedDivide(ULARGE_INTEGER Dividend ,
	ULONG Divisor , PULONG Remainder )
{
	
	ULONG Quotient ;
	
	Quotient = (ULONG )(Dividend.QuadPart / Divisor);
	if((CHAR *  )Remainder != (CHAR *  )((void *  )0))
	{
		* Remainder = (ULONG )(Dividend.QuadPart % Divisor);
	}
	
	return Quotient;
}


__inline LARGE_INTEGER __stdcall RtlLargeIntegerNegate(LARGE_INTEGER Subtrahend
	)
{
	
	LARGE_INTEGER Difference ;
	
	Difference.QuadPart = - Subtrahend.QuadPart;
	return Difference;
}


__inline LARGE_INTEGER __stdcall RtlLargeIntegerSubtract(LARGE_INTEGER Minuend ,
	LARGE_INTEGER Subtrahend )
{
	
	LARGE_INTEGER Difference ;
	
	Difference.QuadPart = Minuend.QuadPart - Subtrahend.QuadPart;
	return Difference;
}


__declspec(dllimport) LARGE_INTEGER __stdcall
	RtlExtendedMagicDivide(LARGE_INTEGER Dividend , LARGE_INTEGER
	MagicDivisor , CCHAR ShiftCount ) ;

__declspec(dllimport) LARGE_INTEGER __stdcall
	RtlExtendedLargeIntegerDivide(LARGE_INTEGER Dividend , ULONG Divisor ,
	PULONG Remainder ) ;

__declspec(dllimport) LARGE_INTEGER __stdcall
	RtlLargeIntegerDivide(LARGE_INTEGER Dividend , LARGE_INTEGER Divisor ,
	PLARGE_INTEGER Remainder ) ;

__declspec(dllimport) LARGE_INTEGER __stdcall
	RtlExtendedIntegerMultiply(LARGE_INTEGER Multiplicand , LONG Multiplier
	) ;



#pragma warning(push)

#pragma warning(disable:4035)

__inline LARGE_INTEGER __stdcall RtlConvertLongToLargeInteger(LONG SignedInteger
	)
{
	
/*
	__asm {
        mov     eax, SignedInteger
        cdq                 ; (edx:eax) = signed LargeInt
    
		};
*/
}


__inline LARGE_INTEGER __stdcall RtlConvertUlongToLargeInteger(ULONG
	UnsignedInteger )
{
	
/*
	__asm {
        sub     edx, edx    ; zero highpart
        mov     eax, UnsignedInteger
    
		};
*/
}


__inline LARGE_INTEGER __stdcall RtlLargeIntegerShiftLeft(LARGE_INTEGER
	LargeInteger , CCHAR ShiftCount )
{
	
/*
	__asm {
        mov     cl, ShiftCount
        and     cl, 0x3f                    ; mod 64

        cmp     cl, 32
        jc      short sl10

        mov     edx, LargeInteger.LowPart   ; ShiftCount >= 32
        xor     eax, eax                    ; lowpart is zero
        shl     edx, cl                     ; store highpart
        jmp     short done

sl10:
        mov     eax, LargeInteger.LowPart   ; ShiftCount < 32
        mov     edx, LargeInteger.HighPart
        shld    edx, eax, cl
        shl     eax, cl
done:
    
		};
*/
}

__inline LARGE_INTEGER __stdcall RtlLargeIntegerShiftRight(LARGE_INTEGER
	LargeInteger , CCHAR ShiftCount )
{
	
/*
	__asm {
        mov     cl, ShiftCount
        and     cl, 0x3f               ; mod 64

        cmp     cl, 32
        jc      short sr10

        mov     eax, LargeInteger.HighPart  ; ShiftCount >= 32
        xor     edx, edx                    ; lowpart is zero
        shr     eax, cl                     ; store highpart
        jmp     short done

sr10:
        mov     eax, LargeInteger.LowPart   ; ShiftCount < 32
        mov     edx, LargeInteger.HighPart
        shrd    eax, edx, cl
        shr     edx, cl
done:
    
		};
*/
}

__inline LARGE_INTEGER __stdcall RtlLargeIntegerArithmeticShift(LARGE_INTEGER
	LargeInteger , CCHAR ShiftCount )
{
	
/*
	__asm {
        mov     cl, ShiftCount
        and     cl, 3fh                 ; mod 64

        cmp     cl, 32
        jc      short sar10

        mov     eax, LargeInteger.HighPart
        sar     eax, cl
        bt      eax, 31                     ; sign bit set?
        sbb     edx, edx                    ; duplicate sign bit into highpart
        jmp     short done
sar10:
        mov     eax, LargeInteger.LowPart   ; (eax) = LargeInteger.LowPart
        mov     edx, LargeInteger.HighPart  ; (edx) = LargeInteger.HighPart
        shrd    eax, edx, cl
        sar     edx, cl
done:
    
		};
*/
}


#pragma warning(pop)

typedef struct _TIME_FIELDS {
	CSHORT Year ;
	CSHORT Month ;
	CSHORT Day ;
	CSHORT Hour ;
	CSHORT Minute ;
	CSHORT Second ;
	CSHORT Milliseconds ;
	CSHORT Weekday ;
} TIME_FIELDS ;


typedef TIME_FIELDS *  PTIME_FIELDS ;


__declspec(dllimport) void __stdcall RtlTimeToTimeFields(PLARGE_INTEGER Time ,
	PTIME_FIELDS TimeFields ) ;

__declspec(dllimport) BOOLEAN __stdcall RtlTimeFieldsToTime(PTIME_FIELDS
	TimeFields , PLARGE_INTEGER Time ) ;


typedef struct _RTL_BITMAP {
	ULONG SizeOfBitMap ;
	PULONG Buffer ;
} RTL_BITMAP ;


typedef RTL_BITMAP *  PRTL_BITMAP ;


__declspec(dllimport) void __stdcall RtlInitializeBitMap(PRTL_BITMAP
	BitMapHeader , PULONG BitMapBuffer , ULONG SizeOfBitMap ) ;

__declspec(dllimport) void __stdcall RtlClearAllBits(PRTL_BITMAP BitMapHeader )
	;

__declspec(dllimport) void __stdcall RtlSetAllBits(PRTL_BITMAP BitMapHeader ) ;

__declspec(dllimport) ULONG __stdcall RtlFindClearBits(PRTL_BITMAP BitMapHeader
	, ULONG NumberToFind , ULONG HintIndex ) ;

__declspec(dllimport) ULONG __stdcall RtlFindSetBits(PRTL_BITMAP BitMapHeader ,
	ULONG NumberToFind , ULONG HintIndex ) ;

__declspec(dllimport) ULONG __stdcall RtlFindClearBitsAndSet(PRTL_BITMAP
	BitMapHeader , ULONG NumberToFind , ULONG HintIndex ) ;

__declspec(dllimport) ULONG __stdcall RtlFindSetBitsAndClear(PRTL_BITMAP
	BitMapHeader , ULONG NumberToFind , ULONG HintIndex ) ;

__declspec(dllimport) void __stdcall RtlClearBits(PRTL_BITMAP BitMapHeader ,
	ULONG StartingIndex , ULONG NumberToClear ) ;

__declspec(dllimport) void __stdcall RtlSetBits(PRTL_BITMAP BitMapHeader , ULONG
	StartingIndex , ULONG NumberToSet ) ;


typedef struct _RTL_BITMAP_RUN {
	ULONG StartingIndex ;
	ULONG NumberOfBits ;
} RTL_BITMAP_RUN ;


typedef RTL_BITMAP_RUN *  PRTL_BITMAP_RUN ;

__declspec(dllimport) ULONG __stdcall RtlFindClearRuns(PRTL_BITMAP BitMapHeader
	, PRTL_BITMAP_RUN RunArray , ULONG SizeOfRunArray , BOOLEAN
	LocateLongestRuns ) ;

__declspec(dllimport) ULONG __stdcall RtlFindLongestRunClear(PRTL_BITMAP
	BitMapHeader , PULONG StartingIndex ) ;

__declspec(dllimport) ULONG __stdcall RtlFindFirstRunClear(PRTL_BITMAP
	BitMapHeader , PULONG StartingIndex ) ;

__declspec(dllimport) ULONG __stdcall RtlNumberOfClearBits(PRTL_BITMAP
	BitMapHeader ) ;

__declspec(dllimport) ULONG __stdcall RtlNumberOfSetBits(PRTL_BITMAP
	BitMapHeader ) ;

__declspec(dllimport) BOOLEAN __stdcall RtlAreBitsClear(PRTL_BITMAP BitMapHeader
	, ULONG StartingIndex , ULONG Length ) ;

__declspec(dllimport) BOOLEAN __stdcall RtlAreBitsSet(PRTL_BITMAP BitMapHeader ,
	ULONG StartingIndex , ULONG Length ) ;

__declspec(dllimport) ULONG __stdcall RtlFindNextForwardRunClear(PRTL_BITMAP
	BitMapHeader , ULONG FromIndex , PULONG StartingRunIndex ) ;

__declspec(dllimport) ULONG __stdcall RtlFindLastBackwardRunClear(PRTL_BITMAP
	BitMapHeader , ULONG FromIndex , PULONG StartingRunIndex ) ;

__declspec(dllimport) CCHAR __stdcall RtlFindLeastSignificantBit(ULONGLONG Set )
	;

__declspec(dllimport) CCHAR __stdcall RtlFindMostSignificantBit(ULONGLONG Set )
	;


__inline LUID __stdcall RtlConvertLongToLuid(LONG Long )
{
	
	LUID TempLuid ;
	LARGE_INTEGER TempLi ;
	
	TempLi = RtlConvertLongToLargeInteger(Long);
	TempLuid.LowPart = TempLi.LowPart;
	TempLuid.HighPart = TempLi.HighPart;
	return TempLuid;
}

__inline LUID __stdcall RtlConvertUlongToLuid(ULONG Ulong )
{
	
	LUID TempLuid ;
	
	TempLuid.LowPart = Ulong;
	TempLuid.HighPart = 0;
	return TempLuid;
}


__declspec(dllimport) void __stdcall RtlMapGenericMask(PACCESS_MASK AccessMask ,
	PGENERIC_MAPPING GenericMapping ) ;

__declspec(dllimport) NTSTATUS __stdcall
	RtlCreateSecurityDescriptor(PSECURITY_DESCRIPTOR SecurityDescriptor ,
	ULONG Revision ) ;

__declspec(dllimport) BOOLEAN __stdcall
	RtlValidSecurityDescriptor(PSECURITY_DESCRIPTOR SecurityDescriptor ) ;

__declspec(dllimport) ULONG __stdcall
	RtlLengthSecurityDescriptor(PSECURITY_DESCRIPTOR SecurityDescriptor ) ;

__declspec(dllimport) BOOLEAN __stdcall
	RtlValidRelativeSecurityDescriptor(PSECURITY_DESCRIPTOR
	SecurityDescriptorInput , ULONG SecurityDescriptorLength ,
	SECURITY_INFORMATION RequiredInformation ) ;

__declspec(dllimport) NTSTATUS __stdcall
	RtlSetDaclSecurityDescriptor(PSECURITY_DESCRIPTOR SecurityDescriptor ,
	BOOLEAN DaclPresent , PACL Dacl , BOOLEAN DaclDefaulted ) ;


typedef struct _RTL_RANGE {
	ULONGLONG Start ;
	ULONGLONG End ;
	PVOID UserData ;
	PVOID Owner ;
	UCHAR Attributes ;
	UCHAR Flags ;
} RTL_RANGE , *  PRTL_RANGE ;


typedef struct _RTL_RANGE_LIST {
	LIST_ENTRY ListHead ;
	ULONG Flags ;
	ULONG Count ;
	ULONG Stamp ;
} RTL_RANGE_LIST , *  PRTL_RANGE_LIST ;


typedef struct _RANGE_LIST_ITERATOR {
	PLIST_ENTRY RangeListHead ;
	PLIST_ENTRY MergedHead ;
	PVOID Current ;
	ULONG Stamp ;
} RTL_RANGE_LIST_ITERATOR , *  PRTL_RANGE_LIST_ITERATOR ;


__declspec(dllimport) void __stdcall RtlInitializeRangeList(PRTL_RANGE_LIST
	RangeList ) ;

__declspec(dllimport) void __stdcall RtlFreeRangeList(PRTL_RANGE_LIST RangeList
	) ;

__declspec(dllimport) NTSTATUS __stdcall RtlCopyRangeList(PRTL_RANGE_LIST
	CopyRangeList , PRTL_RANGE_LIST RangeList ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlAddRange(PRTL_RANGE_LIST RangeList ,
	ULONGLONG Start , ULONGLONG End , UCHAR Attributes , ULONG Flags , PVOID
	UserData , PVOID Owner ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlDeleteRange(PRTL_RANGE_LIST
	RangeList , ULONGLONG Start , ULONGLONG End , PVOID Owner ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlDeleteOwnersRanges(PRTL_RANGE_LIST
	RangeList , PVOID Owner ) ;


typedef BOOLEAN ( *  PRTL_CONFLICT_RANGE_CALLBACK )(PVOID Context , PRTL_RANGE
	Range ) ;


__declspec(dllimport) NTSTATUS __stdcall RtlFindRange(PRTL_RANGE_LIST RangeList
	, ULONGLONG Minimum , ULONGLONG Maximum , ULONG Length , ULONG Alignment
	, ULONG Flags , UCHAR AttributeAvailableMask , PVOID Context ,
	PRTL_CONFLICT_RANGE_CALLBACK Callback , PULONGLONG Start ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlIsRangeAvailable(PRTL_RANGE_LIST
	RangeList , ULONGLONG Start , ULONGLONG End , ULONG Flags , UCHAR
	AttributeAvailableMask , PVOID Context , PRTL_CONFLICT_RANGE_CALLBACK
	Callback , PBOOLEAN Available ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlGetFirstRange(PRTL_RANGE_LIST
	RangeList , PRTL_RANGE_LIST_ITERATOR Iterator , PRTL_RANGE *  Range ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlGetLastRange(PRTL_RANGE_LIST
	RangeList , PRTL_RANGE_LIST_ITERATOR Iterator , PRTL_RANGE *  Range ) ;

__declspec(dllimport) NTSTATUS __stdcall
	RtlGetNextRange(PRTL_RANGE_LIST_ITERATOR Iterator , PRTL_RANGE *  Range
	, BOOLEAN MoveForwards ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlMergeRangeLists(PRTL_RANGE_LIST
	MergedRangeList , PRTL_RANGE_LIST RangeList1 , PRTL_RANGE_LIST
	RangeList2 , ULONG Flags ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlInvertRangeList(PRTL_RANGE_LIST
	InvertedRangeList , PRTL_RANGE_LIST RangeList ) ;

USHORT _fastcall RtlUshortByteSwap(USHORT Source ) ;

ULONG _fastcall RtlUlongByteSwap(ULONG Source ) ;

ULONGLONG _fastcall RtlUlonglongByteSwap(ULONGLONG Source ) ;

__declspec(dllimport) NTSTATUS __stdcall RtlVolumeDeviceToDosName(PVOID
	VolumeDeviceObject , PUNICODE_STRING DosName ) ;


typedef struct _OSVERSIONINFOA {
	ULONG dwOSVersionInfoSize ;
	ULONG dwMajorVersion ;
	ULONG dwMinorVersion ;
	ULONG dwBuildNumber ;
	ULONG dwPlatformId ;
	CHAR szCSDVersion[128] ;
} OSVERSIONINFOA , *  POSVERSIONINFOA , *  LPOSVERSIONINFOA ;

typedef struct _OSVERSIONINFOW {
	ULONG dwOSVersionInfoSize ;
	ULONG dwMajorVersion ;
	ULONG dwMinorVersion ;
	ULONG dwBuildNumber ;
	ULONG dwPlatformId ;
	WCHAR szCSDVersion[128] ;
} OSVERSIONINFOW , *  POSVERSIONINFOW , *  LPOSVERSIONINFOW , RTL_OSVERSIONINFOW
	, *  PRTL_OSVERSIONINFOW ;


typedef OSVERSIONINFOA OSVERSIONINFO ;


typedef POSVERSIONINFOA POSVERSIONINFO ;


typedef LPOSVERSIONINFOA LPOSVERSIONINFO ;


typedef struct _OSVERSIONINFOEXA {
	ULONG dwOSVersionInfoSize ;
	ULONG dwMajorVersion ;
	ULONG dwMinorVersion ;
	ULONG dwBuildNumber ;
	ULONG dwPlatformId ;
	CHAR szCSDVersion[128] ;
	USHORT wServicePackMajor ;
	USHORT wServicePackMinor ;
	USHORT wSuiteMask ;
	UCHAR wProductType ;
	UCHAR wReserved ;
} OSVERSIONINFOEXA , *  POSVERSIONINFOEXA , *  LPOSVERSIONINFOEXA ;


typedef struct _OSVERSIONINFOEXW {
	ULONG dwOSVersionInfoSize ;
	ULONG dwMajorVersion ;
	ULONG dwMinorVersion ;
	ULONG dwBuildNumber ;
	ULONG dwPlatformId ;
	WCHAR szCSDVersion[128] ;
	USHORT wServicePackMajor ;
	USHORT wServicePackMinor ;
	USHORT wSuiteMask ;
	UCHAR wProductType ;
	UCHAR wReserved ;
} OSVERSIONINFOEXW , *  POSVERSIONINFOEXW , *  LPOSVERSIONINFOEXW ,
	RTL_OSVERSIONINFOEXW , *  PRTL_OSVERSIONINFOEXW ;


typedef OSVERSIONINFOEXA OSVERSIONINFOEX ;


typedef POSVERSIONINFOEXA POSVERSIONINFOEX ;


typedef LPOSVERSIONINFOEXA LPOSVERSIONINFOEX ;


ULONGLONG __stdcall VerSetConditionMask(ULONGLONG ConditionMask , ULONG TypeMask
	, UCHAR Condition ) ;

__declspec(dllimport) NTSTATUS RtlGetVersion(PRTL_OSVERSIONINFOW
	lpVersionInformation ) ;

__declspec(dllimport) NTSTATUS RtlVerifyVersionInfo(PRTL_OSVERSIONINFOEXW
	VersionInfo , ULONG TypeMask , ULONGLONG ConditionMask ) ;


typedef struct _IO_STATUS_BLOCK {
	union  {
		NTSTATUS Status ;
		PVOID Pointer ;
	}  ;
	ULONG_PTR Information ;
} IO_STATUS_BLOCK , *  PIO_STATUS_BLOCK ;


typedef void (__stdcall *  PIO_APC_ROUTINE )(PVOID ApcContext , PIO_STATUS_BLOCK
	IoStatusBlock , ULONG Reserved ) ;


typedef enum _FILE_INFORMATION_CLASS {
	FileDirectoryInformation = 1,
	FileFullDirectoryInformation,
	FileBothDirectoryInformation,
	FileBasicInformation,
	FileStandardInformation,
	FileInternalInformation,
	FileEaInformation,
	FileAccessInformation,
	FileNameInformation,
	FileRenameInformation,
	FileLinkInformation,
	FileNamesInformation,
	FileDispositionInformation,
	FilePositionInformation,
	FileFullEaInformation,
	FileModeInformation,
	FileAlignmentInformation,
	FileAllInformation,
	FileAllocationInformation,
	FileEndOfFileInformation,
	FileAlternateNameInformation,
	FileStreamInformation,
	FilePipeInformation,
	FilePipeLocalInformation,
	FilePipeRemoteInformation,
	FileMailslotQueryInformation,
	FileMailslotSetInformation,
	FileCompressionInformation,
	FileObjectIdInformation,
	FileCompletionInformation,
	FileMoveClusterInformation,
	FileQuotaInformation,
	FileReparsePointInformation,
	FileNetworkOpenInformation,
	FileAttributeTagInformation,
	FileTrackingInformation,
	FileMaximumInformation
} FILE_INFORMATION_CLASS , *  PFILE_INFORMATION_CLASS ;


typedef struct _FILE_BASIC_INFORMATION {
	LARGE_INTEGER CreationTime ;
	LARGE_INTEGER LastAccessTime ;
	LARGE_INTEGER LastWriteTime ;
	LARGE_INTEGER ChangeTime ;
	ULONG FileAttributes ;
} FILE_BASIC_INFORMATION , *  PFILE_BASIC_INFORMATION ;

typedef struct _FILE_STANDARD_INFORMATION {
	LARGE_INTEGER AllocationSize ;
	LARGE_INTEGER EndOfFile ;
	ULONG NumberOfLinks ;
	BOOLEAN DeletePending ;
	BOOLEAN Directory ;
} FILE_STANDARD_INFORMATION , *  PFILE_STANDARD_INFORMATION ;

typedef struct _FILE_POSITION_INFORMATION {
	LARGE_INTEGER CurrentByteOffset ;
} FILE_POSITION_INFORMATION , *  PFILE_POSITION_INFORMATION ;

typedef struct _FILE_ALIGNMENT_INFORMATION {
	ULONG AlignmentRequirement ;
} FILE_ALIGNMENT_INFORMATION , *  PFILE_ALIGNMENT_INFORMATION ;

typedef struct _FILE_NAME_INFORMATION {
	ULONG FileNameLength ;
	WCHAR FileName[1] ;
} FILE_NAME_INFORMATION , *  PFILE_NAME_INFORMATION ;

typedef struct _FILE_NETWORK_OPEN_INFORMATION {
	LARGE_INTEGER CreationTime ;
	LARGE_INTEGER LastAccessTime ;
	LARGE_INTEGER LastWriteTime ;
	LARGE_INTEGER ChangeTime ;
	LARGE_INTEGER AllocationSize ;
	LARGE_INTEGER EndOfFile ;
	ULONG FileAttributes ;
} FILE_NETWORK_OPEN_INFORMATION , *  PFILE_NETWORK_OPEN_INFORMATION ;

typedef struct _FILE_ATTRIBUTE_TAG_INFORMATION {
	ULONG FileAttributes ;
	ULONG ReparseTag ;
} FILE_ATTRIBUTE_TAG_INFORMATION , *  PFILE_ATTRIBUTE_TAG_INFORMATION ;

typedef struct _FILE_DISPOSITION_INFORMATION {
	BOOLEAN DeleteFile ;
} FILE_DISPOSITION_INFORMATION , *  PFILE_DISPOSITION_INFORMATION ;

typedef struct _FILE_END_OF_FILE_INFORMATION {
	LARGE_INTEGER EndOfFile ;
} FILE_END_OF_FILE_INFORMATION , *  PFILE_END_OF_FILE_INFORMATION ;


typedef struct _FILE_FULL_EA_INFORMATION {
	ULONG NextEntryOffset ;
	UCHAR Flags ;
	UCHAR EaNameLength ;
	USHORT EaValueLength ;
	CHAR EaName[1] ;
} FILE_FULL_EA_INFORMATION , *  PFILE_FULL_EA_INFORMATION ;


typedef enum _FSINFOCLASS {
	FileFsVolumeInformation = 1,
	FileFsLabelInformation,
	FileFsSizeInformation,
	FileFsDeviceInformation,
	FileFsAttributeInformation,
	FileFsControlInformation,
	FileFsFullSizeInformation,
	FileFsObjectIdInformation,
	FileFsMaximumInformation
} FS_INFORMATION_CLASS , *  PFS_INFORMATION_CLASS ;

typedef struct _FILE_FS_DEVICE_INFORMATION {
	ULONG DeviceType ;
	ULONG Characteristics ;
} FILE_FS_DEVICE_INFORMATION , *  PFILE_FS_DEVICE_INFORMATION ;


typedef union _FILE_SEGMENT_ELEMENT {
	PVOID64 Buffer ;
	ULONGLONG Alignment ;
} FILE_SEGMENT_ELEMENT , *  PFILE_SEGMENT_ELEMENT ;


typedef enum _INTERFACE_TYPE {
	InterfaceTypeUndefined = - 1,
	Internal,
	Isa,
	Eisa,
	MicroChannel,
	TurboChannel,
	PCIBus,
	VMEBus,
	NuBus,
	PCMCIABus,
	CBus,
	MPIBus,
	MPSABus,
	ProcessorInternal,
	InternalPowerBus,
	PNPISABus,
	PNPBus,
	MaximumInterfaceType
} INTERFACE_TYPE , *  PINTERFACE_TYPE ;


typedef enum _DMA_WIDTH {
	Width8Bits,
	Width16Bits,
	Width32Bits,
	MaximumDmaWidth
} DMA_WIDTH , *  PDMA_WIDTH ;


typedef enum _DMA_SPEED {
	Compatible,
	TypeA,
	TypeB,
	TypeC,
	TypeF,
	MaximumDmaSpeed
} DMA_SPEED , *  PDMA_SPEED ;


typedef void ( *  PINTERFACE_REFERENCE )(PVOID Context ) ;


typedef void ( *  PINTERFACE_DEREFERENCE )(PVOID Context ) ;


typedef enum _BUS_DATA_TYPE {
	ConfigurationSpaceUndefined = - 1,
	Cmos,
	EisaConfiguration,
	Pos,
	CbusConfiguration,
	PCIConfiguration,
	VMEConfiguration,
	NuBusConfiguration,
	PCMCIAConfiguration,
	MPIConfiguration,
	MPSAConfiguration,
	PNPISAConfiguration,
	SgiInternalConfiguration,
	MaximumBusDataType
} BUS_DATA_TYPE , *  PBUS_DATA_TYPE ;


typedef struct _IO_ERROR_LOG_PACKET {
	UCHAR MajorFunctionCode ;
	UCHAR RetryCount ;
	USHORT DumpDataSize ;
	USHORT NumberOfStrings ;
	USHORT StringOffset ;
	USHORT EventCategory ;
	NTSTATUS ErrorCode ;
	ULONG UniqueErrorValue ;
	NTSTATUS FinalStatus ;
	ULONG SequenceNumber ;
	ULONG IoControlCode ;
	LARGE_INTEGER DeviceOffset ;
	ULONG DumpData[1] ;
} IO_ERROR_LOG_PACKET , *  PIO_ERROR_LOG_PACKET ;


typedef struct _IO_ERROR_LOG_MESSAGE {
	USHORT Type ;
	USHORT Size ;
	USHORT DriverNameLength ;
	LARGE_INTEGER TimeStamp ;
	ULONG DriverNameOffset ;
	IO_ERROR_LOG_PACKET EntryData ;
} IO_ERROR_LOG_MESSAGE , *  PIO_ERROR_LOG_MESSAGE ;


typedef struct _KEY_BASIC_INFORMATION {
	LARGE_INTEGER LastWriteTime ;
	ULONG TitleIndex ;
	ULONG NameLength ;
	WCHAR Name[1] ;
} KEY_BASIC_INFORMATION , *  PKEY_BASIC_INFORMATION ;

typedef struct _KEY_NODE_INFORMATION {
	LARGE_INTEGER LastWriteTime ;
	ULONG TitleIndex ;
	ULONG ClassOffset ;
	ULONG ClassLength ;
	ULONG NameLength ;
	WCHAR Name[1] ;
} KEY_NODE_INFORMATION , *  PKEY_NODE_INFORMATION ;


typedef struct _KEY_FULL_INFORMATION {
	LARGE_INTEGER LastWriteTime ;
	ULONG TitleIndex ;
	ULONG ClassOffset ;
	ULONG ClassLength ;
	ULONG SubKeys ;
	ULONG MaxNameLen ;
	ULONG MaxClassLen ;
	ULONG Values ;
	ULONG MaxValueNameLen ;
	ULONG MaxValueDataLen ;
	WCHAR Class[1] ;
} KEY_FULL_INFORMATION , *  PKEY_FULL_INFORMATION ;


typedef struct _KEY_NAME_INFORMATION {
	ULONG NameLength ;
	WCHAR Name[1] ;
} KEY_NAME_INFORMATION , *  PKEY_NAME_INFORMATION ;


typedef enum _KEY_INFORMATION_CLASS {
	KeyBasicInformation,
	KeyNodeInformation,
	KeyFullInformation,
	KeyNameInformation
} KEY_INFORMATION_CLASS ;


typedef struct _KEY_WRITE_TIME_INFORMATION {
	LARGE_INTEGER LastWriteTime ;
} KEY_WRITE_TIME_INFORMATION , *  PKEY_WRITE_TIME_INFORMATION ;

typedef enum _KEY_SET_INFORMATION_CLASS {
	KeyWriteTimeInformation
} KEY_SET_INFORMATION_CLASS ;


typedef struct _KEY_VALUE_BASIC_INFORMATION {
	ULONG TitleIndex ;
	ULONG Type ;
	ULONG NameLength ;
	WCHAR Name[1] ;
} KEY_VALUE_BASIC_INFORMATION , *  PKEY_VALUE_BASIC_INFORMATION ;

typedef struct _KEY_VALUE_FULL_INFORMATION {
	ULONG TitleIndex ;
	ULONG Type ;
	ULONG DataOffset ;
	ULONG DataLength ;
	ULONG NameLength ;
	WCHAR Name[1] ;
} KEY_VALUE_FULL_INFORMATION , *  PKEY_VALUE_FULL_INFORMATION ;


typedef struct _KEY_VALUE_PARTIAL_INFORMATION {
	ULONG TitleIndex ;
	ULONG Type ;
	ULONG DataLength ;
	UCHAR Data[1] ;
} KEY_VALUE_PARTIAL_INFORMATION , *  PKEY_VALUE_PARTIAL_INFORMATION ;

typedef struct _KEY_VALUE_PARTIAL_INFORMATION_ALIGN64 {
	ULONG Type ;
	ULONG DataLength ;
	UCHAR Data[1] ;
} KEY_VALUE_PARTIAL_INFORMATION_ALIGN64 , * 
	PKEY_VALUE_PARTIAL_INFORMATION_ALIGN64 ;


typedef struct _KEY_VALUE_ENTRY {
	PUNICODE_STRING ValueName ;
	ULONG DataLength ;
	ULONG DataOffset ;
	ULONG Type ;
} KEY_VALUE_ENTRY , *  PKEY_VALUE_ENTRY ;

typedef enum _KEY_VALUE_INFORMATION_CLASS {
	KeyValueBasicInformation,
	KeyValueFullInformation,
	KeyValuePartialInformation,
	KeyValueFullInformationAlign64,
	KeyValuePartialInformationAlign64
} KEY_VALUE_INFORMATION_CLASS ;


typedef struct _OBJECT_NAME_INFORMATION {
	UNICODE_STRING Name ;
} OBJECT_NAME_INFORMATION , *  POBJECT_NAME_INFORMATION ;


typedef enum _SECTION_INHERIT {
	ViewShare = 1,
	ViewUnmap = 2
} SECTION_INHERIT ;


typedef struct _CLIENT_ID {
	HANDLE UniqueProcess ;
	HANDLE UniqueThread ;
} CLIENT_ID ;


typedef CLIENT_ID *  PCLIENT_ID ;


typedef struct _NT_TIB {
	struct _EXCEPTION_REGISTRATION_RECORD *  ExceptionList ;
	PVOID StackBase ;
	PVOID StackLimit ;
	PVOID SubSystemTib ;
	union  {
		PVOID FiberData ;
		ULONG Version ;
	}  ;
	PVOID ArbitraryUserPointer ;
	struct _NT_TIB *  Self ;
} NT_TIB ;


typedef NT_TIB *  PNT_TIB ;


typedef enum _PROCESSINFOCLASS {
	ProcessBasicInformation,
	ProcessQuotaLimits,
	ProcessIoCounters,
	ProcessVmCounters,
	ProcessTimes,
	ProcessBasePriority,
	ProcessRaisePriority,
	ProcessDebugPort,
	ProcessExceptionPort,
	ProcessAccessToken,
	ProcessLdtInformation,
	ProcessLdtSize,
	ProcessDefaultHardErrorMode,
	ProcessIoPortHandlers,
	ProcessPooledUsageAndLimits,
	ProcessWorkingSetWatch,
	ProcessUserModeIOPL,
	ProcessEnableAlignmentFaultFixup,
	ProcessPriorityClass,
	ProcessWx86Information,
	ProcessHandleCount,
	ProcessAffinityMask,
	ProcessPriorityBoost,
	ProcessDeviceMap,
	ProcessSessionInformation,
	ProcessForegroundInformation,
	ProcessWow64Information,
	MaxProcessInfoClass
} PROCESSINFOCLASS ;


typedef enum _THREADINFOCLASS {
	ThreadBasicInformation,
	ThreadTimes,
	ThreadPriority,
	ThreadBasePriority,
	ThreadAffinityMask,
	ThreadImpersonationToken,
	ThreadDescriptorTableEntry,
	ThreadEnableAlignmentFaultFixup,
	ThreadEventPair_Reusable,
	ThreadQuerySetWin32StartAddress,
	ThreadZeroTlsCell,
	ThreadPerformanceCount,
	ThreadAmILastThread,
	ThreadIdealProcessor,
	ThreadPriorityBoost,
	ThreadSetTlsArrayAddress,
	ThreadIsIoPending,
	ThreadHideFromDebugger,
	MaxThreadInfoClass
} THREADINFOCLASS ;


typedef struct _PROCESS_WS_WATCH_INFORMATION {
	PVOID FaultingPc ;
	PVOID FaultingVa ;
} PROCESS_WS_WATCH_INFORMATION , *  PPROCESS_WS_WATCH_INFORMATION ;


typedef struct _PROCESS_BASIC_INFORMATION {
	NTSTATUS ExitStatus ;
	PPEB PebBaseAddress ;
	ULONG_PTR AffinityMask ;
	KPRIORITY BasePriority ;
	ULONG_PTR UniqueProcessId ;
	ULONG_PTR InheritedFromUniqueProcessId ;
} PROCESS_BASIC_INFORMATION ;


typedef PROCESS_BASIC_INFORMATION *  PPROCESS_BASIC_INFORMATION ;


typedef struct _PROCESS_DEVICEMAP_INFORMATION {
	union  {
		struct  {
			HANDLE DirectoryHandle ;
		} Set ;
		struct  {
			ULONG DriveMap ;
			UCHAR DriveType[32] ;
		} Query ;
	}  ;
} PROCESS_DEVICEMAP_INFORMATION , *  PPROCESS_DEVICEMAP_INFORMATION ;


typedef struct _PROCESS_SESSION_INFORMATION {
	ULONG SessionId ;
} PROCESS_SESSION_INFORMATION , *  PPROCESS_SESSION_INFORMATION ;


typedef struct _QUOTA_LIMITS {
	SIZE_T PagedPoolLimit ;
	SIZE_T NonPagedPoolLimit ;
	SIZE_T MinimumWorkingSetSize ;
	SIZE_T MaximumWorkingSetSize ;
	SIZE_T PagefileLimit ;
	LARGE_INTEGER TimeLimit ;
} QUOTA_LIMITS ;


typedef QUOTA_LIMITS *  PQUOTA_LIMITS ;


typedef struct _IO_COUNTERS {
	ULONGLONG ReadOperationCount ;
	ULONGLONG WriteOperationCount ;
	ULONGLONG OtherOperationCount ;
	ULONGLONG ReadTransferCount ;
	ULONGLONG WriteTransferCount ;
	ULONGLONG OtherTransferCount ;
} IO_COUNTERS ;


typedef IO_COUNTERS *  PIO_COUNTERS ;


typedef struct _VM_COUNTERS {
	SIZE_T PeakVirtualSize ;
	SIZE_T VirtualSize ;
	ULONG PageFaultCount ;
	SIZE_T PeakWorkingSetSize ;
	SIZE_T WorkingSetSize ;
	SIZE_T QuotaPeakPagedPoolUsage ;
	SIZE_T QuotaPagedPoolUsage ;
	SIZE_T QuotaPeakNonPagedPoolUsage ;
	SIZE_T QuotaNonPagedPoolUsage ;
	SIZE_T PagefileUsage ;
	SIZE_T PeakPagefileUsage ;
} VM_COUNTERS ;


typedef VM_COUNTERS *  PVM_COUNTERS ;


typedef struct _POOLED_USAGE_AND_LIMITS {
	SIZE_T PeakPagedPoolUsage ;
	SIZE_T PagedPoolUsage ;
	SIZE_T PagedPoolLimit ;
	SIZE_T PeakNonPagedPoolUsage ;
	SIZE_T NonPagedPoolUsage ;
	SIZE_T NonPagedPoolLimit ;
	SIZE_T PeakPagefileUsage ;
	SIZE_T PagefileUsage ;
	SIZE_T PagefileLimit ;
} POOLED_USAGE_AND_LIMITS ;


typedef POOLED_USAGE_AND_LIMITS *  PPOOLED_USAGE_AND_LIMITS ;


typedef struct _PROCESS_ACCESS_TOKEN {
	HANDLE Token ;
	HANDLE Thread ;
} PROCESS_ACCESS_TOKEN , *  PPROCESS_ACCESS_TOKEN ;


typedef struct _KERNEL_USER_TIMES {
	LARGE_INTEGER CreateTime ;
	LARGE_INTEGER ExitTime ;
	LARGE_INTEGER KernelTime ;
	LARGE_INTEGER UserTime ;
} KERNEL_USER_TIMES ;


typedef KERNEL_USER_TIMES *  PKERNEL_USER_TIMES ;


__declspec(dllimport) NTSTATUS __stdcall NtOpenProcess(PHANDLE ProcessHandle ,
	ACCESS_MASK DesiredAccess , POBJECT_ATTRIBUTES ObjectAttributes ,
	PCLIENT_ID ClientId ) ;

__declspec(dllimport) NTSTATUS __stdcall NtQueryInformationProcess(HANDLE
	ProcessHandle , PROCESSINFOCLASS ProcessInformationClass , PVOID
	ProcessInformation , ULONG ProcessInformationLength , PULONG
	ReturnLength ) ;


typedef enum _SYSTEM_POWER_STATE {
	PowerSystemUnspecified = 0,
	PowerSystemWorking,
	PowerSystemSleeping1,
	PowerSystemSleeping2,
	PowerSystemSleeping3,
	PowerSystemHibernate,
	PowerSystemShutdown,
	PowerSystemMaximum
} SYSTEM_POWER_STATE , *  PSYSTEM_POWER_STATE ;

typedef enum  {
	PowerActionNone = 0,
	PowerActionReserved,
	PowerActionSleep,
	PowerActionHibernate,
	PowerActionShutdown,
	PowerActionShutdownReset,
	PowerActionShutdownOff,
	PowerActionWarmEject
} POWER_ACTION , *  PPOWER_ACTION ;

typedef enum _DEVICE_POWER_STATE {
	PowerDeviceUnspecified = 0,
	PowerDeviceD0,
	PowerDeviceD1,
	PowerDeviceD2,
	PowerDeviceD3,
	PowerDeviceMaximum
} DEVICE_POWER_STATE , *  PDEVICE_POWER_STATE ;

typedef union _POWER_STATE {
	SYSTEM_POWER_STATE SystemState ;
	DEVICE_POWER_STATE DeviceState ;
} POWER_STATE , *  PPOWER_STATE ;

typedef enum _POWER_STATE_TYPE {
	SystemPowerState = 0,
	DevicePowerState
} POWER_STATE_TYPE , *  PPOWER_STATE_TYPE ;


typedef ULONG EXECUTION_STATE ;

typedef enum  {
	LT_DONT_CARE,
	LT_LOWEST_LATENCY
} LATENCY_TIME ;


typedef enum  {
	SystemPowerPolicyAc,
	SystemPowerPolicyDc,
	VerifySystemPolicyAc,
	VerifySystemPolicyDc,
	SystemPowerCapabilities,
	SystemBatteryState,
	SystemPowerStateHandler,
	ProcessorStateHandler,
	SystemPowerPolicyCurrent,
	AdministratorPowerPolicy,
	SystemReserveHiberFile,
	ProcessorInformation,
	SystemPowerInformation
} POWER_INFORMATION_LEVEL ;


typedef ULONG PFN_COUNT ;

typedef LONG SPFN_NUMBER , *  PSPFN_NUMBER ;


typedef ULONG PFN_NUMBER , *  PPFN_NUMBER ;


typedef union _MCI_STATS {
	struct  {
		USHORT McaCod ;
		USHORT MsCod ;
		ULONG OtherInfo  : 25;
		ULONG Damage  : 1;
		ULONG AddressValid  : 1;
		ULONG MiscValid  : 1;
		ULONG Enabled  : 1;
		ULONG UnCorrected  : 1;
		ULONG OverFlow  : 1;
		ULONG Valid  : 1;
	} MciStats ;
	ULONGLONG QuadPart ;
} MCI_STATS , *  PMCI_STATS ;


__declspec(dllimport) UCHAR READ_REGISTER_UCHAR(PUCHAR Register ) ;

__declspec(dllimport) USHORT READ_REGISTER_USHORT(PUSHORT Register ) ;

__declspec(dllimport) ULONG READ_REGISTER_ULONG(PULONG Register ) ;

__declspec(dllimport) void READ_REGISTER_BUFFER_UCHAR(PUCHAR Register , PUCHAR
	Buffer , ULONG Count ) ;

__declspec(dllimport) void READ_REGISTER_BUFFER_USHORT(PUSHORT Register ,
	PUSHORT Buffer , ULONG Count ) ;

__declspec(dllimport) void READ_REGISTER_BUFFER_ULONG(PULONG Register , PULONG
	Buffer , ULONG Count ) ;

__declspec(dllimport) void WRITE_REGISTER_UCHAR(PUCHAR Register , UCHAR Value )
	;

__declspec(dllimport) void WRITE_REGISTER_USHORT(PUSHORT Register , USHORT Value
	) ;

__declspec(dllimport) void WRITE_REGISTER_ULONG(PULONG Register , ULONG Value )
	;

__declspec(dllimport) void WRITE_REGISTER_BUFFER_UCHAR(PUCHAR Register , PUCHAR
	Buffer , ULONG Count ) ;

__declspec(dllimport) void WRITE_REGISTER_BUFFER_USHORT(PUSHORT Register ,
	PUSHORT Buffer , ULONG Count ) ;

__declspec(dllimport) void WRITE_REGISTER_BUFFER_ULONG(PULONG Register , PULONG
	Buffer , ULONG Count ) ;

__declspec(dllimport) UCHAR READ_PORT_UCHAR(PUCHAR Port ) ;

__declspec(dllimport) USHORT READ_PORT_USHORT(PUSHORT Port ) ;

__declspec(dllimport) ULONG READ_PORT_ULONG(PULONG Port ) ;

__declspec(dllimport) void READ_PORT_BUFFER_UCHAR(PUCHAR Port , PUCHAR Buffer ,
	ULONG Count ) ;

__declspec(dllimport) void READ_PORT_BUFFER_USHORT(PUSHORT Port , PUSHORT Buffer
	, ULONG Count ) ;

__declspec(dllimport) void READ_PORT_BUFFER_ULONG(PULONG Port , PULONG Buffer ,
	ULONG Count ) ;

__declspec(dllimport) void WRITE_PORT_UCHAR(PUCHAR Port , UCHAR Value ) ;

__declspec(dllimport) void WRITE_PORT_USHORT(PUSHORT Port , USHORT Value ) ;

__declspec(dllimport) void WRITE_PORT_ULONG(PULONG Port , ULONG Value ) ;

__declspec(dllimport) void WRITE_PORT_BUFFER_UCHAR(PUCHAR Port , PUCHAR Buffer ,
	ULONG Count ) ;

__declspec(dllimport) void WRITE_PORT_BUFFER_USHORT(PUSHORT Port , PUSHORT
	Buffer , ULONG Count ) ;

__declspec(dllimport) void WRITE_PORT_BUFFER_ULONG(PULONG Port , PULONG Buffer ,
	ULONG Count ) ;


typedef struct _KPCR {
	NT_TIB NtTib ;
	struct _KPCR *  SelfPcr ;
	struct _KPRCB *  Prcb ;
	KIRQL Irql ;
	ULONG IRR ;
	ULONG IrrActive ;
	ULONG IDR ;
	ULONG Reserved2 ;
	struct _KIDTENTRY *  IDT ;
	struct _KGDTENTRY *  GDT ;
	struct _KTSS *  TSS ;
	USHORT MajorVersion ;
	USHORT MinorVersion ;
	KAFFINITY SetMember ;
	ULONG StallScaleFactor ;
	UCHAR DebugActive ;
	UCHAR Number ;
} KPCR ;


typedef KPCR *  PKPCR ;


typedef struct _KFLOATING_SAVE {
	ULONG ControlWord ;
	ULONG StatusWord ;
	ULONG ErrorOffset ;
	ULONG ErrorSelector ;
	ULONG DataOffset ;
	ULONG DataSelector ;
	ULONG Cr0NpxState ;
	ULONG Spare1 ;
} KFLOATING_SAVE , *  PKFLOATING_SAVE ;


extern PVOID *  MmHighestUserAddress ;
extern PVOID *  MmSystemRangeStart ;
extern ULONG *  MmUserProbeAddress ;


typedef enum _INTERLOCKED_RESULT {
	ResultNegative = 0x8000 & ~ 0x4000 & (0x8000 | 0x4000),
	ResultZero = ~ 0x8000 & 0x4000 & (0x8000 | 0x4000),
	ResultPositive = ~ 0x8000 & ~ 0x4000 & (0x8000 | 0x4000)
} INTERLOCKED_RESULT ;

__declspec(dllimport) INTERLOCKED_RESULT _fastcall
	Exfi386InterlockedIncrementLong(PLONG Addend ) ;

__declspec(dllimport) INTERLOCKED_RESULT _fastcall
	Exfi386InterlockedDecrementLong(PLONG Addend ) ;

__declspec(dllimport) LARGE_INTEGER
	ExInterlockedExchangeAddLargeInteger(PLARGE_INTEGER Addend ,
	LARGE_INTEGER Increment , PKSPIN_LOCK Lock ) ;

__declspec(dllimport) ULONG _fastcall Exfi386InterlockedExchangeUlong(PULONG
	Target , ULONG Value ) ;

__declspec(dllimport) LONG _fastcall InterlockedIncrement(PLONG Addend ) { return (*Addend)++;}

__declspec(dllimport) LONG _fastcall InterlockedDecrement(PLONG Addend ) { return (*Addend)--;}

__declspec(dllimport) LONG _fastcall InterlockedExchange(PLONG Target , LONG
	Value ) ;

LONG _fastcall InterlockedExchangeAdd(PLONG Addend , LONG Increment ) ;

__declspec(dllimport) LONG _fastcall InterlockedCompareExchange(PLONG
	Destination , LONG ExChange , LONG Comperand ) ;



#pragma warning(disable:4035)

__declspec(dllimport) KIRQL KeGetCurrentIrql() ;


__inline ULONG KeGetCurrentProcessorNumber(void  )
{
/*
	__asm {  movzx eax, fs:[0] KPCR.Number  };
*/
}


__declspec(dllimport) NTSTATUS __stdcall
	KeSaveFloatingPointState(PKFLOATING_SAVE FloatSave ) ;

__declspec(dllimport) NTSTATUS __stdcall
	KeRestoreFloatingPointState(PKFLOATING_SAVE FloatSave ) ;


typedef struct _KSYSTEM_TIME {
	ULONG LowPart ;
	LONG High1Time ;
	LONG High2Time ;
} KSYSTEM_TIME , *  PKSYSTEM_TIME ;



#pragma warning(push)

#pragma warning(disable:4164)


#pragma function(_enable)


#pragma function(_disable)


#pragma warning(pop)

typedef struct _FLOATING_SAVE_AREA {
	ULONG ControlWord ;
	ULONG StatusWord ;
	ULONG TagWord ;
	ULONG ErrorOffset ;
	ULONG ErrorSelector ;
	ULONG DataOffset ;
	ULONG DataSelector ;
	UCHAR RegisterArea[80] ;
	ULONG Cr0NpxState ;
} FLOATING_SAVE_AREA ;

typedef FLOATING_SAVE_AREA *  PFLOATING_SAVE_AREA ;


typedef struct _CONTEXT {
	ULONG ContextFlags ;
	ULONG Dr0 ;
	ULONG Dr1 ;
	ULONG Dr2 ;
	ULONG Dr3 ;
	ULONG Dr6 ;
	ULONG Dr7 ;
	FLOATING_SAVE_AREA FloatSave ;
	ULONG SegGs ;
	ULONG SegFs ;
	ULONG SegEs ;
	ULONG SegDs ;
	ULONG Edi ;
	ULONG Esi ;
	ULONG Ebx ;
	ULONG Edx ;
	ULONG Ecx ;
	ULONG Eax ;
	ULONG Ebp ;
	ULONG Eip ;
	ULONG SegCs ;
	ULONG EFlags ;
	ULONG Esp ;
	ULONG SegSs ;
	UCHAR ExtendedRegisters[512] ;
} CONTEXT ;


typedef CONTEXT *  PCONTEXT ;


typedef void ( *  PTIMER_APC_ROUTINE )(PVOID TimerContext , ULONG TimerLowValue
	, LONG TimerHighValue ) ;


typedef enum _ALTERNATIVE_ARCHITECTURE_TYPE {
	StandardDesign,
	NEC98x86,
	EndAlternatives
} ALTERNATIVE_ARCHITECTURE_TYPE ;


typedef struct _KUSER_SHARED_DATA {
	volatile ULONG TickCountLow ;
	ULONG TickCountMultiplier ;
	volatile KSYSTEM_TIME InterruptTime ;
	volatile KSYSTEM_TIME SystemTime ;
	volatile KSYSTEM_TIME TimeZoneBias ;
	USHORT ImageNumberLow ;
	USHORT ImageNumberHigh ;
	WCHAR NtSystemRoot[260] ;
	ULONG MaxStackTraceDepth ;
	ULONG CryptoExponent ;
	ULONG TimeZoneId ;
	ULONG Reserved2[8] ;
	NT_PRODUCT_TYPE NtProductType ;
	BOOLEAN ProductTypeIsValid ;
	ULONG NtMajorVersion ;
	ULONG NtMinorVersion ;
	BOOLEAN ProcessorFeatures[64] ;
	ULONG Reserved1 ;
	ULONG Reserved3 ;
	volatile ULONG TimeSlip ;
	ALTERNATIVE_ARCHITECTURE_TYPE AlternativeArchitecture ;
	LARGE_INTEGER SystemExpirationDate ;
	ULONG SuiteMask ;
	BOOLEAN KdDebuggerEnabled ;
} KUSER_SHARED_DATA , *  PKUSER_SHARED_DATA ;


typedef enum _CM_SERVICE_NODE_TYPE {
	DriverType = 0x00000001,
	FileSystemType = 0x00000002,
	Win32ServiceOwnProcess = 0x00000010,
	Win32ServiceShareProcess = 0x00000020,
	AdapterType = 0x00000004,
	RecognizerType = 0x00000008
} SERVICE_NODE_TYPE ;

typedef enum _CM_SERVICE_LOAD_TYPE {
	BootLoad = 0x00000000,
	SystemLoad = 0x00000001,
	AutoLoad = 0x00000002,
	DemandLoad = 0x00000003,
	DisableLoad = 0x00000004
} SERVICE_LOAD_TYPE ;

typedef enum _CM_ERROR_CONTROL_TYPE {
	IgnoreError = 0x00000000,
	NormalError = 0x00000001,
	SevereError = 0x00000002,
	CriticalError = 0x00000003
} SERVICE_ERROR_TYPE ;


typedef int CM_RESOURCE_TYPE ;


typedef enum _CM_SHARE_DISPOSITION {
	CmResourceShareUndetermined = 0,
	CmResourceShareDeviceExclusive,
	CmResourceShareDriverExclusive,
	CmResourceShareShared
} CM_SHARE_DISPOSITION ;


typedef PVOID PASSIGNED_RESOURCE ;



#pragma warning(disable:4103)

#pragma pack(push, 4)

typedef struct _CM_PARTIAL_RESOURCE_DESCRIPTOR {
	UCHAR Type ;
	UCHAR ShareDisposition ;
	USHORT Flags ;
	union  {
		struct  {
			PHYSICAL_ADDRESS Start ;
			ULONG Length ;
		} Generic ;
		struct  {
			PHYSICAL_ADDRESS Start ;
			ULONG Length ;
		} Port ;
		struct  {
			ULONG Level ;
			ULONG Vector ;
			ULONG Affinity ;
		} Interrupt ;
		struct  {
			PHYSICAL_ADDRESS Start ;
			ULONG Length ;
		} Memory ;
		struct  {
			ULONG Channel ;
			ULONG Port ;
			ULONG Reserved1 ;
		} Dma ;
		struct  {
			ULONG Data[3] ;
		} DevicePrivate ;
		struct  {
			ULONG Start ;
			ULONG Length ;
			ULONG Reserved ;
		} BusNumber ;
		struct  {
			ULONG DataSize ;
			ULONG Reserved1 ;
			ULONG Reserved2 ;
		} DeviceSpecificData ;
	} u ;
} CM_PARTIAL_RESOURCE_DESCRIPTOR , *  PCM_PARTIAL_RESOURCE_DESCRIPTOR ;



#pragma warning(disable:4103)

#pragma pack(pop)

typedef struct _CM_PARTIAL_RESOURCE_LIST {
	USHORT Version ;
	USHORT Revision ;
	ULONG Count ;
	CM_PARTIAL_RESOURCE_DESCRIPTOR PartialDescriptors[1] ;
} CM_PARTIAL_RESOURCE_LIST , *  PCM_PARTIAL_RESOURCE_LIST ;


typedef struct _CM_FULL_RESOURCE_DESCRIPTOR {
	INTERFACE_TYPE InterfaceType ;
	ULONG BusNumber ;
	CM_PARTIAL_RESOURCE_LIST PartialResourceList ;
} CM_FULL_RESOURCE_DESCRIPTOR , *  PCM_FULL_RESOURCE_DESCRIPTOR ;


typedef struct _CM_RESOURCE_LIST {
	ULONG Count ;
	CM_FULL_RESOURCE_DESCRIPTOR List[1] ;
} CM_RESOURCE_LIST , *  PCM_RESOURCE_LIST ;


typedef struct _DEVICE_FLAGS {
	ULONG Failed  : 1;
	ULONG ReadOnly  : 1;
	ULONG Removable  : 1;
	ULONG ConsoleIn  : 1;
	ULONG ConsoleOut  : 1;
	ULONG Input  : 1;
	ULONG Output  : 1;
} DEVICE_FLAGS , *  PDEVICE_FLAGS ;


typedef struct _CM_COMPONENT_INFORMATION {
	DEVICE_FLAGS Flags ;
	ULONG Version ;
	ULONG Key ;
	ULONG AffinityMask ;
} CM_COMPONENT_INFORMATION , *  PCM_COMPONENT_INFORMATION ;


typedef struct _CM_ROM_BLOCK {
	ULONG Address ;
	ULONG Size ;
} CM_ROM_BLOCK , *  PCM_ROM_BLOCK ;



#pragma warning(disable:4103)

#pragma pack(push, 1)

typedef struct _CM_INT13_DRIVE_PARAMETER {
	USHORT DriveSelect ;
	ULONG MaxCylinders ;
	USHORT SectorsPerTrack ;
	USHORT MaxHeads ;
	USHORT NumberDrives ;
} CM_INT13_DRIVE_PARAMETER , *  PCM_INT13_DRIVE_PARAMETER ;


typedef struct _CM_MCA_POS_DATA {
	USHORT AdapterId ;
	UCHAR PosData1 ;
	UCHAR PosData2 ;
	UCHAR PosData3 ;
	UCHAR PosData4 ;
} CM_MCA_POS_DATA , *  PCM_MCA_POS_DATA ;


typedef struct _EISA_MEMORY_TYPE {
	UCHAR ReadWrite  : 1;
	UCHAR Cached  : 1;
	UCHAR Reserved0  : 1;
	UCHAR Type  : 2;
	UCHAR Shared  : 1;
	UCHAR Reserved1  : 1;
	UCHAR MoreEntries  : 1;
} EISA_MEMORY_TYPE , *  PEISA_MEMORY_TYPE ;

typedef struct _EISA_MEMORY_CONFIGURATION {
	EISA_MEMORY_TYPE ConfigurationByte ;
	UCHAR DataSize ;
	USHORT AddressLowWord ;
	UCHAR AddressHighByte ;
	USHORT MemorySize ;
} EISA_MEMORY_CONFIGURATION , *  PEISA_MEMORY_CONFIGURATION ;


typedef struct _EISA_IRQ_DESCRIPTOR {
	UCHAR Interrupt  : 4;
	UCHAR Reserved  : 1;
	UCHAR LevelTriggered  : 1;
	UCHAR Shared  : 1;
	UCHAR MoreEntries  : 1;
} EISA_IRQ_DESCRIPTOR , *  PEISA_IRQ_DESCRIPTOR ;

typedef struct _EISA_IRQ_CONFIGURATION {
	EISA_IRQ_DESCRIPTOR ConfigurationByte ;
	UCHAR Reserved ;
} EISA_IRQ_CONFIGURATION , *  PEISA_IRQ_CONFIGURATION ;


typedef struct _DMA_CONFIGURATION_BYTE0 {
	UCHAR Channel  : 3;
	UCHAR Reserved  : 3;
	UCHAR Shared  : 1;
	UCHAR MoreEntries  : 1;
} DMA_CONFIGURATION_BYTE0 ;

typedef struct _DMA_CONFIGURATION_BYTE1 {
	UCHAR Reserved0  : 2;
	UCHAR TransferSize  : 2;
	UCHAR Timing  : 2;
	UCHAR Reserved1  : 2;
} DMA_CONFIGURATION_BYTE1 ;

typedef struct _EISA_DMA_CONFIGURATION {
	DMA_CONFIGURATION_BYTE0 ConfigurationByte0 ;
	DMA_CONFIGURATION_BYTE1 ConfigurationByte1 ;
} EISA_DMA_CONFIGURATION , *  PEISA_DMA_CONFIGURATION ;


typedef struct _EISA_PORT_DESCRIPTOR {
	UCHAR NumberPorts  : 5;
	UCHAR Reserved  : 1;
	UCHAR Shared  : 1;
	UCHAR MoreEntries  : 1;
} EISA_PORT_DESCRIPTOR , *  PEISA_PORT_DESCRIPTOR ;

typedef struct _EISA_PORT_CONFIGURATION {
	EISA_PORT_DESCRIPTOR Configuration ;
	USHORT PortAddress ;
} EISA_PORT_CONFIGURATION , *  PEISA_PORT_CONFIGURATION ;


typedef struct _CM_EISA_SLOT_INFORMATION {
	UCHAR ReturnCode ;
	UCHAR ReturnFlags ;
	UCHAR MajorRevision ;
	UCHAR MinorRevision ;
	USHORT Checksum ;
	UCHAR NumberFunctions ;
	UCHAR FunctionInformation ;
	ULONG CompressedId ;
} CM_EISA_SLOT_INFORMATION , *  PCM_EISA_SLOT_INFORMATION ;


typedef struct _CM_EISA_FUNCTION_INFORMATION {
	ULONG CompressedId ;
	UCHAR IdSlotFlags1 ;
	UCHAR IdSlotFlags2 ;
	UCHAR MinorRevision ;
	UCHAR MajorRevision ;
	UCHAR Selections[26] ;
	UCHAR FunctionFlags ;
	UCHAR TypeString[80] ;
	EISA_MEMORY_CONFIGURATION EisaMemory[9] ;
	EISA_IRQ_CONFIGURATION EisaIrq[7] ;
	EISA_DMA_CONFIGURATION EisaDma[4] ;
	EISA_PORT_CONFIGURATION EisaPort[20] ;
	UCHAR InitializationData[60] ;
} CM_EISA_FUNCTION_INFORMATION , *  PCM_EISA_FUNCTION_INFORMATION ;


typedef struct _CM_PNP_BIOS_DEVICE_NODE {
	USHORT Size ;
	UCHAR Node ;
	ULONG ProductId ;
	UCHAR DeviceType[3] ;
	USHORT DeviceAttributes ;
} CM_PNP_BIOS_DEVICE_NODE , *  PCM_PNP_BIOS_DEVICE_NODE ;


typedef struct _CM_PNP_BIOS_INSTALLATION_CHECK {
	UCHAR Signature[4] ;
	UCHAR Revision ;
	UCHAR Length ;
	USHORT ControlField ;
	UCHAR Checksum ;
	ULONG EventFlagAddress ;
	USHORT RealModeEntryOffset ;
	USHORT RealModeEntrySegment ;
	USHORT ProtectedModeEntryOffset ;
	ULONG ProtectedModeCodeBaseAddress ;
	ULONG OemDeviceId ;
	USHORT RealModeDataBaseAddress ;
	ULONG ProtectedModeDataBaseAddress ;
} CM_PNP_BIOS_INSTALLATION_CHECK , *  PCM_PNP_BIOS_INSTALLATION_CHECK ;



#pragma warning(disable:4103)

#pragma pack(pop)

typedef struct _CM_SCSI_DEVICE_DATA {
	USHORT Version ;
	USHORT Revision ;
	UCHAR HostIdentifier ;
} CM_SCSI_DEVICE_DATA , *  PCM_SCSI_DEVICE_DATA ;


typedef struct _CM_VIDEO_DEVICE_DATA {
	USHORT Version ;
	USHORT Revision ;
	ULONG VideoClock ;
} CM_VIDEO_DEVICE_DATA , *  PCM_VIDEO_DEVICE_DATA ;


typedef struct _CM_SONIC_DEVICE_DATA {
	USHORT Version ;
	USHORT Revision ;
	USHORT DataConfigurationRegister ;
	UCHAR EthernetAddress[8] ;
} CM_SONIC_DEVICE_DATA , *  PCM_SONIC_DEVICE_DATA ;


typedef struct _CM_SERIAL_DEVICE_DATA {
	USHORT Version ;
	USHORT Revision ;
	ULONG BaudClock ;
} CM_SERIAL_DEVICE_DATA , *  PCM_SERIAL_DEVICE_DATA ;


typedef struct _CM_MONITOR_DEVICE_DATA {
	USHORT Version ;
	USHORT Revision ;
	USHORT HorizontalScreenSize ;
	USHORT VerticalScreenSize ;
	USHORT HorizontalResolution ;
	USHORT VerticalResolution ;
	USHORT HorizontalDisplayTimeLow ;
	USHORT HorizontalDisplayTime ;
	USHORT HorizontalDisplayTimeHigh ;
	USHORT HorizontalBackPorchLow ;
	USHORT HorizontalBackPorch ;
	USHORT HorizontalBackPorchHigh ;
	USHORT HorizontalFrontPorchLow ;
	USHORT HorizontalFrontPorch ;
	USHORT HorizontalFrontPorchHigh ;
	USHORT HorizontalSyncLow ;
	USHORT HorizontalSync ;
	USHORT HorizontalSyncHigh ;
	USHORT VerticalBackPorchLow ;
	USHORT VerticalBackPorch ;
	USHORT VerticalBackPorchHigh ;
	USHORT VerticalFrontPorchLow ;
	USHORT VerticalFrontPorch ;
	USHORT VerticalFrontPorchHigh ;
	USHORT VerticalSyncLow ;
	USHORT VerticalSync ;
	USHORT VerticalSyncHigh ;
} CM_MONITOR_DEVICE_DATA , *  PCM_MONITOR_DEVICE_DATA ;


typedef struct _CM_FLOPPY_DEVICE_DATA {
	USHORT Version ;
	USHORT Revision ;
	CHAR Size[8] ;
	ULONG MaxDensity ;
	ULONG MountDensity ;
	UCHAR StepRateHeadUnloadTime ;
	UCHAR HeadLoadTime ;
	UCHAR MotorOffTime ;
	UCHAR SectorLengthCode ;
	UCHAR SectorPerTrack ;
	UCHAR ReadWriteGapLength ;
	UCHAR DataTransferLength ;
	UCHAR FormatGapLength ;
	UCHAR FormatFillCharacter ;
	UCHAR HeadSettleTime ;
	UCHAR MotorSettleTime ;
	UCHAR MaximumTrackValue ;
	UCHAR DataTransferRate ;
} CM_FLOPPY_DEVICE_DATA , *  PCM_FLOPPY_DEVICE_DATA ;


typedef struct _CM_KEYBOARD_DEVICE_DATA {
	USHORT Version ;
	USHORT Revision ;
	UCHAR Type ;
	UCHAR Subtype ;
	USHORT KeyboardFlags ;
} CM_KEYBOARD_DEVICE_DATA , *  PCM_KEYBOARD_DEVICE_DATA ;


typedef struct _CM_DISK_GEOMETRY_DEVICE_DATA {
	ULONG BytesPerSector ;
	ULONG NumberOfCylinders ;
	ULONG SectorsPerTrack ;
	ULONG NumberOfHeads ;
} CM_DISK_GEOMETRY_DEVICE_DATA , *  PCM_DISK_GEOMETRY_DEVICE_DATA ;


typedef struct _CM_PCCARD_DEVICE_DATA {
	UCHAR Flags ;
	UCHAR ErrorCode ;
	USHORT Reserved ;
	ULONG BusData ;
	ULONG DeviceId ;
	ULONG LegacyBaseAddress ;
	UCHAR IRQMap[16] ;
} CM_PCCARD_DEVICE_DATA , *  PCM_PCCARD_DEVICE_DATA ;


typedef struct _IO_RESOURCE_DESCRIPTOR {
	UCHAR Option ;
	UCHAR Type ;
	UCHAR ShareDisposition ;
	UCHAR Spare1 ;
	USHORT Flags ;
	USHORT Spare2 ;
	union  {
		struct  {
			ULONG Length ;
			ULONG Alignment ;
			PHYSICAL_ADDRESS MinimumAddress ;
			PHYSICAL_ADDRESS MaximumAddress ;
		} Port ;
		struct  {
			ULONG Length ;
			ULONG Alignment ;
			PHYSICAL_ADDRESS MinimumAddress ;
			PHYSICAL_ADDRESS MaximumAddress ;
		} Memory ;
		struct  {
			ULONG MinimumVector ;
			ULONG MaximumVector ;
		} Interrupt ;
		struct  {
			ULONG MinimumChannel ;
			ULONG MaximumChannel ;
		} Dma ;
		struct  {
			ULONG Length ;
			ULONG Alignment ;
			PHYSICAL_ADDRESS MinimumAddress ;
			PHYSICAL_ADDRESS MaximumAddress ;
		} Generic ;
		struct  {
			ULONG Data[3] ;
		} DevicePrivate ;
		struct  {
			ULONG Length ;
			ULONG MinBusNumber ;
			ULONG MaxBusNumber ;
			ULONG Reserved ;
		} BusNumber ;
		struct  {
			PASSIGNED_RESOURCE AssignedResource ;
		} AssignedResource ;
		struct  {
			UCHAR Type ;
			UCHAR Reserved[3] ;
			PASSIGNED_RESOURCE AssignedResource ;
			PHYSICAL_ADDRESS Transformation ;
		} SubAllocateFrom ;
		struct  {
			ULONG Priority ;
			ULONG Reserved1 ;
			ULONG Reserved2 ;
		} ConfigData ;
	} u ;
} IO_RESOURCE_DESCRIPTOR , *  PIO_RESOURCE_DESCRIPTOR ;


typedef struct _IO_RESOURCE_LIST {
	USHORT Version ;
	USHORT Revision ;
	ULONG Count ;
	IO_RESOURCE_DESCRIPTOR Descriptors[1] ;
} IO_RESOURCE_LIST , *  PIO_RESOURCE_LIST ;


typedef struct _IO_RESOURCE_REQUIREMENTS_LIST {
	ULONG ListSize ;
	INTERFACE_TYPE InterfaceType ;
	ULONG BusNumber ;
	ULONG SlotNumber ;
	ULONG Reserved[3] ;
	ULONG AlternativeLists ;
	IO_RESOURCE_LIST List[1] ;
} IO_RESOURCE_REQUIREMENTS_LIST , *  PIO_RESOURCE_REQUIREMENTS_LIST ;


typedef struct _EXCEPTION_RECORD {
	NTSTATUS ExceptionCode ;
	ULONG ExceptionFlags ;
	struct _EXCEPTION_RECORD *  ExceptionRecord ;
	PVOID ExceptionAddress ;
	ULONG NumberParameters ;
	ULONG_PTR ExceptionInformation[15] ;
} EXCEPTION_RECORD ;

typedef EXCEPTION_RECORD *  PEXCEPTION_RECORD ;

typedef struct _EXCEPTION_RECORD32 {
	NTSTATUS ExceptionCode ;
	ULONG ExceptionFlags ;
	ULONG ExceptionRecord ;
	ULONG ExceptionAddress ;
	ULONG NumberParameters ;
	ULONG ExceptionInformation[15] ;
} EXCEPTION_RECORD32 , *  PEXCEPTION_RECORD32 ;

typedef struct _EXCEPTION_RECORD64 {
	NTSTATUS ExceptionCode ;
	ULONG ExceptionFlags ;
	ULONG64 ExceptionRecord ;
	ULONG64 ExceptionAddress ;
	ULONG NumberParameters ;
	ULONG __unusedAlignment ;
	ULONG64 ExceptionInformation[15] ;
} EXCEPTION_RECORD64 , *  PEXCEPTION_RECORD64 ;


typedef struct _EXCEPTION_POINTERS {
	PEXCEPTION_RECORD ExceptionRecord ;
	PCONTEXT ContextRecord ;
} EXCEPTION_POINTERS , *  PEXCEPTION_POINTERS ;


typedef enum _CONFIGURATION_TYPE {
	ArcSystem,
	CentralProcessor,
	FloatingPointProcessor,
	PrimaryIcache,
	PrimaryDcache,
	SecondaryIcache,
	SecondaryDcache,
	SecondaryCache,
	EisaAdapter,
	TcAdapter,
	ScsiAdapter,
	DtiAdapter,
	MultiFunctionAdapter,
	DiskController,
	TapeController,
	CdromController,
	WormController,
	SerialController,
	NetworkController,
	DisplayController,
	ParallelController,
	PointerController,
	KeyboardController,
	AudioController,
	OtherController,
	DiskPeripheral,
	FloppyDiskPeripheral,
	TapePeripheral,
	ModemPeripheral,
	MonitorPeripheral,
	PrinterPeripheral,
	PointerPeripheral,
	KeyboardPeripheral,
	TerminalPeripheral,
	OtherPeripheral,
	LinePeripheral,
	NetworkPeripheral,
	SystemMemory,
	DockingInformation,
	RealModeIrqRoutingTable,
	MaximumType
} CONFIGURATION_TYPE , *  PCONFIGURATION_TYPE ;


typedef enum _KINTERRUPT_MODE {
	LevelSensitive,
	Latched
} KINTERRUPT_MODE ;


typedef enum _KWAIT_REASON {
	Executive,
	FreePage,
	PageIn,
	PoolAllocation,
	DelayExecution,
	Suspended,
	UserRequest,
	WrExecutive,
	WrFreePage,
	WrPageIn,
	WrPoolAllocation,
	WrDelayExecution,
	WrSuspended,
	WrUserRequest,
	WrEventPair,
	WrQueue,
	WrLpcReceive,
	WrLpcReply,
	WrVirtualMemory,
	WrPageOut,
	WrRendezvous,
	Spare2,
	Spare3,
	Spare4,
	Spare5,
	Spare6,
	WrKernel,
	MaximumWaitReason
} KWAIT_REASON ;


typedef struct _DISPATCHER_HEADER {
	UCHAR Type ;
	UCHAR Absolute ;
	UCHAR Size ;
	UCHAR Inserted ;
	LONG SignalState ;
	LIST_ENTRY WaitListHead ;
} DISPATCHER_HEADER ;


typedef struct _KWAIT_BLOCK {
	LIST_ENTRY WaitListEntry ;
	struct _KTHREAD *  Thread ;
	PVOID Object ;
	struct _KWAIT_BLOCK *  NextWaitBlock ;
	USHORT WaitKey ;
	USHORT WaitType ;
} KWAIT_BLOCK , *  PKWAIT_BLOCK , *  PRKWAIT_BLOCK ;


typedef void ( *  PKSTART_ROUTINE )(PVOID StartContext ) ;


typedef struct _KDEVICE_QUEUE {
	CSHORT Type ;
	CSHORT Size ;
	LIST_ENTRY DeviceListHead ;
	KSPIN_LOCK Lock ;
	BOOLEAN Busy ;
} KDEVICE_QUEUE , *  PKDEVICE_QUEUE , *  PRKDEVICE_QUEUE ;

typedef struct _KDEVICE_QUEUE_ENTRY {
	LIST_ENTRY DeviceListEntry ;
	ULONG SortKey ;
	BOOLEAN Inserted ;
} KDEVICE_QUEUE_ENTRY , *  PKDEVICE_QUEUE_ENTRY , *  PRKDEVICE_QUEUE_ENTRY ;


typedef struct _KEVENT {
	DISPATCHER_HEADER Header ;
} KEVENT , *  PKEVENT , *  PRKEVENT ;


typedef BOOLEAN ( *  PKSERVICE_ROUTINE )(struct _KINTERRUPT *  Interrupt , PVOID
	ServiceContext ) ;


typedef struct _KMUTANT {
	DISPATCHER_HEADER Header ;
	LIST_ENTRY MutantListEntry ;
	struct _KTHREAD *  OwnerThread ;
	BOOLEAN Abandoned ;
	UCHAR ApcDisable ;
} KMUTANT , *  PKMUTANT , *  PRKMUTANT , KMUTEX , *  PKMUTEX , *  PRKMUTEX ;


typedef struct _KSEMAPHORE {
	DISPATCHER_HEADER Header ;
	LONG Limit ;
} KSEMAPHORE , *  PKSEMAPHORE , *  PRKSEMAPHORE ;


typedef struct _KTIMER {
	DISPATCHER_HEADER Header ;
	ULARGE_INTEGER DueTime ;
	LIST_ENTRY TimerListEntry ;
	struct _KDPC *  Dpc ;
	LONG Period ;
} KTIMER , *  PKTIMER , *  PRKTIMER ;


__declspec(dllimport) void KeInitializeDpc(PRKDPC Dpc , PKDEFERRED_ROUTINE
	DeferredRoutine , PVOID DeferredContext ) ;

__declspec(dllimport) BOOLEAN KeInsertQueueDpc(PRKDPC Dpc , PVOID
	SystemArgument1 , PVOID SystemArgument2 ) ;

__declspec(dllimport) BOOLEAN KeRemoveQueueDpc(PRKDPC Dpc ) ;

__declspec(dllimport) void KeSetImportanceDpc(PRKDPC Dpc , KDPC_IMPORTANCE
	Importance ) ;

__declspec(dllimport) void KeSetTargetProcessorDpc(PRKDPC Dpc , CCHAR Number ) ;

__declspec(dllimport) void KeInitializeDeviceQueue(PKDEVICE_QUEUE DeviceQueue )
	;

__declspec(dllimport) BOOLEAN KeInsertDeviceQueue(PKDEVICE_QUEUE DeviceQueue ,
	PKDEVICE_QUEUE_ENTRY DeviceQueueEntry ) ;

__declspec(dllimport) BOOLEAN KeInsertByKeyDeviceQueue(PKDEVICE_QUEUE
	DeviceQueue , PKDEVICE_QUEUE_ENTRY DeviceQueueEntry , ULONG SortKey ) ;

__declspec(dllimport) PKDEVICE_QUEUE_ENTRY KeRemoveDeviceQueue(PKDEVICE_QUEUE
	DeviceQueue ) ;

__declspec(dllimport) PKDEVICE_QUEUE_ENTRY
	KeRemoveByKeyDeviceQueue(PKDEVICE_QUEUE DeviceQueue , ULONG SortKey ) ;

__declspec(dllimport) BOOLEAN KeRemoveEntryDeviceQueue(PKDEVICE_QUEUE
	DeviceQueue , PKDEVICE_QUEUE_ENTRY DeviceQueueEntry ) ;

__declspec(dllimport) BOOLEAN KeSynchronizeExecution(PKINTERRUPT Interrupt ,
	PKSYNCHRONIZE_ROUTINE SynchronizeRoutine , PVOID SynchronizeContext ) ;

__declspec(dllimport) void KeInitializeEvent(PRKEVENT Event , EVENT_TYPE Type ,
	BOOLEAN State ) ;

__declspec(dllimport) void KeClearEvent(PRKEVENT Event ) ;

__declspec(dllimport) LONG KePulseEvent(PRKEVENT Event , KPRIORITY Increment ,
	BOOLEAN Wait ) ;

__declspec(dllimport) LONG KeReadStateEvent(PRKEVENT Event ) ;

__declspec(dllimport) LONG KeResetEvent(PRKEVENT Event ) ;

__declspec(dllimport) LONG KeSetEvent(PRKEVENT Event , KPRIORITY Increment ,
	BOOLEAN Wait ) ;

__declspec(dllimport) void KeInitializeMutex(PRKMUTEX Mutex , ULONG Level ) ;

__declspec(dllimport) LONG KeReleaseMutex(PRKMUTEX Mutex , BOOLEAN Wait ) ;

__declspec(dllimport) void KeInitializeSemaphore(PRKSEMAPHORE Semaphore , LONG
	Count , LONG Limit ) ;

__declspec(dllimport) LONG KeReadStateSemaphore(PRKSEMAPHORE Semaphore ) ;

__declspec(dllimport) LONG KeReleaseSemaphore(PRKSEMAPHORE Semaphore , KPRIORITY
	Increment , LONG Adjustment , BOOLEAN Wait ) ;

__declspec(dllimport) NTSTATUS KeDelayExecutionThread(KPROCESSOR_MODE WaitMode ,
	BOOLEAN Alertable , PLARGE_INTEGER Interval ) ;

__declspec(dllimport) KPRIORITY KeQueryPriorityThread(PKTHREAD Thread ) ;

__declspec(dllimport) LONG KeSetBasePriorityThread(PKTHREAD Thread , LONG
	Increment ) ;

__declspec(dllimport) KPRIORITY KeSetPriorityThread(PKTHREAD Thread , KPRIORITY
	Priority ) ;

__declspec(dllimport) void KeEnterCriticalRegion(void  ) ;

__declspec(dllimport) void KeLeaveCriticalRegion(void  ) ;

__declspec(dllimport) void KeInitializeTimer(PKTIMER Timer ) ;

__declspec(dllimport) void KeInitializeTimerEx(PKTIMER Timer , TIMER_TYPE Type )
	;

__declspec(dllimport) BOOLEAN KeCancelTimer(PKTIMER ) ;

__declspec(dllimport) BOOLEAN KeReadStateTimer(PKTIMER Timer ) ;

__declspec(dllimport) BOOLEAN KeSetTimer(PKTIMER Timer , LARGE_INTEGER DueTime ,
	PKDPC Dpc ) ;

__declspec(dllimport) BOOLEAN KeSetTimerEx(PKTIMER Timer , LARGE_INTEGER DueTime
	, LONG Period , PKDPC Dpc ) ;

__declspec(dllimport) NTSTATUS KeWaitForMultipleObjects(ULONG Count , PVOID
	Object[] , WAIT_TYPE WaitType , KWAIT_REASON WaitReason ,
	KPROCESSOR_MODE WaitMode , BOOLEAN Alertable , PLARGE_INTEGER Timeout ,
	PKWAIT_BLOCK WaitBlockArray ) ;

__declspec(dllimport) NTSTATUS KeWaitForSingleObject(PVOID Object , KWAIT_REASON
	WaitReason , KPROCESSOR_MODE WaitMode , BOOLEAN Alertable ,
	PLARGE_INTEGER Timeout ) ;

__declspec(dllimport) void __stdcall KeInitializeSpinLock(PKSPIN_LOCK SpinLock )
	;

__declspec(dllimport) void _fastcall KefAcquireSpinLockAtDpcLevel(PKSPIN_LOCK
	SpinLock ) ;

__declspec(dllimport) void _fastcall KefReleaseSpinLockFromDpcLevel(PKSPIN_LOCK
	SpinLock ) ;

__declspec(dllimport) KIRQL _fastcall KfAcquireSpinLock(PKSPIN_LOCK SpinLock ) ;

__declspec(dllimport) void _fastcall KfReleaseSpinLock(PKSPIN_LOCK SpinLock ,
	KIRQL NewIrql ) ;

__declspec(dllimport) KIRQL _fastcall KeAcquireSpinLockRaiseToSynch(PKSPIN_LOCK
	SpinLock ) ;

__declspec(dllimport) void _fastcall KfLowerIrql(KIRQL NewIrql ) ;

__declspec(dllimport) KIRQL _fastcall KfRaiseIrql(KIRQL NewIrql ) ;

__declspec(dllimport) KIRQL KeRaiseIrqlToDpcLevel(void  ) ;

__declspec(dllimport) KIRQL KeRaiseIrqlToSynchLevel(void  ) ;

BOOLEAN KeGetBugMessageText(ULONG MessageId , PANSI_STRING ReturnedString ) ;


typedef enum _KBUGCHECK_BUFFER_DUMP_STATE {
	BufferEmpty,
	BufferInserted,
	BufferStarted,
	BufferFinished,
	BufferIncomplete
} KBUGCHECK_BUFFER_DUMP_STATE ;

typedef void ( *  PKBUGCHECK_CALLBACK_ROUTINE )(PVOID Buffer , ULONG Length ) ;


typedef struct _KBUGCHECK_CALLBACK_RECORD {
	LIST_ENTRY Entry ;
	PKBUGCHECK_CALLBACK_ROUTINE CallbackRoutine ;
	PVOID Buffer ;
	ULONG Length ;
	PUCHAR Component ;
	ULONG_PTR Checksum ;
	UCHAR State ;
} KBUGCHECK_CALLBACK_RECORD , *  PKBUGCHECK_CALLBACK_RECORD ;

__declspec(dllimport) __declspec(noreturn) void __stdcall KeBugCheck(ULONG
	BugCheckCode ) ;

__declspec(dllimport) __declspec(noreturn) void KeBugCheckEx(ULONG BugCheckCode
	, ULONG_PTR BugCheckParameter1 , ULONG_PTR BugCheckParameter2 ,
	ULONG_PTR BugCheckParameter3 , ULONG_PTR BugCheckParameter4 ) ;

__declspec(dllimport) BOOLEAN
	KeDeregisterBugCheckCallback(PKBUGCHECK_CALLBACK_RECORD CallbackRecord )
	;

__declspec(dllimport) BOOLEAN
	KeRegisterBugCheckCallback(PKBUGCHECK_CALLBACK_RECORD CallbackRecord ,
	PKBUGCHECK_CALLBACK_ROUTINE CallbackRoutine , PVOID Buffer , ULONG
	Length , PUCHAR Component ) ;

__declspec(dllimport) void KeEnterKernelDebugger(void  ) ;

__declspec(dllimport) ULONGLONG KeQueryInterruptTime(void  ) ;

__declspec(dllimport) void KeQuerySystemTime(PLARGE_INTEGER CurrentTime ) ;

__declspec(dllimport) ULONG KeQueryTimeIncrement(void  ) ;

__declspec(dllimport) KAFFINITY KeQueryActiveProcessors(void  ) ;


typedef void (_fastcall *  PSWAP_CONTEXT_NOTIFY_ROUTINE )(HANDLE OldThreadId ,
	HANDLE NewThreadId ) ;


__declspec(dllimport) void _fastcall
	KeSetSwapContextNotifyRoutine(PSWAP_CONTEXT_NOTIFY_ROUTINE NotifyRoutine
	) ;


typedef LOGICAL (_fastcall *  PTHREAD_SELECT_NOTIFY_ROUTINE )(HANDLE ThreadId )
	;


__declspec(dllimport) void _fastcall
	KeSetThreadSelectNotifyRoutine(PTHREAD_SELECT_NOTIFY_ROUTINE
	NotifyRoutine ) ;


typedef void (_fastcall *  PTIME_UPDATE_NOTIFY_ROUTINE )(HANDLE ThreadId ,
	KPROCESSOR_MODE Mode ) ;


__declspec(dllimport) void _fastcall
	KeSetTimeUpdateNotifyRoutine(PTIME_UPDATE_NOTIFY_ROUTINE NotifyRoutine )
	;

extern volatile KSYSTEM_TIME KeTickCount ;

typedef enum _MEMORY_CACHING_TYPE_ORIG {
	MmFrameBufferCached = 2
} MEMORY_CACHING_TYPE_ORIG ;

typedef enum _MEMORY_CACHING_TYPE {
	MmNonCached = 0,
	MmCached = 1,
	MmWriteCombined = MmFrameBufferCached,
	MmHardwareCoherentCached,
	MmNonCachedUnordered,
	MmUSWCCached,
	MmMaximumCacheType
} MEMORY_CACHING_TYPE ;


extern PBOOLEAN KdDebuggerNotPresent ;
extern PBOOLEAN KdDebuggerEnabled ;


typedef struct _DBGKD_DEBUG_DATA_HEADER64 *  PDBGKD_DEBUG_DATA_HEADER64 ;

BOOLEAN KdRegisterDebuggerDataBlock(ULONG Tag , PDBGKD_DEBUG_DATA_HEADER64
	DataHeader , ULONG Size ) ;

void KdDeregisterDebuggerDataBlock32(PDBGKD_DEBUG_DATA_HEADER64 DataHeader ) ;

void KdDisableDebugger(void  ) ;

void KdEnableDebugger(void  ) ;


typedef enum _POOL_TYPE {
	NonPagedPool,
	PagedPool,
	NonPagedPoolMustSucceed,
	DontUseThisType,
	NonPagedPoolCacheAligned,
	PagedPoolCacheAligned,
	NonPagedPoolCacheAlignedMustS,
	MaxPoolType,
	NonPagedPoolSession = 32,
	PagedPoolSession = NonPagedPoolSession + 1,
	NonPagedPoolMustSucceedSession = PagedPoolSession + 1,
	DontUseThisTypeSession = NonPagedPoolMustSucceedSession + 1,
	NonPagedPoolCacheAlignedSession = DontUseThisTypeSession + 1,
	PagedPoolCacheAlignedSession = NonPagedPoolCacheAlignedSession + 1,
	NonPagedPoolCacheAlignedMustSSession = PagedPoolCacheAlignedSession + 1
} POOL_TYPE ;


__declspec(dllimport) PVOID ExAllocatePool(POOL_TYPE PoolType , SIZE_T
	NumberOfBytes ) ;

__declspec(dllimport) PVOID ExAllocatePoolWithQuota(POOL_TYPE PoolType , SIZE_T
	NumberOfBytes ) ;

__declspec(dllimport) PVOID __stdcall ExAllocatePoolWithTag(POOL_TYPE PoolType ,
	SIZE_T NumberOfBytes , ULONG Tag ) ;


typedef enum _EX_POOL_PRIORITY {
	LowPoolPriority,
	LowPoolPrioritySpecialPoolOverrun = 8,
	LowPoolPrioritySpecialPoolUnderrun = 9,
	NormalPoolPriority = 16,
	NormalPoolPrioritySpecialPoolOverrun = 24,
	NormalPoolPrioritySpecialPoolUnderrun = 25,
	HighPoolPriority = 32,
	HighPoolPrioritySpecialPoolOverrun = 40,
	HighPoolPrioritySpecialPoolUnderrun = 41
} EX_POOL_PRIORITY ;


__declspec(dllimport) PVOID __stdcall ExAllocatePoolWithTagPriority(POOL_TYPE
	PoolType , SIZE_T NumberOfBytes , ULONG Tag , EX_POOL_PRIORITY Priority
	) ;

__declspec(dllimport) PVOID ExAllocatePoolWithQuotaTag(POOL_TYPE PoolType ,
	SIZE_T NumberOfBytes , ULONG Tag ) ;

__declspec(dllimport) void __stdcall ExFreePool(PVOID P ) ;


typedef struct _FAST_MUTEX {
	LONG Count ;
	PKTHREAD Owner ;
	ULONG Contention ;
	KEVENT Event ;
	ULONG OldIrql ;
} FAST_MUTEX , *  PFAST_MUTEX ;


__declspec(dllimport) void _fastcall ExAcquireFastMutexUnsafe(PFAST_MUTEX
	FastMutex ) ;

__declspec(dllimport) void _fastcall ExReleaseFastMutexUnsafe(PFAST_MUTEX
	FastMutex ) ;

__declspec(dllimport) void _fastcall ExAcquireFastMutex(PFAST_MUTEX FastMutex )
	;

__declspec(dllimport) void _fastcall ExReleaseFastMutex(PFAST_MUTEX FastMutex )
	;

__declspec(dllimport) BOOLEAN _fastcall ExTryToAcquireFastMutex(PFAST_MUTEX
	FastMutex ) ;

__declspec(dllimport) void _fastcall
	ExInterlockedAddLargeStatistic(PLARGE_INTEGER Addend , ULONG Increment )
	;

__declspec(dllimport) LARGE_INTEGER ExInterlockedAddLargeInteger(PLARGE_INTEGER
	Addend , LARGE_INTEGER Increment , PKSPIN_LOCK Lock ) ;

__declspec(dllimport) ULONG _fastcall ExfInterlockedAddUlong(PULONG Addend ,
	ULONG Increment , PKSPIN_LOCK Lock ) ;

__declspec(dllimport) LONGLONG _fastcall
	ExInterlockedCompareExchange64(PLONGLONG Destination , PLONGLONG
	Exchange , PLONGLONG Comperand , PKSPIN_LOCK Lock ) ;

__declspec(dllimport) PLIST_ENTRY _fastcall
	ExfInterlockedInsertHeadList(PLIST_ENTRY ListHead , PLIST_ENTRY
	ListEntry , PKSPIN_LOCK Lock ) ;

__declspec(dllimport) PLIST_ENTRY _fastcall
	ExfInterlockedInsertTailList(PLIST_ENTRY ListHead , PLIST_ENTRY
	ListEntry , PKSPIN_LOCK Lock ) ;

__declspec(dllimport) PLIST_ENTRY _fastcall
	ExfInterlockedRemoveHeadList(PLIST_ENTRY ListHead , PKSPIN_LOCK Lock ) ;

__declspec(dllimport) PSINGLE_LIST_ENTRY _fastcall
	ExfInterlockedPopEntryList(PSINGLE_LIST_ENTRY ListHead , PKSPIN_LOCK
	Lock ) ;

__declspec(dllimport) PSINGLE_LIST_ENTRY _fastcall
	ExfInterlockedPushEntryList(PSINGLE_LIST_ENTRY ListHead ,
	PSINGLE_LIST_ENTRY ListEntry , PKSPIN_LOCK Lock ) ;

__declspec(dllimport) PSINGLE_LIST_ENTRY _fastcall
	ExInterlockedPopEntrySList(PSLIST_HEADER ListHead , PKSPIN_LOCK Lock ) ;

__declspec(dllimport) PSINGLE_LIST_ENTRY _fastcall
	ExInterlockedPushEntrySList(PSLIST_HEADER ListHead , PSINGLE_LIST_ENTRY
	ListEntry , PKSPIN_LOCK Lock ) ;

__declspec(dllimport) PSINGLE_LIST_ENTRY _fastcall
	ExInterlockedFlushSList(PSLIST_HEADER ListHead ) ;


typedef PVOID ( *  PALLOCATE_FUNCTION )(POOL_TYPE PoolType , SIZE_T
	NumberOfBytes , ULONG Tag ) ;


typedef void ( *  PFREE_FUNCTION )(PVOID Buffer ) ;


typedef struct _GENERAL_LOOKASIDE {
	SLIST_HEADER ListHead ;
	USHORT Depth ;
	USHORT MaximumDepth ;
	ULONG TotalAllocates ;
	union  {
		ULONG AllocateMisses ;
		ULONG AllocateHits ;
	}  ;
	ULONG TotalFrees ;
	union  {
		ULONG FreeMisses ;
		ULONG FreeHits ;
	}  ;
	POOL_TYPE Type ;
	ULONG Tag ;
	ULONG Size ;
	PALLOCATE_FUNCTION Allocate ;
	PFREE_FUNCTION Free ;
	LIST_ENTRY ListEntry ;
	ULONG LastTotalAllocates ;
	union  {
		ULONG LastAllocateMisses ;
		ULONG LastAllocateHits ;
	}  ;
	ULONG Future[2] ;
} GENERAL_LOOKASIDE , *  PGENERAL_LOOKASIDE ;


typedef struct _NPAGED_LOOKASIDE_LIST {
	GENERAL_LOOKASIDE L ;
	KSPIN_LOCK Lock ;
} NPAGED_LOOKASIDE_LIST , *  PNPAGED_LOOKASIDE_LIST ;


__declspec(dllimport)
	void ExInitializeNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside ,
	PALLOCATE_FUNCTION Allocate , PFREE_FUNCTION Free , ULONG Flags , SIZE_T
	Size , ULONG Tag , USHORT Depth ) ;

__declspec(dllimport) void ExDeleteNPagedLookasideList(PNPAGED_LOOKASIDE_LIST
	Lookaside ) ;


__inline PVOID ExAllocateFromNPagedLookasideList(PNPAGED_LOOKASIDE_LIST
	Lookaside )
{
	
	PVOID Entry ;
	
	(Lookaside->L).TotalAllocates += 1;
	Entry = ExInterlockedPopEntrySList(& (Lookaside->L).ListHead, &
		Lookaside->Lock);
	
	if(Entry == (void *  )0)
	{
		
		(Lookaside->L).AllocateMisses += 1;
		Entry = ((Lookaside->L).Allocate)((Lookaside->L).Type,
			(Lookaside->L).Size, (Lookaside->L).Tag);
	}
	
	return Entry;
}

__inline void ExFreeToNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside ,
	PVOID Entry )
{
	
	(Lookaside->L).TotalFrees += 1;
	if((USHORT )(& (Lookaside->L).ListHead)->Depth >= (Lookaside->L).Depth)
	{
		
		(Lookaside->L).FreeMisses += 1;
		((Lookaside->L).Free)(Entry);
	}
	else
	{
		
		ExInterlockedPushEntrySList(& (Lookaside->L).ListHead,
			(PSINGLE_LIST_ENTRY )Entry, & Lookaside->Lock);
	}
	
	return;
}


typedef struct _PAGED_LOOKASIDE_LIST {
	GENERAL_LOOKASIDE L ;
	FAST_MUTEX Lock ;
} PAGED_LOOKASIDE_LIST , *  PPAGED_LOOKASIDE_LIST ;

__declspec(dllimport) void ExInitializePagedLookasideList(PPAGED_LOOKASIDE_LIST
	Lookaside , PALLOCATE_FUNCTION Allocate , PFREE_FUNCTION Free , ULONG
	Flags , SIZE_T Size , ULONG Tag , USHORT Depth ) ;

__declspec(dllimport) void ExDeletePagedLookasideList(PPAGED_LOOKASIDE_LIST
	Lookaside ) ;

__declspec(dllimport) PVOID
	ExAllocateFromPagedLookasideList(PPAGED_LOOKASIDE_LIST Lookaside ) ;

__declspec(dllimport) void ExFreeToPagedLookasideList(PPAGED_LOOKASIDE_LIST
	Lookaside , PVOID Entry ) ;

__declspec(dllimport) void __stdcall ProbeForRead(const void *  Address , ULONG
	Length , ULONG Alignment ) ;

__declspec(dllimport) void __stdcall ProbeForWrite(PVOID Address , ULONG Length
	, ULONG Alignment ) ;


typedef enum _WORK_QUEUE_TYPE {
	CriticalWorkQueue,
	DelayedWorkQueue,
	HyperCriticalWorkQueue,
	MaximumWorkQueue
} WORK_QUEUE_TYPE ;

typedef void ( *  PWORKER_THREAD_ROUTINE )(PVOID Parameter ) ;


typedef struct _WORK_QUEUE_ITEM {
	LIST_ENTRY List ;
	PWORKER_THREAD_ROUTINE WorkerRoutine ;
	PVOID Parameter ;
} WORK_QUEUE_ITEM , *  PWORK_QUEUE_ITEM ;


__declspec(dllimport) void ExQueueWorkItem(PWORK_QUEUE_ITEM WorkItem ,
	WORK_QUEUE_TYPE QueueType ) ;

__declspec(dllimport) BOOLEAN ExIsProcessorFeaturePresent(ULONG ProcessorFeature
	) ;


typedef struct _ZONE_SEGMENT_HEADER {
	SINGLE_LIST_ENTRY SegmentList ;
	PVOID Reserved ;
} ZONE_SEGMENT_HEADER , *  PZONE_SEGMENT_HEADER ;

typedef struct _ZONE_HEADER {
	SINGLE_LIST_ENTRY FreeList ;
	SINGLE_LIST_ENTRY SegmentList ;
	ULONG BlockSize ;
	ULONG TotalSegmentSize ;
} ZONE_HEADER , *  PZONE_HEADER ;


__declspec(dllimport) NTSTATUS ExInitializeZone(PZONE_HEADER Zone , ULONG
	BlockSize , PVOID InitialSegment , ULONG InitialSegmentSize ) ;

__declspec(dllimport) NTSTATUS ExExtendZone(PZONE_HEADER Zone , PVOID Segment ,
	ULONG SegmentSize ) ;

__declspec(dllimport) NTSTATUS ExInterlockedExtendZone(PZONE_HEADER Zone , PVOID
	Segment , ULONG SegmentSize , PKSPIN_LOCK Lock ) ;


typedef ULONG_PTR ERESOURCE_THREAD ;


typedef ERESOURCE_THREAD *  PERESOURCE_THREAD ;

typedef struct _OWNER_ENTRY {
	ERESOURCE_THREAD OwnerThread ;
	union  {
		LONG OwnerCount ;
		ULONG TableSize ;
	}  ;
} OWNER_ENTRY , *  POWNER_ENTRY ;


typedef struct _ERESOURCE {
	LIST_ENTRY SystemResourcesList ;
	POWNER_ENTRY OwnerTable ;
	SHORT ActiveCount ;
	USHORT Flag ;
	PKSEMAPHORE SharedWaiters ;
	PKEVENT ExclusiveWaiters ;
	OWNER_ENTRY OwnerThreads[2] ;
	ULONG ContentionCount ;
	USHORT NumberOfSharedWaiters ;
	USHORT NumberOfExclusiveWaiters ;
	union  {
		PVOID Address ;
		ULONG_PTR CreatorBackTraceIndex ;
	}  ;
	KSPIN_LOCK SpinLock ;
} ERESOURCE , *  PERESOURCE ;


typedef struct _RESOURCE_HASH_ENTRY {
	LIST_ENTRY ListEntry ;
	PVOID Address ;
	ULONG ContentionCount ;
	ULONG Number ;
} RESOURCE_HASH_ENTRY , *  PRESOURCE_HASH_ENTRY ;

typedef struct _RESOURCE_PERFORMANCE_DATA {
	ULONG ActiveResourceCount ;
	ULONG TotalResourceCount ;
	ULONG ExclusiveAcquire ;
	ULONG SharedFirstLevel ;
	ULONG SharedSecondLevel ;
	ULONG StarveFirstLevel ;
	ULONG StarveSecondLevel ;
	ULONG WaitForExclusive ;
	ULONG OwnerTableExpands ;
	ULONG MaximumTableExpand ;
	LIST_ENTRY HashTable[64] ;
} RESOURCE_PERFORMANCE_DATA , *  PRESOURCE_PERFORMANCE_DATA ;


__declspec(dllimport) NTSTATUS ExInitializeResourceLite(PERESOURCE Resource ) ;

__declspec(dllimport) NTSTATUS ExReinitializeResourceLite(PERESOURCE Resource )
	;

__declspec(dllimport) BOOLEAN ExAcquireResourceSharedLite(PERESOURCE Resource ,
	BOOLEAN Wait ) ;

__declspec(dllimport) BOOLEAN ExAcquireResourceExclusiveLite(PERESOURCE Resource
	, BOOLEAN Wait ) ;

__declspec(dllimport) BOOLEAN ExAcquireSharedStarveExclusive(PERESOURCE Resource
	, BOOLEAN Wait ) ;

__declspec(dllimport) BOOLEAN ExAcquireSharedWaitForExclusive(PERESOURCE
	Resource , BOOLEAN Wait ) ;

__declspec(dllimport) BOOLEAN ExTryToAcquireResourceExclusiveLite(PERESOURCE
	Resource ) ;

__declspec(dllimport) void _fastcall ExReleaseResourceLite(PERESOURCE Resource )
	;

__declspec(dllimport) void ExReleaseResourceForThreadLite(PERESOURCE Resource ,
	ERESOURCE_THREAD ResourceThreadId ) ;

__declspec(dllimport) void ExSetResourceOwnerPointer(PERESOURCE Resource , PVOID
	OwnerPointer ) ;

__declspec(dllimport) void ExConvertExclusiveToSharedLite(PERESOURCE Resource )
	;

__declspec(dllimport) NTSTATUS ExDeleteResourceLite(PERESOURCE Resource ) ;

__declspec(dllimport) ULONG ExGetExclusiveWaiterCount(PERESOURCE Resource ) ;

__declspec(dllimport) ULONG ExGetSharedWaiterCount(PERESOURCE Resource ) ;

__declspec(dllimport) BOOLEAN ExIsResourceAcquiredExclusiveLite(PERESOURCE
	Resource ) ;

__declspec(dllimport) ULONG ExIsResourceAcquiredSharedLite(PERESOURCE Resource )
	;

__declspec(dllimport) KPROCESSOR_MODE ExGetPreviousMode(void  ) ;

__declspec(dllimport) void __stdcall ExRaiseStatus(NTSTATUS Status ) ;

__declspec(dllimport) void ExRaiseDatatypeMisalignment(void  ) ;

__declspec(dllimport) void ExRaiseAccessViolation(void  ) ;

__declspec(dllimport) ULONG ExSetTimerResolution(ULONG DesiredTime , BOOLEAN
	SetResolution ) ;

__declspec(dllimport) void ExSystemTimeToLocalTime(PLARGE_INTEGER SystemTime ,
	PLARGE_INTEGER LocalTime ) ;

__declspec(dllimport) void ExLocalTimeToSystemTime(PLARGE_INTEGER LocalTime ,
	PLARGE_INTEGER SystemTime ) ;



typedef void ( *  PCALLBACK_FUNCTION )(PVOID CallbackContext , PVOID Argument1 ,
	PVOID Argument2 ) ;


__declspec(dllimport) NTSTATUS ExCreateCallback(PCALLBACK_OBJECT___0 * 
	CallbackObject , POBJECT_ATTRIBUTES ObjectAttributes , BOOLEAN Create ,
	BOOLEAN AllowMultipleCallbacks ) ;

__declspec(dllimport) PVOID ExRegisterCallback(PCALLBACK_OBJECT___0
	CallbackObject , PCALLBACK_FUNCTION CallbackFunction , PVOID
	CallbackContext ) ;

__declspec(dllimport) void ExUnregisterCallback(PVOID CallbackRegistration ) ;

__declspec(dllimport) void ExNotifyCallback(PVOID CallbackObject , PVOID
	Argument1 , PVOID Argument2 ) ;


typedef GUID UUID ;

__declspec(dllimport) NTSTATUS ExUuidCreate(UUID *  Uuid ) ;

extern PBOOLEAN Mm64BitPhysicalAddress ;


typedef enum _MM_SYSTEM_SIZE {
	MmSmallSystem,
	MmMediumSystem,
	MmLargeSystem
} MM_SYSTEMSIZE ;

__declspec(dllimport) MM_SYSTEMSIZE MmQuerySystemSize(void  ) ;

__declspec(dllimport) BOOLEAN MmIsThisAnNtAsSystem(void  ) ;


typedef enum _LOCK_OPERATION {
	IoReadAccess,
	IoWriteAccess,
	IoModifyAccess
} LOCK_OPERATION ;


__declspec(dllimport) void MmProbeAndLockProcessPages(PMDL MemoryDescriptorList
	, PEPROCESS Process , KPROCESSOR_MODE AccessMode , LOCK_OPERATION
	Operation ) ;

__declspec(dllimport) void MmProbeAndLockPages(PMDL MemoryDescriptorList ,
	KPROCESSOR_MODE AccessMode , LOCK_OPERATION Operation ) ;

__declspec(dllimport) void MmUnlockPages(PMDL MemoryDescriptorList ) ;

__declspec(dllimport) void MmBuildMdlForNonPagedPool(PMDL MemoryDescriptorList )
	;

__declspec(dllimport) PVOID MmMapLockedPages(PMDL MemoryDescriptorList ,
	KPROCESSOR_MODE AccessMode ) ;

__declspec(dllimport) PVOID MmGetSystemRoutineAddress(PUNICODE_STRING
	SystemRoutineName ) ;

__declspec(dllimport) NTSTATUS MmMapUserAddressesToPage(PVOID BaseAddress ,
	SIZE_T NumberOfBytes , PVOID PageAddress ) ;


typedef enum _MM_PAGE_PRIORITY {
	LowPagePriority,
	NormalPagePriority = 16,
	HighPagePriority = 32
} MM_PAGE_PRIORITY ;


__declspec(dllimport) PVOID MmMapLockedPagesSpecifyCache(PMDL
	MemoryDescriptorList , KPROCESSOR_MODE AccessMode , MEMORY_CACHING_TYPE
	CacheType , PVOID BaseAddress , ULONG BugCheckOnFailure ,
	MM_PAGE_PRIORITY Priority ) ;

__declspec(dllimport) void MmUnmapLockedPages(PVOID BaseAddress , PMDL
	MemoryDescriptorList ) ;


typedef struct _PHYSICAL_MEMORY_RANGE {
	PHYSICAL_ADDRESS BaseAddress ;
	LARGE_INTEGER NumberOfBytes ;
} PHYSICAL_MEMORY_RANGE , *  PPHYSICAL_MEMORY_RANGE ;

__declspec(dllimport) NTSTATUS MmAddPhysicalMemory(PPHYSICAL_ADDRESS
	StartAddress , PLARGE_INTEGER NumberOfBytes ) ;

__declspec(dllimport) NTSTATUS MmRemovePhysicalMemory(PPHYSICAL_ADDRESS
	StartAddress , PLARGE_INTEGER NumberOfBytes ) ;

__declspec(dllimport) PPHYSICAL_MEMORY_RANGE MmGetPhysicalMemoryRanges(void  ) ;

__declspec(dllimport) PMDL MmAllocatePagesForMdl(PHYSICAL_ADDRESS LowAddress ,
	PHYSICAL_ADDRESS HighAddress , PHYSICAL_ADDRESS SkipBytes , SIZE_T
	TotalBytes ) ;

__declspec(dllimport) void MmFreePagesFromMdl(PMDL MemoryDescriptorList ) ;

__declspec(dllimport) PVOID MmMapIoSpace(PHYSICAL_ADDRESS PhysicalAddress ,
	SIZE_T NumberOfBytes , MEMORY_CACHING_TYPE CacheType ) ;

__declspec(dllimport) void MmUnmapIoSpace(PVOID BaseAddress , SIZE_T
	NumberOfBytes ) ;

__declspec(dllimport) PVOID MmMapVideoDisplay(PHYSICAL_ADDRESS PhysicalAddress ,
	SIZE_T NumberOfBytes , MEMORY_CACHING_TYPE CacheType ) ;

__declspec(dllimport) void MmUnmapVideoDisplay(PVOID BaseAddress , SIZE_T
	NumberOfBytes ) ;

__declspec(dllimport) PHYSICAL_ADDRESS MmGetPhysicalAddress(PVOID BaseAddress )
	;

__declspec(dllimport) PVOID MmGetVirtualForPhysical(PHYSICAL_ADDRESS
	PhysicalAddress ) ;

__declspec(dllimport) PVOID MmAllocateContiguousMemory(SIZE_T NumberOfBytes ,
	PHYSICAL_ADDRESS HighestAcceptableAddress ) ;

__declspec(dllimport) PVOID MmAllocateContiguousMemorySpecifyCache(SIZE_T
	NumberOfBytes , PHYSICAL_ADDRESS LowestAcceptableAddress ,
	PHYSICAL_ADDRESS HighestAcceptableAddress , PHYSICAL_ADDRESS
	BoundaryAddressMultiple , MEMORY_CACHING_TYPE CacheType ) ;

__declspec(dllimport) void MmFreeContiguousMemory(PVOID BaseAddress ) ;

__declspec(dllimport) void MmFreeContiguousMemorySpecifyCache(PVOID BaseAddress
	, SIZE_T NumberOfBytes , MEMORY_CACHING_TYPE CacheType ) ;

__declspec(dllimport) PVOID MmAllocateNonCachedMemory(SIZE_T NumberOfBytes ) ;

__declspec(dllimport) void MmFreeNonCachedMemory(PVOID BaseAddress , SIZE_T
	NumberOfBytes ) ;

__declspec(dllimport) BOOLEAN MmIsAddressValid(PVOID VirtualAddress ) ;

__declspec(dllimport) BOOLEAN MmIsNonPagedSystemAddressValid(PVOID
	VirtualAddress ) ;

__declspec(dllimport) SIZE_T MmSizeOfMdl(PVOID Base , SIZE_T Length ) ;

__declspec(dllimport) PMDL MmCreateMdl(PMDL MemoryDescriptorList , PVOID Base ,
	SIZE_T Length ) ;

__declspec(dllimport) PVOID MmLockPagableDataSection(PVOID AddressWithinSection
	) ;

__declspec(dllimport) void MmLockPagableSectionByHandle(PVOID ImageSectionHandle
	) ;

__declspec(dllimport) void MmResetDriverPaging(PVOID AddressWithinSection ) ;

__declspec(dllimport) PVOID MmPageEntireDriver(PVOID AddressWithinSection ) ;

__declspec(dllimport) void MmUnlockPagableImageSection(PVOID ImageSectionHandle
	) ;

__declspec(dllimport) HANDLE MmSecureVirtualMemory(PVOID Address , SIZE_T Size ,
	ULONG ProbeMode ) ;

__declspec(dllimport) void MmUnsecureVirtualMemory(HANDLE SecureHandle ) ;

__declspec(dllimport) NTSTATUS MmMapViewInSystemSpace(PVOID Section , PVOID * 
	MappedBase , PSIZE_T ViewSize ) ;

__declspec(dllimport) NTSTATUS MmUnmapViewInSystemSpace(PVOID MappedBase ) ;

__declspec(dllimport) NTSTATUS MmMapViewInSessionSpace(PVOID Section , PVOID * 
	MappedBase , PSIZE_T ViewSize ) ;

__declspec(dllimport) NTSTATUS MmUnmapViewInSessionSpace(PVOID MappedBase ) ;


typedef NTSTATUS ( *  PMM_DLL_INITIALIZE )(PUNICODE_STRING RegistryPath ) ;


typedef NTSTATUS ( *  PMM_DLL_UNLOAD )(void  ) ;


struct _DRIVER_OBJECT ;

__declspec(dllimport) LOGICAL MmIsDriverVerifying(struct _DRIVER_OBJECT * 
	DriverObject ) ;


typedef enum _SECURITY_OPERATION_CODE {
	SetSecurityDescriptor,
	QuerySecurityDescriptor,
	DeleteSecurityDescriptor,
	AssignSecurityDescriptor
} SECURITY_OPERATION_CODE , *  PSECURITY_OPERATION_CODE ;


typedef struct _SECURITY_SUBJECT_CONTEXT {
	PACCESS_TOKEN ClientToken ;
	SECURITY_IMPERSONATION_LEVEL ImpersonationLevel ;
	PACCESS_TOKEN PrimaryToken ;
	PVOID ProcessAuditId ;
} SECURITY_SUBJECT_CONTEXT , *  PSECURITY_SUBJECT_CONTEXT ;


typedef struct _INITIAL_PRIVILEGE_SET {
	ULONG PrivilegeCount ;
	ULONG Control ;
	LUID_AND_ATTRIBUTES Privilege[3] ;
} INITIAL_PRIVILEGE_SET , *  PINITIAL_PRIVILEGE_SET ;


typedef struct _ACCESS_STATE {
	LUID OperationID ;
	BOOLEAN SecurityEvaluated ;
	BOOLEAN GenerateAudit ;
	BOOLEAN GenerateOnClose ;
	BOOLEAN PrivilegesAllocated ;
	ULONG Flags ;
	ACCESS_MASK RemainingDesiredAccess ;
	ACCESS_MASK PreviouslyGrantedAccess ;
	ACCESS_MASK OriginalDesiredAccess ;
	SECURITY_SUBJECT_CONTEXT SubjectSecurityContext ;
	PSECURITY_DESCRIPTOR SecurityDescriptor ;
	PVOID AuxData ;
	union  {
		INITIAL_PRIVILEGE_SET InitialPrivilegeSet ;
		PRIVILEGE_SET PrivilegeSet ;
	} Privileges ;
	BOOLEAN AuditPrivileges ;
	UNICODE_STRING ObjectName ;
	UNICODE_STRING ObjectTypeName ;
} ACCESS_STATE , *  PACCESS_STATE ;


__declspec(dllimport) NTSTATUS SeAssignSecurity(PSECURITY_DESCRIPTOR
	ParentDescriptor , PSECURITY_DESCRIPTOR ExplicitDescriptor ,
	PSECURITY_DESCRIPTOR *  NewDescriptor , BOOLEAN IsDirectoryObject ,
	PSECURITY_SUBJECT_CONTEXT SubjectContext , PGENERIC_MAPPING
	GenericMapping , POOL_TYPE PoolType ) ;

__declspec(dllimport) NTSTATUS SeAssignSecurityEx(PSECURITY_DESCRIPTOR
	ParentDescriptor , PSECURITY_DESCRIPTOR ExplicitDescriptor ,
	PSECURITY_DESCRIPTOR *  NewDescriptor , GUID *  ObjectType , BOOLEAN
	IsDirectoryObject , ULONG AutoInheritFlags , PSECURITY_SUBJECT_CONTEXT
	SubjectContext , PGENERIC_MAPPING GenericMapping , POOL_TYPE PoolType )
	;

__declspec(dllimport) NTSTATUS SeDeassignSecurity(PSECURITY_DESCRIPTOR * 
	SecurityDescriptor ) ;

__declspec(dllimport) BOOLEAN SeAccessCheck(PSECURITY_DESCRIPTOR
	SecurityDescriptor , PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext ,
	BOOLEAN SubjectContextLocked , ACCESS_MASK DesiredAccess , ACCESS_MASK
	PreviouslyGrantedAccess , PPRIVILEGE_SET *  Privileges ,
	PGENERIC_MAPPING GenericMapping , KPROCESSOR_MODE AccessMode ,
	PACCESS_MASK GrantedAccess , PNTSTATUS AccessStatus ) ;

__declspec(dllimport) BOOLEAN SeValidSecurityDescriptor(ULONG Length ,
	PSECURITY_DESCRIPTOR SecurityDescriptor ) ;

__declspec(dllimport) BOOLEAN SeSinglePrivilegeCheck(LUID PrivilegeValue ,
	KPROCESSOR_MODE PreviousMode ) ;

__declspec(dllimport) NTSTATUS PsCreateSystemThread(PHANDLE ThreadHandle , ULONG
	DesiredAccess , POBJECT_ATTRIBUTES ObjectAttributes , HANDLE
	ProcessHandle , PCLIENT_ID ClientId , PKSTART_ROUTINE StartRoutine ,
	PVOID StartContext ) ;

__declspec(dllimport) NTSTATUS PsTerminateSystemThread(NTSTATUS ExitStatus ) ;


typedef void ( *  PCREATE_PROCESS_NOTIFY_ROUTINE )(HANDLE ParentId , HANDLE
	ProcessId , BOOLEAN Create ) ;


NTSTATUS PsSetCreateProcessNotifyRoutine(PCREATE_PROCESS_NOTIFY_ROUTINE
	NotifyRoutine , BOOLEAN Remove ) ;


typedef void ( *  PCREATE_THREAD_NOTIFY_ROUTINE )(HANDLE ProcessId , HANDLE
	ThreadId , BOOLEAN Create ) ;


NTSTATUS PsSetCreateThreadNotifyRoutine(PCREATE_THREAD_NOTIFY_ROUTINE
	NotifyRoutine ) ;


typedef struct _IMAGE_INFO {
	union  {
		ULONG Properties ;
		struct  {
			ULONG ImageAddressingMode  : 8;
			ULONG SystemModeImage  : 1;
			ULONG ImageMappedToAllPids  : 1;
			ULONG Reserved  : 22;
		}  ;
	}  ;
	PVOID ImageBase ;
	ULONG ImageSelector ;
	SIZE_T ImageSize ;
	ULONG ImageSectionNumber ;
} IMAGE_INFO , *  PIMAGE_INFO ;


typedef void ( *  PLOAD_IMAGE_NOTIFY_ROUTINE )(PUNICODE_STRING FullImageName ,
	HANDLE ProcessId , PIMAGE_INFO ImageInfo ) ;


NTSTATUS PsSetLoadImageNotifyRoutine(PLOAD_IMAGE_NOTIFY_ROUTINE NotifyRoutine )
	;

HANDLE PsGetCurrentProcessId(void  ) ;

HANDLE PsGetCurrentThreadId(void  ) ;

BOOLEAN PsGetVersion(PULONG MajorVersion , PULONG MinorVersion , PULONG
	BuildNumber , PUNICODE_STRING CSDVersion ) ;


typedef NTSTATUS ( *  PIO_QUERY_DEVICE_ROUTINE )(PVOID Context , PUNICODE_STRING
	PathName , INTERFACE_TYPE BusType , ULONG BusNumber ,
	PKEY_VALUE_FULL_INFORMATION *  BusInformation , CONFIGURATION_TYPE
	ControllerType , ULONG ControllerNumber , PKEY_VALUE_FULL_INFORMATION * 
	ControllerInformation , CONFIGURATION_TYPE PeripheralType , ULONG
	PeripheralNumber , PKEY_VALUE_FULL_INFORMATION *  PeripheralInformation
	) ;


typedef enum _IO_QUERY_DEVICE_DATA_FORMAT {
	IoQueryDeviceIdentifier = 0,
	IoQueryDeviceConfigurationData,
	IoQueryDeviceComponentInformation,
	IoQueryDeviceMaxData
} IO_QUERY_DEVICE_DATA_FORMAT , *  PIO_QUERY_DEVICE_DATA_FORMAT ;


typedef enum _CREATE_FILE_TYPE {
	CreateFileTypeNone,
	CreateFileTypeNamedPipe,
	CreateFileTypeMailslot
} CREATE_FILE_TYPE ;


struct _DEVICE_DESCRIPTION ;


struct _DEVICE_OBJECT ;


struct _DMA_ADAPTER ;


struct _DRIVER_OBJECT ;


struct _DRIVE_LAYOUT_INFORMATION ;


struct _DISK_PARTITION ;


struct _FILE_OBJECT ;


struct _IRP ;


struct _SCSI_REQUEST_BLOCK ;


typedef void ( *  PIO_DPC_ROUTINE )(PKDPC Dpc , struct _DEVICE_OBJECT * 
	DeviceObject , struct _IRP *  Irp , PVOID Context ) ;


typedef void ( *  PIO_TIMER_ROUTINE )(struct _DEVICE_OBJECT *  DeviceObject ,
	PVOID Context ) ;


typedef NTSTATUS ( *  PDRIVER_INITIALIZE )(struct _DRIVER_OBJECT *  DriverObject
	, PUNICODE_STRING RegistryPath ) ;


typedef void ( *  PDRIVER_REINITIALIZE )(struct _DRIVER_OBJECT *  DriverObject ,
	PVOID Context , ULONG Count ) ;


typedef void ( *  PDRIVER_CANCEL )(struct _DEVICE_OBJECT *  DeviceObject ,
	struct _IRP *  Irp ) ;


typedef NTSTATUS ( *  PDRIVER_DISPATCH )(struct _DEVICE_OBJECT *  DeviceObject ,
	struct _IRP *  Irp ) ;


typedef void ( *  PDRIVER_STARTIO )(struct _DEVICE_OBJECT *  DeviceObject ,
	struct _IRP *  Irp ) ;


typedef void ( *  PDRIVER_UNLOAD )(struct _DRIVER_OBJECT *  DriverObject ) ;


typedef NTSTATUS ( *  PDRIVER_ADD_DEVICE )(struct _DRIVER_OBJECT *  DriverObject
	, struct _DEVICE_OBJECT *  PhysicalDeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_CHECK_IF_POSSIBLE )(struct _FILE_OBJECT * 
	FileObject , PLARGE_INTEGER FileOffset , ULONG Length , BOOLEAN Wait ,
	ULONG LockKey , BOOLEAN CheckForReadOperation , PIO_STATUS_BLOCK
	IoStatus , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_READ )(struct _FILE_OBJECT *  FileObject ,
	PLARGE_INTEGER FileOffset , ULONG Length , BOOLEAN Wait , ULONG LockKey
	, PVOID Buffer , PIO_STATUS_BLOCK IoStatus , struct _DEVICE_OBJECT * 
	DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_WRITE )(struct _FILE_OBJECT *  FileObject ,
	PLARGE_INTEGER FileOffset , ULONG Length , BOOLEAN Wait , ULONG LockKey
	, PVOID Buffer , PIO_STATUS_BLOCK IoStatus , struct _DEVICE_OBJECT * 
	DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_QUERY_BASIC_INFO )(struct _FILE_OBJECT * 
	FileObject , BOOLEAN Wait , PFILE_BASIC_INFORMATION Buffer ,
	PIO_STATUS_BLOCK IoStatus , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_QUERY_STANDARD_INFO )(struct _FILE_OBJECT * 
	FileObject , BOOLEAN Wait , PFILE_STANDARD_INFORMATION Buffer ,
	PIO_STATUS_BLOCK IoStatus , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_LOCK )(struct _FILE_OBJECT *  FileObject ,
	PLARGE_INTEGER FileOffset , PLARGE_INTEGER Length , PEPROCESS ProcessId
	, ULONG Key , BOOLEAN FailImmediately , BOOLEAN ExclusiveLock ,
	PIO_STATUS_BLOCK IoStatus , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_UNLOCK_SINGLE )(struct _FILE_OBJECT *  FileObject
	, PLARGE_INTEGER FileOffset , PLARGE_INTEGER Length , PEPROCESS
	ProcessId , ULONG Key , PIO_STATUS_BLOCK IoStatus ,
	struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_UNLOCK_ALL )(struct _FILE_OBJECT *  FileObject ,
	PEPROCESS ProcessId , PIO_STATUS_BLOCK IoStatus ,
	struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_UNLOCK_ALL_BY_KEY )(struct _FILE_OBJECT * 
	FileObject , PVOID ProcessId , ULONG Key , PIO_STATUS_BLOCK IoStatus ,
	struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_DEVICE_CONTROL )(struct _FILE_OBJECT *  FileObject
	, BOOLEAN Wait , PVOID InputBuffer , ULONG InputBufferLength , PVOID
	OutputBuffer , ULONG OutputBufferLength , ULONG IoControlCode ,
	PIO_STATUS_BLOCK IoStatus , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef void ( *  PFAST_IO_ACQUIRE_FILE )(struct _FILE_OBJECT *  FileObject ) ;


typedef void ( *  PFAST_IO_RELEASE_FILE )(struct _FILE_OBJECT *  FileObject ) ;


typedef void ( *  PFAST_IO_DETACH_DEVICE )(struct _DEVICE_OBJECT *  SourceDevice
	, struct _DEVICE_OBJECT *  TargetDevice ) ;


typedef BOOLEAN ( *  PFAST_IO_QUERY_NETWORK_OPEN_INFO )(struct _FILE_OBJECT * 
	FileObject , BOOLEAN Wait , struct _FILE_NETWORK_OPEN_INFORMATION * 
	Buffer , struct _IO_STATUS_BLOCK *  IoStatus , struct _DEVICE_OBJECT * 
	DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_MDL_READ )(struct _FILE_OBJECT *  FileObject ,
	PLARGE_INTEGER FileOffset , ULONG Length , ULONG LockKey , PMDL * 
	MdlChain , PIO_STATUS_BLOCK IoStatus , struct _DEVICE_OBJECT * 
	DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_MDL_READ_COMPLETE )(struct _FILE_OBJECT * 
	FileObject , PMDL MdlChain , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_PREPARE_MDL_WRITE )(struct _FILE_OBJECT * 
	FileObject , PLARGE_INTEGER FileOffset , ULONG Length , ULONG LockKey ,
	PMDL *  MdlChain , PIO_STATUS_BLOCK IoStatus , struct _DEVICE_OBJECT * 
	DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_MDL_WRITE_COMPLETE )(struct _FILE_OBJECT * 
	FileObject , PLARGE_INTEGER FileOffset , PMDL MdlChain ,
	struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef NTSTATUS ( *  PFAST_IO_ACQUIRE_FOR_MOD_WRITE )(struct _FILE_OBJECT * 
	FileObject , PLARGE_INTEGER EndingOffset , struct _ERESOURCE *  * 
	ResourceToRelease , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef NTSTATUS ( *  PFAST_IO_RELEASE_FOR_MOD_WRITE )(struct _FILE_OBJECT * 
	FileObject , struct _ERESOURCE *  ResourceToRelease ,
	struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef NTSTATUS ( *  PFAST_IO_ACQUIRE_FOR_CCFLUSH )(struct _FILE_OBJECT * 
	FileObject , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef NTSTATUS ( *  PFAST_IO_RELEASE_FOR_CCFLUSH )(struct _FILE_OBJECT * 
	FileObject , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_READ_COMPRESSED )(struct _FILE_OBJECT * 
	FileObject , PLARGE_INTEGER FileOffset , ULONG Length , ULONG LockKey ,
	PVOID Buffer , PMDL *  MdlChain , PIO_STATUS_BLOCK IoStatus ,
	struct _COMPRESSED_DATA_INFO *  CompressedDataInfo , ULONG
	CompressedDataInfoLength , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_WRITE_COMPRESSED )(struct _FILE_OBJECT * 
	FileObject , PLARGE_INTEGER FileOffset , ULONG Length , ULONG LockKey ,
	PVOID Buffer , PMDL *  MdlChain , PIO_STATUS_BLOCK IoStatus ,
	struct _COMPRESSED_DATA_INFO *  CompressedDataInfo , ULONG
	CompressedDataInfoLength , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_MDL_READ_COMPLETE_COMPRESSED
	)(struct _FILE_OBJECT *  FileObject , PMDL MdlChain ,
	struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_MDL_WRITE_COMPLETE_COMPRESSED
	)(struct _FILE_OBJECT *  FileObject , PLARGE_INTEGER FileOffset , PMDL
	MdlChain , struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef BOOLEAN ( *  PFAST_IO_QUERY_OPEN )(struct _IRP *  Irp ,
	PFILE_NETWORK_OPEN_INFORMATION NetworkInformation ,
	struct _DEVICE_OBJECT *  DeviceObject ) ;


typedef struct _FAST_IO_DISPATCH {
	ULONG SizeOfFastIoDispatch ;
	PFAST_IO_CHECK_IF_POSSIBLE FastIoCheckIfPossible ;
	PFAST_IO_READ FastIoRead ;
	PFAST_IO_WRITE FastIoWrite ;
	PFAST_IO_QUERY_BASIC_INFO FastIoQueryBasicInfo ;
	PFAST_IO_QUERY_STANDARD_INFO FastIoQueryStandardInfo ;
	PFAST_IO_LOCK FastIoLock ;
	PFAST_IO_UNLOCK_SINGLE FastIoUnlockSingle ;
	PFAST_IO_UNLOCK_ALL FastIoUnlockAll ;
	PFAST_IO_UNLOCK_ALL_BY_KEY FastIoUnlockAllByKey ;
	PFAST_IO_DEVICE_CONTROL FastIoDeviceControl ;
	PFAST_IO_ACQUIRE_FILE AcquireFileForNtCreateSection ;
	PFAST_IO_RELEASE_FILE ReleaseFileForNtCreateSection ;
	PFAST_IO_DETACH_DEVICE FastIoDetachDevice ;
	PFAST_IO_QUERY_NETWORK_OPEN_INFO FastIoQueryNetworkOpenInfo ;
	PFAST_IO_ACQUIRE_FOR_MOD_WRITE AcquireForModWrite ;
	PFAST_IO_MDL_READ MdlRead ;
	PFAST_IO_MDL_READ_COMPLETE MdlReadComplete ;
	PFAST_IO_PREPARE_MDL_WRITE PrepareMdlWrite ;
	PFAST_IO_MDL_WRITE_COMPLETE MdlWriteComplete ;
	PFAST_IO_READ_COMPRESSED FastIoReadCompressed ;
	PFAST_IO_WRITE_COMPRESSED FastIoWriteCompressed ;
	PFAST_IO_MDL_READ_COMPLETE_COMPRESSED MdlReadCompleteCompressed ;
	PFAST_IO_MDL_WRITE_COMPLETE_COMPRESSED MdlWriteCompleteCompressed ;
	PFAST_IO_QUERY_OPEN FastIoQueryOpen ;
	PFAST_IO_RELEASE_FOR_MOD_WRITE ReleaseForModWrite ;
	PFAST_IO_ACQUIRE_FOR_CCFLUSH AcquireForCcFlush ;
	PFAST_IO_RELEASE_FOR_CCFLUSH ReleaseForCcFlush ;
} FAST_IO_DISPATCH , *  PFAST_IO_DISPATCH ;


typedef enum _IO_ALLOCATION_ACTION {
	KeepObject = 1,
	DeallocateObject,
	DeallocateObjectKeepRegisters
} IO_ALLOCATION_ACTION , *  PIO_ALLOCATION_ACTION ;


typedef IO_ALLOCATION_ACTION ( *  PDRIVER_CONTROL )(struct _DEVICE_OBJECT * 
	DeviceObject , struct _IRP *  Irp , PVOID MapRegisterBase , PVOID
	Context ) ;


typedef struct _IO_SECURITY_CONTEXT {
	PSECURITY_QUALITY_OF_SERVICE SecurityQos ;
	PACCESS_STATE AccessState ;
	ACCESS_MASK DesiredAccess ;
	ULONG FullCreateOptions ;
} IO_SECURITY_CONTEXT , *  PIO_SECURITY_CONTEXT ;


typedef struct _VPB {
	CSHORT Type ;
	CSHORT Size ;
	USHORT Flags ;
	USHORT VolumeLabelLength ;
	struct _DEVICE_OBJECT *  DeviceObject ;
	struct _DEVICE_OBJECT *  RealDevice ;
	ULONG SerialNumber ;
	ULONG ReferenceCount ;
	WCHAR VolumeLabel[32 * sizeof(WCHAR ) / sizeof(WCHAR )] ;
} VPB , *  PVPB ;


typedef struct _ADAPTER_OBJECT *  PADAPTER_OBJECT ;


typedef struct _WAIT_CONTEXT_BLOCK {
	KDEVICE_QUEUE_ENTRY WaitQueueEntry ;
	PDRIVER_CONTROL DeviceRoutine ;
	PVOID DeviceContext ;
	ULONG NumberOfMapRegisters ;
	PVOID DeviceObject ;
	PVOID CurrentIrp ;
	PKDPC BufferChainingDpc ;
} WAIT_CONTEXT_BLOCK , *  PWAIT_CONTEXT_BLOCK ;


typedef struct _CONTROLLER_OBJECT {
	CSHORT Type ;
	CSHORT Size ;
	PVOID ControllerExtension ;
	KDEVICE_QUEUE DeviceWaitQueue ;
	ULONG Spare1 ;
	LARGE_INTEGER Spare2 ;
} CONTROLLER_OBJECT , *  PCONTROLLER_OBJECT ;


typedef struct _DEVICE_OBJECT {
	CSHORT Type ;
	USHORT Size ;
	LONG ReferenceCount ;
	struct _DRIVER_OBJECT *  DriverObject ;
	struct _DEVICE_OBJECT *  NextDevice ;
	struct _DEVICE_OBJECT *  AttachedDevice ;
	struct _IRP *  CurrentIrp ;
	PIO_TIMER Timer ;
	ULONG Flags ;
	ULONG Characteristics ;
	PVPB Vpb ;
	PVOID DeviceExtension ;
	ULONG DeviceType ;
	CCHAR StackSize ;
	union  {
		LIST_ENTRY ListEntry ;
		WAIT_CONTEXT_BLOCK Wcb ;
	} Queue ;
	ULONG AlignmentRequirement ;
	KDEVICE_QUEUE DeviceQueue ;
	KDPC Dpc ;
	ULONG ActiveThreadCount ;
	PSECURITY_DESCRIPTOR SecurityDescriptor ;
	KEVENT DeviceLock ;
	USHORT SectorSize ;
	USHORT Spare1 ;
	struct _DEVOBJ_EXTENSION *  DeviceObjectExtension ;
	PVOID Reserved ;
} DEVICE_OBJECT ;


typedef struct _DEVICE_OBJECT *  PDEVICE_OBJECT ;


struct _DEVICE_OBJECT_POWER_EXTENSION ;

typedef struct _DEVOBJ_EXTENSION {
	CSHORT Type ;
	USHORT Size ;
	PDEVICE_OBJECT DeviceObject ;
} DEVOBJ_EXTENSION , *  PDEVOBJ_EXTENSION ;


typedef struct _DRIVER_EXTENSION {
	struct _DRIVER_OBJECT *  DriverObject ;
	PDRIVER_ADD_DEVICE AddDevice ;
	ULONG Count ;
	UNICODE_STRING ServiceKeyName ;
} DRIVER_EXTENSION , *  PDRIVER_EXTENSION ;


typedef struct _DRIVER_OBJECT {
	CSHORT Type ;
	CSHORT Size ;
	PDEVICE_OBJECT DeviceObject ;
	ULONG Flags ;
	PVOID DriverStart ;
	ULONG DriverSize ;
	PVOID DriverSection ;
	PDRIVER_EXTENSION DriverExtension ;
	UNICODE_STRING DriverName ;
	PUNICODE_STRING HardwareDatabase ;
	PFAST_IO_DISPATCH FastIoDispatch ;
	PDRIVER_INITIALIZE DriverInit ;
	PDRIVER_STARTIO DriverStartIo ;
	PDRIVER_UNLOAD DriverUnload ;
	PDRIVER_DISPATCH MajorFunction[0x1b + 1] ;
} DRIVER_OBJECT ;


typedef struct _DRIVER_OBJECT *  PDRIVER_OBJECT ;


typedef struct _SECTION_OBJECT_POINTERS {
	PVOID DataSectionObject ;
	PVOID SharedCacheMap ;
	PVOID ImageSectionObject ;
} SECTION_OBJECT_POINTERS ;


typedef SECTION_OBJECT_POINTERS *  PSECTION_OBJECT_POINTERS ;


typedef struct _IO_COMPLETION_CONTEXT {
	PVOID Port ;
	PVOID Key ;
} IO_COMPLETION_CONTEXT , *  PIO_COMPLETION_CONTEXT ;


typedef struct _FILE_OBJECT {
	CSHORT Type ;
	CSHORT Size ;
	PDEVICE_OBJECT DeviceObject ;
	PVPB Vpb ;
	PVOID FsContext ;
	PVOID FsContext2 ;
	PSECTION_OBJECT_POINTERS SectionObjectPointer ;
	PVOID PrivateCacheMap ;
	NTSTATUS FinalStatus ;
	struct _FILE_OBJECT *  RelatedFileObject ;
	BOOLEAN LockOperation ;
	BOOLEAN DeletePending ;
	BOOLEAN ReadAccess ;
	BOOLEAN WriteAccess ;
	BOOLEAN DeleteAccess ;
	BOOLEAN SharedRead ;
	BOOLEAN SharedWrite ;
	BOOLEAN SharedDelete ;
	ULONG Flags ;
	UNICODE_STRING FileName ;
	LARGE_INTEGER CurrentByteOffset ;
	ULONG Waiters ;
	ULONG Busy ;
	PVOID LastLock ;
	KEVENT Lock ;
	KEVENT Event ;
	PIO_COMPLETION_CONTEXT CompletionContext ;
} FILE_OBJECT ;


typedef struct _FILE_OBJECT *  PFILE_OBJECT ;


typedef struct _IRP {
	CSHORT Type ;
	USHORT Size ;
	PMDL MdlAddress ;
	ULONG Flags ;
	union  {
		struct _IRP *  MasterIrp ;
		LONG IrpCount ;
		PVOID SystemBuffer ;
	} AssociatedIrp ;
	LIST_ENTRY ThreadListEntry ;
	IO_STATUS_BLOCK IoStatus ;
	KPROCESSOR_MODE RequestorMode ;
	BOOLEAN PendingReturned ;
	CHAR StackCount ;
	CHAR CurrentLocation ;
	BOOLEAN Cancel ;
	KIRQL CancelIrql ;
	CCHAR ApcEnvironment ;
	UCHAR AllocationFlags ;
	PIO_STATUS_BLOCK UserIosb ;
	PKEVENT UserEvent ;
	union  {
		struct  {
			PIO_APC_ROUTINE UserApcRoutine ;
			PVOID UserApcContext ;
		} AsynchronousParameters ;
		LARGE_INTEGER AllocationSize ;
	} Overlay ;
	PDRIVER_CANCEL CancelRoutine ;
	PVOID UserBuffer ;
	union  {
		struct  {
			union  {
				KDEVICE_QUEUE_ENTRY DeviceQueueEntry ;
				struct  {
					PVOID DriverContext[4] ;
				}  ;
			}  ;
			PETHREAD Thread ;
			PCHAR AuxiliaryBuffer ;
			struct  {
				LIST_ENTRY ListEntry ;
				union  {
					struct _IO_STACK_LOCATION * 
						CurrentStackLocation ;
					ULONG PacketType ;
				}  ;
			}  ;
			PFILE_OBJECT OriginalFileObject ;
		} Overlay ;
		KAPC Apc ;
		PVOID CompletionKey ;
	} Tail ;
} IRP , *  PIRP ;


typedef NTSTATUS ( *  PIO_COMPLETION_ROUTINE )(PDEVICE_OBJECT DeviceObject ,
	PIRP Irp , PVOID Context ) ;


typedef enum _DEVICE_RELATION_TYPE {
	BusRelations,
	EjectionRelations,
	PowerRelations,
	RemovalRelations,
	TargetDeviceRelation
} DEVICE_RELATION_TYPE , *  PDEVICE_RELATION_TYPE ;

typedef struct _DEVICE_RELATIONS {
	ULONG Count ;
	PDEVICE_OBJECT Objects[1] ;
} DEVICE_RELATIONS , *  PDEVICE_RELATIONS ;

typedef enum _DEVICE_USAGE_NOTIFICATION_TYPE {
	DeviceUsageTypeUndefined,
	DeviceUsageTypePaging,
	DeviceUsageTypeHibernation,
	DeviceUsageTypeDumpFile
} DEVICE_USAGE_NOTIFICATION_TYPE ;


typedef struct _INTERFACE {
	USHORT Size ;
	USHORT Version ;
	PVOID Context ;
	PINTERFACE_REFERENCE InterfaceReference ;
	PINTERFACE_DEREFERENCE InterfaceDereference ;
} INTERFACE , *  PINTERFACE ;


typedef struct _DEVICE_CAPABILITIES {
	USHORT Size ;
	USHORT Version ;
	ULONG DeviceD1  : 1;
	ULONG DeviceD2  : 1;
	ULONG LockSupported  : 1;
	ULONG EjectSupported  : 1;
	ULONG Removable  : 1;
	ULONG DockDevice  : 1;
	ULONG UniqueID  : 1;
	ULONG SilentInstall  : 1;
	ULONG RawDeviceOK  : 1;
	ULONG SurpriseRemovalOK  : 1;
	ULONG WakeFromD0  : 1;
	ULONG WakeFromD1  : 1;
	ULONG WakeFromD2  : 1;
	ULONG WakeFromD3  : 1;
	ULONG HardwareDisabled  : 1;
	ULONG NonDynamic  : 1;
	ULONG WarmEjectSupported  : 1;
	ULONG Reserved  : 15;
	ULONG Address ;
	ULONG UINumber ;
	DEVICE_POWER_STATE DeviceState[PowerSystemMaximum] ;
	SYSTEM_POWER_STATE SystemWake ;
	DEVICE_POWER_STATE DeviceWake ;
	ULONG D1Latency ;
	ULONG D2Latency ;
	ULONG D3Latency ;
} DEVICE_CAPABILITIES , *  PDEVICE_CAPABILITIES ;


typedef struct _POWER_SEQUENCE {
	ULONG SequenceD1 ;
	ULONG SequenceD2 ;
	ULONG SequenceD3 ;
} POWER_SEQUENCE , *  PPOWER_SEQUENCE ;

typedef enum  {
	BusQueryDeviceID = 0,
	BusQueryHardwareIDs = 1,
	BusQueryCompatibleIDs = 2,
	BusQueryInstanceID = 3,
	BusQueryDeviceSerialNumber = 4
} BUS_QUERY_ID_TYPE , *  PBUS_QUERY_ID_TYPE ;

typedef ULONG PNP_DEVICE_STATE , *  PPNP_DEVICE_STATE ;


typedef enum  {
	DeviceTextDescription = 0,
	DeviceTextLocationInformation = 1
} DEVICE_TEXT_TYPE , *  PDEVICE_TEXT_TYPE ;



#pragma warning(disable:4103)

#pragma pack(push, 4)

typedef struct _IO_STACK_LOCATION {
	UCHAR MajorFunction ;
	UCHAR MinorFunction ;
	UCHAR Flags ;
	UCHAR Control ;
	union  {
		struct  {
			PIO_SECURITY_CONTEXT SecurityContext ;
			ULONG Options ;
			USHORT FileAttributes ;
			USHORT ShareAccess ;
			ULONG EaLength ;
		} Create ;
		struct  {
			ULONG Length ;
			ULONG Key ;
			LARGE_INTEGER ByteOffset ;
		} Read ;
		struct  {
			ULONG Length ;
			ULONG Key ;
			LARGE_INTEGER ByteOffset ;
		} Write ;
		struct  {
			ULONG Length ;
			FILE_INFORMATION_CLASS FileInformationClass ;
		} QueryFile ;
		struct  {
			ULONG Length ;
			FILE_INFORMATION_CLASS FileInformationClass ;
			PFILE_OBJECT FileObject ;
			union  {
				struct  {
					BOOLEAN ReplaceIfExists ;
					BOOLEAN AdvanceOnly ;
				}  ;
				ULONG ClusterCount ;
				HANDLE DeleteHandle ;
			}  ;
		} SetFile ;
		struct  {
			ULONG Length ;
			FS_INFORMATION_CLASS FsInformationClass ;
		} QueryVolume ;
		struct  {
			ULONG OutputBufferLength ;
			ULONG InputBufferLength ;
			ULONG IoControlCode ;
			PVOID Type3InputBuffer ;
		} DeviceIoControl ;
		struct  {
			SECURITY_INFORMATION SecurityInformation ;
			ULONG Length ;
		} QuerySecurity ;
		struct  {
			SECURITY_INFORMATION SecurityInformation ;
			PSECURITY_DESCRIPTOR SecurityDescriptor ;
		} SetSecurity ;
		struct  {
			PVPB Vpb ;
			PDEVICE_OBJECT DeviceObject ;
		} MountVolume ;
		struct  {
			PVPB Vpb ;
			PDEVICE_OBJECT DeviceObject ;
		} VerifyVolume ;
		struct  {
			struct _SCSI_REQUEST_BLOCK *  Srb ;
		} Scsi ;
		struct  {
			DEVICE_RELATION_TYPE Type ;
		} QueryDeviceRelations ;
		struct  {
			const GUID *  InterfaceType ;
			USHORT Size ;
			USHORT Version ;
			PINTERFACE Interface ;
			PVOID InterfaceSpecificData ;
		} QueryInterface ;
		struct  {
			PDEVICE_CAPABILITIES Capabilities ;
		} DeviceCapabilities ;
		struct  {
			PIO_RESOURCE_REQUIREMENTS_LIST IoResourceRequirementList
				;
		} FilterResourceRequirements ;
		struct  {
			ULONG WhichSpace ;
			PVOID Buffer ;
			ULONG Offset ;
			ULONG Length ;
		} ReadWriteConfig ;
		struct  {
			BOOLEAN Lock ;
		} SetLock ;
		struct  {
			BUS_QUERY_ID_TYPE IdType ;
		} QueryId ;
		struct  {
			DEVICE_TEXT_TYPE DeviceTextType ;
			LCID LocaleId ;
		} QueryDeviceText ;
		struct  {
			BOOLEAN InPath ;
			BOOLEAN Reserved[3] ;
			DEVICE_USAGE_NOTIFICATION_TYPE Type ;
		} UsageNotification ;
		struct  {
			SYSTEM_POWER_STATE PowerState ;
		} WaitWake ;
		struct  {
			PPOWER_SEQUENCE PowerSequence ;
		} PowerSequence ;
		struct  {
			ULONG SystemContext ;
			POWER_STATE_TYPE Type ;
			POWER_STATE State ;
			POWER_ACTION ShutdownType ;
		} Power ;
		struct  {
			PCM_RESOURCE_LIST AllocatedResources ;
			PCM_RESOURCE_LIST AllocatedResourcesTranslated ;
		} StartDevice ;
		struct  {
			ULONG_PTR ProviderId ;
			PVOID DataPath ;
			ULONG BufferSize ;
			PVOID Buffer ;
		} WMI ;
		struct  {
			PVOID Argument1 ;
			PVOID Argument2 ;
			PVOID Argument3 ;
			PVOID Argument4 ;
		} Others ;
	} Parameters ;
	PDEVICE_OBJECT DeviceObject ;
	PFILE_OBJECT FileObject ;
	PIO_COMPLETION_ROUTINE CompletionRoutine ;
	PVOID Context ;
} IO_STACK_LOCATION , *  PIO_STACK_LOCATION ;



#pragma warning(disable:4103)

#pragma pack(pop)

typedef struct _SHARE_ACCESS {
	ULONG OpenCount ;
	ULONG Readers ;
	ULONG Writers ;
	ULONG Deleters ;
	ULONG SharedRead ;
	ULONG SharedWrite ;
	ULONG SharedDelete ;
} SHARE_ACCESS , *  PSHARE_ACCESS ;


typedef struct _CONFIGURATION_INFORMATION {
	ULONG DiskCount ;
	ULONG FloppyCount ;
	ULONG CdRomCount ;
	ULONG TapeCount ;
	ULONG ScsiPortCount ;
	ULONG SerialCount ;
	ULONG ParallelCount ;
	BOOLEAN AtDiskPrimaryAddressClaimed ;
	BOOLEAN AtDiskSecondaryAddressClaimed ;
	ULONG Version ;
	ULONG MediumChangerCount ;
} CONFIGURATION_INFORMATION , *  PCONFIGURATION_INFORMATION ;


__declspec(dllimport) void IoAcquireCancelSpinLock(PKIRQL Irql ) ;

__declspec(dllimport) NTSTATUS IoAllocateAdapterChannel(PADAPTER_OBJECT
	AdapterObject , PDEVICE_OBJECT DeviceObject , ULONG NumberOfMapRegisters
	, PDRIVER_CONTROL ExecutionRoutine , PVOID Context ) ;

__declspec(dllimport) void IoAllocateController(PCONTROLLER_OBJECT
	ControllerObject , PDEVICE_OBJECT DeviceObject , PDRIVER_CONTROL
	ExecutionRoutine , PVOID Context ) ;

__declspec(dllimport) NTSTATUS IoAllocateDriverObjectExtension(PDRIVER_OBJECT
	DriverObject , PVOID ClientIdentificationAddress , ULONG
	DriverObjectExtensionSize , PVOID *  DriverObjectExtension ) ;

__declspec(dllimport) PVOID IoAllocateErrorLogEntry(PVOID IoObject , UCHAR
	EntrySize ) ;

__declspec(dllimport) PIRP IoAllocateIrp(CCHAR StackSize , BOOLEAN ChargeQuota )
	;

__declspec(dllimport) PMDL IoAllocateMdl(PVOID VirtualAddress , ULONG Length ,
	BOOLEAN SecondaryBuffer , BOOLEAN ChargeQuota , PIRP Irp ) ;

__declspec(dllimport) NTSTATUS IoAssignResources(PUNICODE_STRING RegistryPath ,
	PUNICODE_STRING DriverClassName , PDRIVER_OBJECT DriverObject ,
	PDEVICE_OBJECT DeviceObject , PIO_RESOURCE_REQUIREMENTS_LIST
	RequestedResources , PCM_RESOURCE_LIST *  AllocatedResources ) ;

__declspec(dllimport) NTSTATUS IoAttachDevice(PDEVICE_OBJECT SourceDevice ,
	PUNICODE_STRING TargetDevice , PDEVICE_OBJECT *  AttachedDevice ) ;

__declspec(dllimport) NTSTATUS IoAttachDeviceByPointer(PDEVICE_OBJECT
	SourceDevice , PDEVICE_OBJECT TargetDevice ) ;

__declspec(dllimport) PDEVICE_OBJECT IoAttachDeviceToDeviceStack(PDEVICE_OBJECT
	SourceDevice , PDEVICE_OBJECT TargetDevice ) ;

__declspec(dllimport) PIRP IoBuildAsynchronousFsdRequest(ULONG MajorFunction ,
	PDEVICE_OBJECT DeviceObject , PVOID Buffer , ULONG Length ,
	PLARGE_INTEGER StartingOffset , PIO_STATUS_BLOCK IoStatusBlock ) ;

__declspec(dllimport) PIRP IoBuildDeviceIoControlRequest(ULONG IoControlCode ,
	PDEVICE_OBJECT DeviceObject , PVOID InputBuffer , ULONG
	InputBufferLength , PVOID OutputBuffer , ULONG OutputBufferLength ,
	BOOLEAN InternalDeviceIoControl , PKEVENT Event , PIO_STATUS_BLOCK
	IoStatusBlock ) ;

__declspec(dllimport) void IoBuildPartialMdl(PMDL SourceMdl , PMDL TargetMdl ,
	PVOID VirtualAddress , ULONG Length ) ;


typedef struct _BOOTDISK_INFORMATION {
	LONGLONG BootPartitionOffset ;
	LONGLONG SystemPartitionOffset ;
	ULONG BootDeviceSignature ;
	ULONG SystemDeviceSignature ;
} BOOTDISK_INFORMATION , *  PBOOTDISK_INFORMATION ;

__declspec(dllimport) NTSTATUS IoGetBootDiskInformation(PBOOTDISK_INFORMATION
	BootDiskInformation , ULONG Size ) ;

__declspec(dllimport) PIRP IoBuildSynchronousFsdRequest(ULONG MajorFunction ,
	PDEVICE_OBJECT DeviceObject , PVOID Buffer , ULONG Length ,
	PLARGE_INTEGER StartingOffset , PKEVENT Event , PIO_STATUS_BLOCK
	IoStatusBlock ) ;

__declspec(dllimport) NTSTATUS _fastcall IofCallDriver(PDEVICE_OBJECT
	DeviceObject ) ;

__declspec(dllimport) BOOLEAN IoCancelIrp(PIRP Irp ) ;

__declspec(dllimport) NTSTATUS IoCheckShareAccess(ACCESS_MASK DesiredAccess ,
	ULONG DesiredShareAccess , PFILE_OBJECT FileObject , PSHARE_ACCESS
	ShareAccess , BOOLEAN Update ) ;

__declspec(dllimport) void _fastcall IofCompleteRequest(CCHAR
	PriorityBoost ) ;

__declspec(dllimport) NTSTATUS IoConnectInterrupt(PKINTERRUPT *  InterruptObject
	, PKSERVICE_ROUTINE ServiceRoutine , PVOID ServiceContext , PKSPIN_LOCK
	SpinLock , ULONG Vector , KIRQL Irql , KIRQL SynchronizeIrql ,
	KINTERRUPT_MODE InterruptMode , BOOLEAN ShareVector , KAFFINITY
	ProcessorEnableMask , BOOLEAN FloatingSave ) ;

__declspec(dllimport) PCONTROLLER_OBJECT IoCreateController(ULONG Size ) ;

__declspec(dllimport) NTSTATUS IoCreateDevice(PDRIVER_OBJECT DriverObject ,
	ULONG DeviceExtensionSize , PUNICODE_STRING DeviceName , ULONG
	DeviceType , ULONG DeviceCharacteristics , BOOLEAN Exclusive ,
	PDEVICE_OBJECT *  DeviceObject ) ;

__declspec(dllimport) BOOLEAN IoIsWdmVersionAvailable(UCHAR MajorVersion , UCHAR
	MinorVersion ) ;

__declspec(dllimport) NTSTATUS IoCreateFile(PHANDLE FileHandle , ACCESS_MASK
	DesiredAccess , POBJECT_ATTRIBUTES ObjectAttributes , PIO_STATUS_BLOCK
	IoStatusBlock , PLARGE_INTEGER AllocationSize , ULONG FileAttributes ,
	ULONG ShareAccess , ULONG Disposition , ULONG CreateOptions , PVOID
	EaBuffer , ULONG EaLength , CREATE_FILE_TYPE CreateFileType , PVOID
	ExtraCreateParameters , ULONG Options ) ;

__declspec(dllimport) PKEVENT IoCreateNotificationEvent(PUNICODE_STRING
	EventName , PHANDLE EventHandle ) ;

__declspec(dllimport) NTSTATUS IoCreateSymbolicLink(PUNICODE_STRING
	SymbolicLinkName , PUNICODE_STRING DeviceName ) ;

__declspec(dllimport) PKEVENT IoCreateSynchronizationEvent(PUNICODE_STRING
	EventName , PHANDLE EventHandle ) ;

__declspec(dllimport) NTSTATUS IoCreateUnprotectedSymbolicLink(PUNICODE_STRING
	SymbolicLinkName , PUNICODE_STRING DeviceName ) ;

__declspec(dllimport) void IoDeleteController(PCONTROLLER_OBJECT
	ControllerObject ) ;

__declspec(dllimport) void IoDeleteDevice(PDEVICE_OBJECT DeviceObject ) ;

__declspec(dllimport) NTSTATUS IoDeleteSymbolicLink(PUNICODE_STRING
	SymbolicLinkName ) ;

__declspec(dllimport) void IoDetachDevice(PDEVICE_OBJECT TargetDevice ) ;

__declspec(dllimport) void IoDisconnectInterrupt(PKINTERRUPT InterruptObject ) ;

__declspec(dllimport) void IoFreeController(PCONTROLLER_OBJECT ControllerObject
	) ;

__declspec(dllimport) void IoFreeIrp(PIRP Irp ) ;

__declspec(dllimport) void IoFreeMdl(PMDL Mdl ) ;

__declspec(dllimport) PDEVICE_OBJECT IoGetAttachedDeviceReference(PDEVICE_OBJECT
	DeviceObject ) ;

__declspec(dllimport) PCONFIGURATION_INFORMATION
	IoGetConfigurationInformation(void  ) ;

__declspec(dllimport) PDEVICE_OBJECT IoGetDeviceToVerify(PETHREAD Thread ) ;

__declspec(dllimport) PVOID IoGetDriverObjectExtension(PDRIVER_OBJECT
	DriverObject , PVOID ClientIdentificationAddress ) ;

__declspec(dllimport) PEPROCESS IoGetCurrentProcess(void  ) ;

__declspec(dllimport) NTSTATUS IoGetDeviceObjectPointer(PUNICODE_STRING
	ObjectName , ACCESS_MASK DesiredAccess , PFILE_OBJECT *  FileObject ,
	PDEVICE_OBJECT *  DeviceObject ) ;

__declspec(dllimport) struct _DMA_ADAPTER *  IoGetDmaAdapter(PDEVICE_OBJECT
	PhysicalDeviceObject , struct _DEVICE_DESCRIPTION *  DeviceDescription ,
	PULONG NumberOfMapRegisters ) ;

__declspec(dllimport) PGENERIC_MAPPING IoGetFileObjectGenericMapping(void  ) ;

__declspec(dllimport) PVOID IoGetInitialStack(void  ) ;

__declspec(dllimport) void IoGetStackLimits(PULONG_PTR LowLimit , PULONG_PTR
	HighLimit ) ;


__inline ULONG_PTR IoGetRemainingStackSize(void  )
{
	
	ULONG_PTR Top ;
	ULONG_PTR Bottom ;
	
	IoGetStackLimits(& Bottom, & Top);
	return (ULONG_PTR )(& Top) - Bottom;
}


__declspec(dllimport) PDEVICE_OBJECT IoGetRelatedDeviceObject(PFILE_OBJECT
	FileObject ) ;

__declspec(dllimport) void IoInitializeIrp(PIRP Irp , USHORT PacketSize , CCHAR
	StackSize ) ;

__declspec(dllimport) NTSTATUS IoInitializeTimer(PDEVICE_OBJECT DeviceObject ,
	PIO_TIMER_ROUTINE TimerRoutine , PVOID Context ) ;

__declspec(dllimport) void IoReuseIrp(PIRP Irp , NTSTATUS Iostatus ) ;

__declspec(dllimport) void IoCancelFileOpen(PDEVICE_OBJECT DeviceObject ,
	PFILE_OBJECT FileObject ) ;

__declspec(dllimport) PIRP IoMakeAssociatedIrp(PIRP Irp , CCHAR StackSize ) ;

__declspec(dllimport) NTSTATUS IoQueryDeviceDescription(PINTERFACE_TYPE BusType
	, PULONG BusNumber , PCONFIGURATION_TYPE ControllerType , PULONG
	ControllerNumber , PCONFIGURATION_TYPE PeripheralType , PULONG
	PeripheralNumber , PIO_QUERY_DEVICE_ROUTINE CalloutRoutine , PVOID
	Context ) ;

__declspec(dllimport) void IoRaiseHardError(PIRP Irp , PVPB Vpb , PDEVICE_OBJECT
	RealDeviceObject ) ;

__declspec(dllimport) BOOLEAN IoRaiseInformationalHardError(NTSTATUS ErrorStatus
	, PUNICODE_STRING String , PKTHREAD Thread ) ;

__declspec(dllimport) BOOLEAN IoSetThreadHardErrorMode(BOOLEAN EnableHardErrors
	) ;

__declspec(dllimport) void IoRegisterBootDriverReinitialization(PDRIVER_OBJECT
	DriverObject , PDRIVER_REINITIALIZE DriverReinitializationRoutine ,
	PVOID Context ) ;

__declspec(dllimport) void IoRegisterDriverReinitialization(PDRIVER_OBJECT
	DriverObject , PDRIVER_REINITIALIZE DriverReinitializationRoutine ,
	PVOID Context ) ;

__declspec(dllimport) NTSTATUS IoRegisterShutdownNotification(PDEVICE_OBJECT
	DeviceObject ) ;

__declspec(dllimport) NTSTATUS
	IoRegisterLastChanceShutdownNotification(PDEVICE_OBJECT DeviceObject ) ;

__declspec(dllimport) void IoReleaseCancelSpinLock(KIRQL Irql ) ;

__declspec(dllimport) void IoRemoveShareAccess(PFILE_OBJECT FileObject ,
	PSHARE_ACCESS ShareAccess ) ;

__declspec(dllimport) NTSTATUS IoReportResourceUsage(PUNICODE_STRING
	DriverClassName , PDRIVER_OBJECT DriverObject , PCM_RESOURCE_LIST
	DriverList , ULONG DriverListSize , PDEVICE_OBJECT DeviceObject ,
	PCM_RESOURCE_LIST DeviceList , ULONG DeviceListSize , BOOLEAN
	OverrideConflict , PBOOLEAN ConflictDetected ) ;

__declspec(dllimport) void IoSetHardErrorOrVerifyDevice(PIRP Irp ,
	PDEVICE_OBJECT DeviceObject ) ;

__declspec(dllimport) void IoSetShareAccess(ACCESS_MASK DesiredAccess , ULONG
	DesiredShareAccess , PFILE_OBJECT FileObject , PSHARE_ACCESS ShareAccess
	) ;


typedef struct _IO_REMOVE_LOCK_TRACKING_BLOCK *  PIO_REMOVE_LOCK_TRACKING_BLOCK
	;


typedef struct _IO_REMOVE_LOCK_COMMON_BLOCK {
	BOOLEAN Removed ;
	BOOLEAN Reserved[3] ;
	LONG IoCount ;
	KEVENT RemoveEvent ;
} IO_REMOVE_LOCK_COMMON_BLOCK ;


typedef struct _IO_REMOVE_LOCK_DBG_BLOCK {
	LONG Signature ;
	LONG HighWatermark ;
	LONGLONG MaxLockedTicks ;
	LONG AllocateTag ;
	LIST_ENTRY LockList ;
	KSPIN_LOCK Spin ;
	LONG LowMemoryCount ;
	ULONG Reserved1[4] ;
	PVOID Reserved2 ;
	PIO_REMOVE_LOCK_TRACKING_BLOCK Blocks ;
} IO_REMOVE_LOCK_DBG_BLOCK ;

typedef struct _IO_REMOVE_LOCK {
	IO_REMOVE_LOCK_COMMON_BLOCK Common ;
} IO_REMOVE_LOCK , *  PIO_REMOVE_LOCK ;


__declspec(dllimport) void __stdcall IoInitializeRemoveLockEx(PIO_REMOVE_LOCK
	Lock , ULONG AllocateTag , ULONG MaxLockedMinutes , ULONG HighWatermark
	, ULONG RemlockSize ) ;

__declspec(dllimport) NTSTATUS __stdcall IoAcquireRemoveLockEx(PIO_REMOVE_LOCK
	RemoveLock , PVOID Tag , PCSTR File , ULONG Line , ULONG RemlockSize ) ;

__declspec(dllimport) void __stdcall IoReleaseRemoveLockEx(PIO_REMOVE_LOCK
	RemoveLock , PVOID Tag , ULONG RemlockSize ) ;

__declspec(dllimport) void __stdcall
	IoReleaseRemoveLockAndWaitEx(PIO_REMOVE_LOCK RemoveLock , PVOID Tag ,
	ULONG RemlockSize ) ;

__declspec(dllimport) void IoStartNextPacket(PDEVICE_OBJECT DeviceObject ,
	BOOLEAN Cancelable ) ;

__declspec(dllimport) void IoStartNextPacketByKey(PDEVICE_OBJECT DeviceObject ,
	BOOLEAN Cancelable , ULONG Key ) ;

__declspec(dllimport) void IoStartPacket(PDEVICE_OBJECT DeviceObject , PIRP Irp
	, PULONG Key , PDRIVER_CANCEL CancelFunction ) ;

__declspec(dllimport) void IoStartTimer(PDEVICE_OBJECT DeviceObject ) ;

__declspec(dllimport) void IoStopTimer(PDEVICE_OBJECT DeviceObject ) ;

__declspec(dllimport) void IoUnregisterShutdownNotification(PDEVICE_OBJECT
	DeviceObject ) ;

__declspec(dllimport) void IoUpdateShareAccess(PFILE_OBJECT FileObject ,
	PSHARE_ACCESS ShareAccess ) ;

__declspec(dllimport) void IoWriteErrorLogEntry(PVOID ElEntry ) ;


typedef struct _IO_WORKITEM *  PIO_WORKITEM ;

typedef void ( *  PIO_WORKITEM_ROUTINE )(PDEVICE_OBJECT DeviceObject , PVOID
	Context ) ;


PIO_WORKITEM IoAllocateWorkItem(PDEVICE_OBJECT DeviceObject ) ;

void IoFreeWorkItem(PIO_WORKITEM IoWorkItem ) ;

void IoQueueWorkItem(PIO_WORKITEM IoWorkItem , PIO_WORKITEM_ROUTINE
	WorkerRoutine , WORK_QUEUE_TYPE QueueType , PVOID Context ) ;

__declspec(dllimport) NTSTATUS IoWMIRegistrationControl(PDEVICE_OBJECT
	DeviceObject , ULONG Action ) ;

__declspec(dllimport) NTSTATUS IoWMIAllocateInstanceIds(GUID *  Guid , ULONG
	InstanceCount , ULONG *  FirstInstanceId ) ;

__declspec(dllimport) NTSTATUS IoWMISuggestInstanceName(PDEVICE_OBJECT
	PhysicalDeviceObject , PUNICODE_STRING SymbolicLinkName , BOOLEAN
	CombineNames , PUNICODE_STRING SuggestedInstanceName ) ;

__declspec(dllimport) NTSTATUS IoWMIWriteEvent(PVOID WnodeEventItem ) ;


typedef enum  {
	DevicePropertyDeviceDescription,
	DevicePropertyHardwareID,
	DevicePropertyCompatibleIDs,
	DevicePropertyBootConfiguration,
	DevicePropertyBootConfigurationTranslated,
	DevicePropertyClassName,
	DevicePropertyClassGuid,
	DevicePropertyDriverKeyName,
	DevicePropertyManufacturer,
	DevicePropertyFriendlyName,
	DevicePropertyLocationInformation,
	DevicePropertyPhysicalDeviceObjectName,
	DevicePropertyBusTypeGuid,
	DevicePropertyLegacyBusType,
	DevicePropertyBusNumber,
	DevicePropertyEnumeratorName,
	DevicePropertyAddress,
	DevicePropertyUINumber
} DEVICE_REGISTRY_PROPERTY ;

typedef BOOLEAN ( *  PTRANSLATE_BUS_ADDRESS )(PVOID Context , PHYSICAL_ADDRESS
	BusAddress , ULONG Length , PULONG AddressSpace , PPHYSICAL_ADDRESS
	TranslatedAddress ) ;


typedef struct _DMA_ADAPTER *  ( *  PGET_DMA_ADAPTER )(PVOID Context ,
	struct _DEVICE_DESCRIPTION *  DeviceDescriptor , PULONG
	NumberOfMapRegisters ) ;


typedef ULONG ( *  PGET_SET_DEVICE_DATA )(PVOID Context , ULONG DataType , PVOID
	Buffer , ULONG Offset , ULONG Length ) ;


typedef struct _PNP_BUS_INFORMATION {
	GUID BusTypeGuid ;
	INTERFACE_TYPE LegacyBusType ;
	ULONG BusNumber ;
} PNP_BUS_INFORMATION , *  PPNP_BUS_INFORMATION ;


typedef struct _LEGACY_BUS_INFORMATION {
	GUID BusTypeGuid ;
	INTERFACE_TYPE LegacyBusType ;
	ULONG BusNumber ;
} LEGACY_BUS_INFORMATION , *  PLEGACY_BUS_INFORMATION ;

typedef struct _BUS_INTERFACE_STANDARD {
	USHORT Size ;
	USHORT Version ;
	PVOID Context ;
	PINTERFACE_REFERENCE InterfaceReference ;
	PINTERFACE_DEREFERENCE InterfaceDereference ;
	PTRANSLATE_BUS_ADDRESS TranslateBusAddress ;
	PGET_DMA_ADAPTER GetDmaAdapter ;
	PGET_SET_DEVICE_DATA SetBusData ;
	PGET_SET_DEVICE_DATA GetBusData ;
} BUS_INTERFACE_STANDARD , *  PBUS_INTERFACE_STANDARD ;


typedef BOOLEAN ( *  PGPE_SERVICE_ROUTINE )(PVOID , PVOID ) ;


typedef NTSTATUS ( *  PGPE_CONNECT_VECTOR )(PDEVICE_OBJECT , ULONG ,
	KINTERRUPT_MODE , BOOLEAN , PGPE_SERVICE_ROUTINE , PVOID , PVOID ) ;


typedef NTSTATUS ( *  PGPE_DISCONNECT_VECTOR )(PVOID ) ;


typedef NTSTATUS ( *  PGPE_ENABLE_EVENT )(PDEVICE_OBJECT , PVOID ) ;


typedef NTSTATUS ( *  PGPE_DISABLE_EVENT )(PDEVICE_OBJECT , PVOID ) ;


typedef NTSTATUS ( *  PGPE_CLEAR_STATUS )(PDEVICE_OBJECT , PVOID ) ;


typedef void ( *  PDEVICE_NOTIFY_CALLBACK )(PVOID , ULONG ) ;


typedef NTSTATUS ( *  PREGISTER_FOR_DEVICE_NOTIFICATIONS )(PDEVICE_OBJECT ,
	PDEVICE_NOTIFY_CALLBACK , PVOID ) ;


typedef void ( *  PUNREGISTER_FOR_DEVICE_NOTIFICATIONS )(PDEVICE_OBJECT ,
	PDEVICE_NOTIFY_CALLBACK ) ;


typedef struct _ACPI_INTERFACE_STANDARD {
	USHORT Size ;
	USHORT Version ;
	PVOID Context ;
	PINTERFACE_REFERENCE InterfaceReference ;
	PINTERFACE_DEREFERENCE InterfaceDereference ;
	PGPE_CONNECT_VECTOR GpeConnectVector ;
	PGPE_DISCONNECT_VECTOR GpeDisconnectVector ;
	PGPE_ENABLE_EVENT GpeEnableEvent ;
	PGPE_DISABLE_EVENT GpeDisableEvent ;
	PGPE_CLEAR_STATUS GpeClearStatus ;
	PREGISTER_FOR_DEVICE_NOTIFICATIONS RegisterForDeviceNotifications ;
	PUNREGISTER_FOR_DEVICE_NOTIFICATIONS UnregisterForDeviceNotifications ;
} ACPI_INTERFACE_STANDARD , *  PACPI_INTERFACE_STANDARD ;


typedef enum _ACPI_REG_TYPE {
	PM1a_ENABLE,
	PM1b_ENABLE,
	PM1a_STATUS,
	PM1b_STATUS,
	PM1a_CONTROL,
	PM1b_CONTROL,
	GP_STATUS,
	GP_ENABLE,
	SMI_CMD,
	MaxRegType
} ACPI_REG_TYPE , *  PACPI_REG_TYPE ;

typedef USHORT ( *  PREAD_ACPI_REGISTER )(ACPI_REG_TYPE AcpiReg , ULONG Register
	) ;


typedef void ( *  PWRITE_ACPI_REGISTER )(ACPI_REG_TYPE AcpiReg , ULONG Register
	, USHORT Value ) ;


typedef struct ACPI_REGS_INTERFACE_STANDARD {
	USHORT Size ;
	USHORT Version ;
	PVOID Context ;
	PINTERFACE_REFERENCE InterfaceReference ;
	PINTERFACE_DEREFERENCE InterfaceDereference ;
	PREAD_ACPI_REGISTER ReadAcpiRegister ;
	PWRITE_ACPI_REGISTER WriteAcpiRegister ;
} ACPI_REGS_INTERFACE_STANDARD , *  PACPI_REGS_INTERFACE_STANDARD ;


typedef struct  {
	PVOID LinkNode ;
	ULONG StaticVector ;
	UCHAR Flags ;
} ROUTING_TOKEN , *  PROUTING_TOKEN ;


typedef NTSTATUS ( *  PGET_INTERRUPT_ROUTING )(PDEVICE_OBJECT Pdo , ULONG *  Bus
	, ULONG *  PciSlot , UCHAR *  InterruptLine , UCHAR *  InterruptPin ,
	UCHAR *  ClassCode , UCHAR *  SubClassCode , PDEVICE_OBJECT *  ParentPdo
	, ROUTING_TOKEN *  RoutingToken , UCHAR *  Flags ) ;


typedef NTSTATUS ( *  PSET_INTERRUPT_ROUTING_TOKEN )(PDEVICE_OBJECT Pdo ,
	PROUTING_TOKEN RoutingToken ) ;


typedef void ( *  PUPDATE_INTERRUPT_LINE )(PDEVICE_OBJECT Pdo , UCHAR
	LineRegister ) ;


typedef struct _INT_ROUTE_INTERFACE_STANDARD {
	USHORT Size ;
	USHORT Version ;
	PVOID Context ;
	PINTERFACE_REFERENCE InterfaceReference ;
	PINTERFACE_DEREFERENCE InterfaceDereference ;
	PGET_INTERRUPT_ROUTING GetInterruptRouting ;
	PSET_INTERRUPT_ROUTING_TOKEN SetInterruptRoutingToken ;
	PUPDATE_INTERRUPT_LINE UpdateInterruptLine ;
} INT_ROUTE_INTERFACE_STANDARD , *  PINT_ROUTE_INTERFACE_STANDARD ;


typedef struct _IO_ASSIGNED_RESOURCES {
	ULONG Count ;
	PASSIGNED_RESOURCE AssignedResources[1] ;
} IO_ASSIGNED_RESOURCES , *  PIO_ASSIGNED_RESOURCES ;

__declspec(dllimport) NTSTATUS
	IoGetAssignedResourcesForSuballocation(INTERFACE_TYPE InterfaceType ,
	ULONG BusNumber , ULONG SlotNumber , PIO_RESOURCE_DESCRIPTOR
	ResourceDescriptor , PIO_ASSIGNED_RESOURCES *  List ) ;

__declspec(dllimport) NTSTATUS IoReportDetectedDevice(PDRIVER_OBJECT
	DriverObject , INTERFACE_TYPE LegacyBusType , ULONG BusNumber , ULONG
	SlotNumber , PCM_RESOURCE_LIST ResourceList ,
	PIO_RESOURCE_REQUIREMENTS_LIST ResourceRequirements , BOOLEAN
	ResourceAssigned , PDEVICE_OBJECT *  DeviceObject ) ;

__declspec(dllimport) void IoInvalidateDeviceRelations(PDEVICE_OBJECT
	DeviceObject , DEVICE_RELATION_TYPE Type ) ;

__declspec(dllimport) void IoRequestDeviceEject(PDEVICE_OBJECT
	PhysicalDeviceObject ) ;

__declspec(dllimport) NTSTATUS IoGetDeviceProperty(PDEVICE_OBJECT DeviceObject ,
	DEVICE_REGISTRY_PROPERTY DeviceProperty , ULONG BufferLength , PVOID
	PropertyBuffer , PULONG ResultLength ) ;

__declspec(dllimport) NTSTATUS IoOpenDeviceRegistryKey(PDEVICE_OBJECT
	DeviceObject , ULONG DevInstKeyType , ACCESS_MASK DesiredAccess ,
	PHANDLE DevInstRegKey ) ;

__declspec(dllimport) NTSTATUS __stdcall
	IoRegisterDeviceInterface(PDEVICE_OBJECT PhysicalDeviceObject , const
	GUID *  InterfaceClassGuid , PUNICODE_STRING ReferenceString ,
	PUNICODE_STRING SymbolicLinkName ) ;

__declspec(dllimport) NTSTATUS IoOpenDeviceInterfaceRegistryKey(PUNICODE_STRING
	SymbolicLinkName , ACCESS_MASK DesiredAccess , PHANDLE
	DeviceInterfaceKey ) ;

__declspec(dllimport) NTSTATUS IoSetDeviceInterfaceState(PUNICODE_STRING
	SymbolicLinkName , BOOLEAN Enable ) ;

__declspec(dllimport) NTSTATUS __stdcall IoGetDeviceInterfaces(const GUID * 
	InterfaceClassGuid , PDEVICE_OBJECT PhysicalDeviceObject , ULONG Flags ,
	PWSTR *  SymbolicLinkList ) ;

__declspec(dllimport) NTSTATUS __stdcall
	IoGetDeviceInterfaceAlias(PUNICODE_STRING SymbolicLinkName , const GUID
	*  AliasInterfaceClassGuid , PUNICODE_STRING AliasSymbolicLinkName ) ;


typedef enum _IO_NOTIFICATION_EVENT_CATEGORY {
	EventCategoryReserved,
	EventCategoryHardwareProfileChange,
	EventCategoryDeviceInterfaceChange,
	EventCategoryTargetDeviceChange
} IO_NOTIFICATION_EVENT_CATEGORY ;


typedef NTSTATUS ( *  PDRIVER_NOTIFICATION_CALLBACK_ROUTINE )(PVOID
	NotificationStructure , PVOID Context ) ;


__declspec(dllimport) NTSTATUS
	IoRegisterPlugPlayNotification(IO_NOTIFICATION_EVENT_CATEGORY
	EventCategory , ULONG EventCategoryFlags , PVOID EventCategoryData ,
	PDRIVER_OBJECT DriverObject , PDRIVER_NOTIFICATION_CALLBACK_ROUTINE
	CallbackRoutine , PVOID Context , PVOID *  NotificationEntry ) ;

__declspec(dllimport) NTSTATUS IoUnregisterPlugPlayNotification(PVOID
	NotificationEntry ) ;

__declspec(dllimport) NTSTATUS IoReportTargetDeviceChange(PDEVICE_OBJECT
	PhysicalDeviceObject , PVOID NotificationStructure ) ;


typedef void ( *  PDEVICE_CHANGE_COMPLETE_CALLBACK )(PVOID Context ) ;


__declspec(dllimport) void IoInvalidateDeviceState(PDEVICE_OBJECT
	PhysicalDeviceObject ) ;

__declspec(dllimport) NTSTATUS
	IoReportTargetDeviceChangeAsynchronous(PDEVICE_OBJECT
	PhysicalDeviceObject , PVOID NotificationStructure ,
	PDEVICE_CHANGE_COMPLETE_CALLBACK Callback , PVOID Context ) ;


typedef enum _ARBITER_ACTION {
	ArbiterActionTestAllocation,
	ArbiterActionRetestAllocation,
	ArbiterActionCommitAllocation,
	ArbiterActionRollbackAllocation,
	ArbiterActionQueryAllocatedResources,
	ArbiterActionWriteReservedResources,
	ArbiterActionQueryConflict,
	ArbiterActionQueryArbitrate,
	ArbiterActionAddReserved,
	ArbiterActionBootAllocation
} ARBITER_ACTION , *  PARBITER_ACTION ;

typedef struct _ARBITER_CONFLICT_INFO {
	PDEVICE_OBJECT OwningObject ;
	ULONGLONG Start ;
	ULONGLONG End ;
} ARBITER_CONFLICT_INFO , *  PARBITER_CONFLICT_INFO ;


typedef struct _ARBITER_PARAMETERS {
	union  {
		struct  {
			PLIST_ENTRY ArbitrationList ;
			ULONG AllocateFromCount ;
			PCM_PARTIAL_RESOURCE_DESCRIPTOR AllocateFrom ;
		} TestAllocation ;
		struct  {
			PLIST_ENTRY ArbitrationList ;
			ULONG AllocateFromCount ;
			PCM_PARTIAL_RESOURCE_DESCRIPTOR AllocateFrom ;
		} RetestAllocation ;
		struct  {
			PLIST_ENTRY ArbitrationList ;
		} BootAllocation ;
		struct  {
			PCM_PARTIAL_RESOURCE_LIST *  AllocatedResources ;
		} QueryAllocatedResources ;
		struct  {
			PDEVICE_OBJECT PhysicalDeviceObject ;
			PIO_RESOURCE_DESCRIPTOR ConflictingResource ;
			PULONG ConflictCount ;
			PARBITER_CONFLICT_INFO *  Conflicts ;
		} QueryConflict ;
		struct  {
			PLIST_ENTRY ArbitrationList ;
		} QueryArbitrate ;
		struct  {
			PDEVICE_OBJECT ReserveDevice ;
		} AddReserved ;
	} Parameters ;
} ARBITER_PARAMETERS , *  PARBITER_PARAMETERS ;


typedef enum _ARBITER_REQUEST_SOURCE {
	ArbiterRequestUndefined = - 1,
	ArbiterRequestLegacyReported,
	ArbiterRequestHalReported,
	ArbiterRequestLegacyAssigned,
	ArbiterRequestPnpDetected,
	ArbiterRequestPnpEnumerated
} ARBITER_REQUEST_SOURCE ;


typedef enum _ARBITER_RESULT {
	ArbiterResultUndefined = - 1,
	ArbiterResultSuccess,
	ArbiterResultExternalConflict,
	ArbiterResultNullRequest
} ARBITER_RESULT ;


__declspec(dllimport) NTSTATUS IoReportResourceForDetection(PDRIVER_OBJECT
	DriverObject , PCM_RESOURCE_LIST DriverList , ULONG DriverListSize ,
	PDEVICE_OBJECT DeviceObject , PCM_RESOURCE_LIST DeviceList , ULONG
	DeviceListSize , PBOOLEAN ConflictDetected ) ;


typedef struct _ARBITER_LIST_ENTRY {
	LIST_ENTRY ListEntry ;
	ULONG AlternativeCount ;
	PIO_RESOURCE_DESCRIPTOR Alternatives ;
	PDEVICE_OBJECT PhysicalDeviceObject ;
	ARBITER_REQUEST_SOURCE RequestSource ;
	ULONG Flags ;
	LONG_PTR WorkSpace ;
	INTERFACE_TYPE InterfaceType ;
	ULONG SlotNumber ;
	ULONG BusNumber ;
	PCM_PARTIAL_RESOURCE_DESCRIPTOR Assignment ;
	PIO_RESOURCE_DESCRIPTOR SelectedAlternative ;
	ARBITER_RESULT Result ;
} ARBITER_LIST_ENTRY , *  PARBITER_LIST_ENTRY ;


typedef NTSTATUS ( *  PARBITER_HANDLER )(PVOID Context , ARBITER_ACTION Action ,
	PARBITER_PARAMETERS Parameters ) ;


typedef struct _ARBITER_INTERFACE {
	USHORT Size ;
	USHORT Version ;
	PVOID Context ;
	PINTERFACE_REFERENCE InterfaceReference ;
	PINTERFACE_DEREFERENCE InterfaceDereference ;
	PARBITER_HANDLER ArbiterHandler ;
	ULONG Flags ;
} ARBITER_INTERFACE , *  PARBITER_INTERFACE ;


typedef enum _RESOURCE_TRANSLATION_DIRECTION {
	TranslateChildToParent,
	TranslateParentToChild
} RESOURCE_TRANSLATION_DIRECTION ;


typedef NTSTATUS ( *  PTRANSLATE_RESOURCE_HANDLER )(PVOID Context ,
	PCM_PARTIAL_RESOURCE_DESCRIPTOR Source , RESOURCE_TRANSLATION_DIRECTION
	Direction , ULONG AlternativesCount , IO_RESOURCE_DESCRIPTOR
	Alternatives[] , PDEVICE_OBJECT PhysicalDeviceObject ,
	PCM_PARTIAL_RESOURCE_DESCRIPTOR Target ) ;


typedef NTSTATUS ( *  PTRANSLATE_RESOURCE_REQUIREMENTS_HANDLER )(PVOID Context ,
	PIO_RESOURCE_DESCRIPTOR Source , PDEVICE_OBJECT PhysicalDeviceObject ,
	PULONG TargetCount , PIO_RESOURCE_DESCRIPTOR *  Target ) ;


typedef struct _TRANSLATOR_INTERFACE {
	USHORT Size ;
	USHORT Version ;
	PVOID Context ;
	PINTERFACE_REFERENCE InterfaceReference ;
	PINTERFACE_DEREFERENCE InterfaceDereference ;
	PTRANSLATE_RESOURCE_HANDLER TranslateResources ;
	PTRANSLATE_RESOURCE_REQUIREMENTS_HANDLER TranslateResourceRequirements ;
} TRANSLATOR_INTERFACE , *  PTRANSLATOR_INTERFACE ;


typedef NTSTATUS ( *  PLEGACY_DEVICE_DETECTION_HANDLER )(PVOID Context ,
	INTERFACE_TYPE LegacyBusType , ULONG BusNumber , ULONG SlotNumber ,
	PDEVICE_OBJECT *  PhysicalDeviceObject ) ;


typedef struct _LEGACY_DEVICE_DETECTION_INTERFACE {
	USHORT Size ;
	USHORT Version ;
	PVOID Context ;
	PINTERFACE_REFERENCE InterfaceReference ;
	PINTERFACE_DEREFERENCE InterfaceDereference ;
	PLEGACY_DEVICE_DETECTION_HANDLER LegacyDeviceDetection ;
} LEGACY_DEVICE_DETECTION_INTERFACE , *  PLEGACY_DEVICE_DETECTION_INTERFACE ;


typedef struct _PLUGPLAY_NOTIFICATION_HEADER {
	USHORT Version ;
	USHORT Size ;
	GUID Event ;
} PLUGPLAY_NOTIFICATION_HEADER , *  PPLUGPLAY_NOTIFICATION_HEADER ;


typedef struct _HWPROFILE_CHANGE_NOTIFICATION {
	USHORT Version ;
	USHORT Size ;
	GUID Event ;
} HWPROFILE_CHANGE_NOTIFICATION , *  PHWPROFILE_CHANGE_NOTIFICATION ;


typedef struct _DEVICE_INTERFACE_CHANGE_NOTIFICATION {
	USHORT Version ;
	USHORT Size ;
	GUID Event ;
	GUID InterfaceClassGuid ;
	PUNICODE_STRING SymbolicLinkName ;
} DEVICE_INTERFACE_CHANGE_NOTIFICATION , * 
	PDEVICE_INTERFACE_CHANGE_NOTIFICATION ;


typedef struct _TARGET_DEVICE_REMOVAL_NOTIFICATION {
	USHORT Version ;
	USHORT Size ;
	GUID Event ;
	PFILE_OBJECT FileObject ;
} TARGET_DEVICE_REMOVAL_NOTIFICATION , *  PTARGET_DEVICE_REMOVAL_NOTIFICATION ;


typedef struct _TARGET_DEVICE_CUSTOM_NOTIFICATION {
	USHORT Version ;
	USHORT Size ;
	GUID Event ;
	PFILE_OBJECT FileObject ;
	LONG NameBufferOffset ;
	UCHAR CustomDataBuffer[1] ;
} TARGET_DEVICE_CUSTOM_NOTIFICATION , *  PTARGET_DEVICE_CUSTOM_NOTIFICATION ;


typedef struct _DEVICE_DESCRIPTION {
	ULONG Version ;
	BOOLEAN Master ;
	BOOLEAN ScatterGather ;
	BOOLEAN DemandMode ;
	BOOLEAN AutoInitialize ;
	BOOLEAN Dma32BitAddresses ;
	BOOLEAN IgnoreCount ;
	BOOLEAN Reserved1 ;
	BOOLEAN Dma64BitAddresses ;
	ULONG BusNumber ;
	ULONG DmaChannel ;
	INTERFACE_TYPE InterfaceType ;
	DMA_WIDTH DmaWidth ;
	DMA_SPEED DmaSpeed ;
	ULONG MaximumLength ;
	ULONG DmaPort ;
} DEVICE_DESCRIPTION , *  PDEVICE_DESCRIPTION ;


typedef BOOLEAN ( *  PHAL_RESET_DISPLAY_PARAMETERS )(ULONG Columns , ULONG Rows
	) ;


__declspec(dllimport)
	void HalAcquireDisplayOwnership(PHAL_RESET_DISPLAY_PARAMETERS
	ResetDisplayParameters ) ;

__declspec(dllimport) void KeFlushWriteBuffer(void  ) ;

__declspec(dllimport) NTSTATUS HalAssignSlotResources(PUNICODE_STRING
	RegistryPath , PUNICODE_STRING DriverClassName , PDRIVER_OBJECT
	DriverObject , PDEVICE_OBJECT DeviceObject , INTERFACE_TYPE BusType ,
	ULONG BusNumber , ULONG SlotNumber , PCM_RESOURCE_LIST * 
	AllocatedResources ) ;

__declspec(dllimport) ULONG HalGetInterruptVector(INTERFACE_TYPE InterfaceType ,
	ULONG BusNumber , ULONG BusInterruptLevel , ULONG BusInterruptVector ,
	PKIRQL Irql , PKAFFINITY Affinity ) ;

__declspec(dllimport) ULONG HalSetBusData(BUS_DATA_TYPE BusDataType , ULONG
	BusNumber , ULONG SlotNumber , PVOID Buffer , ULONG Length ) ;

__declspec(dllimport) ULONG HalSetBusDataByOffset(BUS_DATA_TYPE BusDataType ,
	ULONG BusNumber , ULONG SlotNumber , PVOID Buffer , ULONG Offset , ULONG
	Length ) ;

__declspec(dllimport) BOOLEAN HalTranslateBusAddress(INTERFACE_TYPE
	InterfaceType , ULONG BusNumber , PHYSICAL_ADDRESS BusAddress , PULONG
	AddressSpace , PPHYSICAL_ADDRESS TranslatedAddress ) ;

__declspec(dllimport) PVOID HalAllocateCrashDumpRegisters(PADAPTER_OBJECT
	AdapterObject , PULONG NumberOfMapRegisters ) ;

__declspec(dllimport) ULONG HalGetBusData(BUS_DATA_TYPE BusDataType , ULONG
	BusNumber , ULONG SlotNumber , PVOID Buffer , ULONG Length ) ;

__declspec(dllimport) ULONG HalGetBusDataByOffset(BUS_DATA_TYPE BusDataType ,
	ULONG BusNumber , ULONG SlotNumber , PVOID Buffer , ULONG Offset , ULONG
	Length ) ;

__declspec(dllimport) PADAPTER_OBJECT HalGetAdapter(PDEVICE_DESCRIPTION
	DeviceDescription , PULONG NumberOfMapRegisters ) ;

__declspec(dllimport) BOOLEAN HalMakeBeep(ULONG Frequency ) ;

__declspec(dllimport) NTSTATUS IoReadPartitionTable(PDEVICE_OBJECT DeviceObject
	, ULONG SectorSize , BOOLEAN ReturnRecognizedPartitions ,
	struct _DRIVE_LAYOUT_INFORMATION *  *  PartitionBuffer ) ;

__declspec(dllimport) NTSTATUS IoSetPartitionInformation(PDEVICE_OBJECT
	DeviceObject , ULONG SectorSize , ULONG PartitionNumber , ULONG
	PartitionType ) ;

__declspec(dllimport) NTSTATUS IoWritePartitionTable(PDEVICE_OBJECT DeviceObject
	, ULONG SectorSize , ULONG SectorsPerTrack , ULONG NumberOfHeads ,
	struct _DRIVE_LAYOUT_INFORMATION *  PartitionBuffer ) ;

__declspec(dllimport) LARGE_INTEGER KeQueryPerformanceCounter(PLARGE_INTEGER
	PerformanceFrequency ) ;

__declspec(dllimport) void KeStallExecutionProcessor(ULONG MicroSeconds ) ;


typedef void ( *  PDEVICE_CONTROL_COMPLETION )(struct _DEVICE_CONTROL_CONTEXT * 
	ControlContext ) ;


typedef struct _DEVICE_CONTROL_CONTEXT {
	NTSTATUS Status ;
	PDEVICE_HANDLER_OBJECT DeviceHandler ;
	PDEVICE_OBJECT DeviceObject ;
	ULONG ControlCode ;
	PVOID Buffer ;
	PULONG BufferLength ;
	PVOID Context ;
} DEVICE_CONTROL_CONTEXT , *  PDEVICE_CONTROL_CONTEXT ;

typedef PBUS_HANDLER (_fastcall *  pHalHandlerForBus )(INTERFACE_TYPE
	InterfaceType , ULONG BusNumber ) ;


typedef void (_fastcall *  pHalReferenceBusHandler )(PBUS_HANDLER BusHandler ) ;


typedef enum _HAL_QUERY_INFORMATION_CLASS {
	HalInstalledBusInformation,
	HalProfileSourceInformation,
	HalInformationClassUnused1,
	HalPowerInformation,
	HalProcessorSpeedInformation,
	HalCallbackInformation,
	HalMapRegisterInformation,
	HalMcaLogInformation,
	HalFrameBufferCachingInformation,
	HalDisplayBiosInformation,
	HalProcessorFeatureInformation
} HAL_QUERY_INFORMATION_CLASS , *  PHAL_QUERY_INFORMATION_CLASS ;


typedef enum _HAL_SET_INFORMATION_CLASS {
	HalProfileSourceInterval,
	HalProfileSourceInterruptHandler,
	HalMcaRegisterDriver
} HAL_SET_INFORMATION_CLASS , *  PHAL_SET_INFORMATION_CLASS ;


typedef NTSTATUS ( *  pHalQuerySystemInformation )(HAL_QUERY_INFORMATION_CLASS
	InformationClass , ULONG BufferSize , PVOID Buffer , PULONG
	ReturnedLength ) ;


NTSTATUS HaliQuerySystemInformation(HAL_SET_INFORMATION_CLASS InformationClass ,
	ULONG BufferSize , PVOID Buffer , PULONG ReturnedLength ) ;


typedef NTSTATUS ( *  pHalSetSystemInformation )(HAL_SET_INFORMATION_CLASS
	InformationClass , ULONG BufferSize , PVOID Buffer ) ;


NTSTATUS HaliSetSystemInformation(HAL_SET_INFORMATION_CLASS InformationClass ,
	ULONG BufferSize , PVOID Buffer ) ;


typedef void (_fastcall *  pHalExamineMBR )(PDEVICE_OBJECT DeviceObject , ULONG
	SectorSize , ULONG MBRTypeIdentifier , PVOID *  Buffer ) ;


typedef void (_fastcall *  pHalIoAssignDriveLetters
	)(struct _LOADER_PARAMETER_BLOCK *  LoaderBlock , PSTRING NtDeviceName ,
	PUCHAR NtSystemPath , PSTRING NtSystemPathString ) ;


typedef NTSTATUS (_fastcall *  pHalIoReadPartitionTable )(PDEVICE_OBJECT
	DeviceObject , ULONG SectorSize , BOOLEAN ReturnRecognizedPartitions ,
	struct _DRIVE_LAYOUT_INFORMATION *  *  PartitionBuffer ) ;


typedef NTSTATUS (_fastcall *  pHalIoSetPartitionInformation )(PDEVICE_OBJECT
	DeviceObject , ULONG SectorSize , ULONG PartitionNumber , ULONG
	PartitionType ) ;


typedef NTSTATUS (_fastcall *  pHalIoWritePartitionTable )(PDEVICE_OBJECT
	DeviceObject , ULONG SectorSize , ULONG SectorsPerTrack , ULONG
	NumberOfHeads , struct _DRIVE_LAYOUT_INFORMATION *  PartitionBuffer ) ;


typedef NTSTATUS ( *  pHalQueryBusSlots )(PBUS_HANDLER BusHandler , ULONG
	BufferSize , PULONG SlotNumbers , PULONG ReturnedLength ) ;


typedef NTSTATUS ( *  pHalInitPnpDriver )(void  ) ;


NTSTATUS HaliInitPnpDriver(void  ) ;


typedef struct _PM_DISPATCH_TABLE {
	ULONG Signature ;
	ULONG Version ;
	PVOID Function[1] ;
} PM_DISPATCH_TABLE , *  PPM_DISPATCH_TABLE ;

typedef NTSTATUS ( *  pHalInitPowerManagement )(PPM_DISPATCH_TABLE
	PmDriverDispatchTable , PPM_DISPATCH_TABLE *  PmHalDispatchTable ) ;


NTSTATUS HaliInitPowerManagement(PPM_DISPATCH_TABLE PmDriverDispatchTable ,
	PPM_DISPATCH_TABLE *  PmHalDispatchTable ) ;


typedef struct _DMA_ADAPTER *  ( *  pHalGetDmaAdapter )(PVOID Context ,
	struct _DEVICE_DESCRIPTION *  DeviceDescriptor , PULONG
	NumberOfMapRegisters ) ;


struct _DMA_ADAPTER *  HaliGetDmaAdapter(PVOID Context ,
	struct _DEVICE_DESCRIPTION *  DeviceDescriptor , PULONG
	NumberOfMapRegisters ) ;


typedef NTSTATUS ( *  pHalGetInterruptTranslator )(INTERFACE_TYPE
	ParentInterfaceType , ULONG ParentBusNumber , INTERFACE_TYPE
	BridgeInterfaceType , USHORT Size , USHORT Version ,
	PTRANSLATOR_INTERFACE Translator , PULONG BridgeBusNumber ) ;


NTSTATUS HaliGetInterruptTranslator(INTERFACE_TYPE ParentInterfaceType , ULONG
	ParentBusNumber , INTERFACE_TYPE BridgeInterfaceType , USHORT Size ,
	USHORT Version , PTRANSLATOR_INTERFACE Translator , PULONG
	BridgeBusNumber ) ;


typedef BOOLEAN ( *  pHalTranslateBusAddress )(INTERFACE_TYPE InterfaceType ,
	ULONG BusNumber , PHYSICAL_ADDRESS BusAddress , PULONG AddressSpace ,
	PPHYSICAL_ADDRESS TranslatedAddress ) ;


typedef NTSTATUS ( *  pHalAssignSlotResources )(PUNICODE_STRING RegistryPath ,
	PUNICODE_STRING DriverClassName , PDRIVER_OBJECT DriverObject ,
	PDEVICE_OBJECT DeviceObject , INTERFACE_TYPE BusType , ULONG BusNumber ,
	ULONG SlotNumber , PCM_RESOURCE_LIST *  AllocatedResources ) ;


typedef void ( *  pHalHaltSystem )(void  ) ;


typedef void ( *  pHalResetDisplay )(void  ) ;


typedef BOOLEAN ( *  pHalFindBusAddressTranslation )(PHYSICAL_ADDRESS BusAddress
	, PULONG AddressSpace , PPHYSICAL_ADDRESS TranslatedAddress , PULONG_PTR
	Context , BOOLEAN NextBus ) ;


typedef struct  {
	ULONG Version ;
	pHalQuerySystemInformation HalQuerySystemInformation ;
	pHalSetSystemInformation HalSetSystemInformation ;
	pHalQueryBusSlots HalQueryBusSlots ;
	ULONG Spare1 ;
	pHalExamineMBR HalExamineMBR ;
	pHalIoAssignDriveLetters HalIoAssignDriveLetters ;
	pHalIoReadPartitionTable HalIoReadPartitionTable ;
	pHalIoSetPartitionInformation HalIoSetPartitionInformation ;
	pHalIoWritePartitionTable HalIoWritePartitionTable ;
	pHalHandlerForBus HalReferenceHandlerForBus ;
	pHalReferenceBusHandler HalReferenceBusHandler ;
	pHalReferenceBusHandler HalDereferenceBusHandler ;
	pHalInitPnpDriver HalInitPnpDriver ;
	pHalInitPowerManagement HalInitPowerManagement ;
	pHalGetDmaAdapter HalGetDmaAdapter ;
	pHalGetInterruptTranslator HalGetInterruptTranslator ;
} HAL_DISPATCH , *  PHAL_DISPATCH ;


extern PHAL_DISPATCH HalDispatchTable ;


typedef struct _HAL_BUS_INFORMATION {
	INTERFACE_TYPE BusType ;
	BUS_DATA_TYPE ConfigurationType ;
	ULONG BusNumber ;
	ULONG Reserved ;
} HAL_BUS_INFORMATION , *  PHAL_BUS_INFORMATION ;


typedef struct _HAL_PROFILE_SOURCE_INFORMATION {
	KPROFILE_SOURCE Source ;
	BOOLEAN Supported ;
	ULONG Interval ;
} HAL_PROFILE_SOURCE_INFORMATION , *  PHAL_PROFILE_SOURCE_INFORMATION ;


typedef struct _HAL_PROFILE_SOURCE_INTERVAL {
	KPROFILE_SOURCE Source ;
	ULONG_PTR Interval ;
} HAL_PROFILE_SOURCE_INTERVAL , *  PHAL_PROFILE_SOURCE_INTERVAL ;


typedef enum _HAL_DISPLAY_BIOS_INFORMATION {
	HalDisplayInt10Bios,
	HalDisplayEmulatedBios,
	HalDisplayNoBios
} HAL_DISPLAY_BIOS_INFORMATION , *  PHAL_DISPLAY_BIOS_INFORMATION ;


typedef struct _HAL_POWER_INFORMATION {
	ULONG TBD ;
} HAL_POWER_INFORMATION , *  PHAL_POWER_INFORMATION ;


typedef struct _HAL_PROCESSOR_SPEED_INFO {
	ULONG TBD ;
} HAL_PROCESSOR_SPEED_INFORMATION , *  PHAL_PROCESSOR_SPEED_INFORMATION ;


typedef struct _HAL_CALLBACKS {
	PCALLBACK_OBJECT___0 SetSystemInformation ;
	PCALLBACK_OBJECT___0 BusCheck ;
} HAL_CALLBACKS , *  PHAL_CALLBACKS ;


typedef struct _HAL_PROCESSOR_FEATURE {
	ULONG UsableFeatureBits ;
} HAL_PROCESSOR_FEATURE ;


typedef union _MCI_ADDR {
	struct  {
		ULONG Address ;
		ULONG Reserved ;
	}  ;
	ULONGLONG QuadPart ;
} MCI_ADDR , *  PMCI_ADDR ;


typedef enum  {
	HAL_MCE_RECORD,
	HAL_MCA_RECORD
} MCA_EXCEPTION_TYPE ;


typedef struct _MCA_EXCEPTION {
	ULONG VersionNumber ;
	MCA_EXCEPTION_TYPE ExceptionType ;
	LARGE_INTEGER TimeStamp ;
	ULONG ProcessorNumber ;
	union  {
		struct  {
			UCHAR BankNumber ;
			MCI_STATS Status ;
			MCI_ADDR Address ;
			ULONGLONG Misc ;
		} Mca ;
		struct  {
			ULONGLONG Address ;
			ULONGLONG Type ;
		} Mce ;
	} u ;
} MCA_EXCEPTION , *  PMCA_EXCEPTION ;


typedef void ( *  PDRIVER_EXCPTN_CALLBACK )(PVOID Context , PMCA_EXCEPTION
	BankLog ) ;


typedef struct _MCA_DRIVER_INFO {
	PDRIVER_EXCPTN_CALLBACK ExceptionCallback ;
	PKDEFERRED_ROUTINE DpcCallback ;
	PVOID DeviceContext ;
} MCA_DRIVER_INFO , *  PMCA_DRIVER_INFO ;


typedef struct _SCATTER_GATHER_ELEMENT {
	PHYSICAL_ADDRESS Address ;
	ULONG Length ;
	ULONG_PTR Reserved ;
} SCATTER_GATHER_ELEMENT , *  PSCATTER_GATHER_ELEMENT ;


#pragma warning(disable:4200)

typedef struct _SCATTER_GATHER_LIST {
	ULONG NumberOfElements ;
	ULONG_PTR Reserved ;
	SCATTER_GATHER_ELEMENT Elements[] ;
} SCATTER_GATHER_LIST , *  PSCATTER_GATHER_LIST ;



#pragma warning(default:4200)

typedef struct _DMA_OPERATIONS *  PDMA_OPERATIONS ;

typedef struct _DMA_ADAPTER {
	USHORT Version ;
	USHORT Size ;
	PDMA_OPERATIONS DmaOperations ;
} DMA_ADAPTER , *  PDMA_ADAPTER ;


typedef void ( *  PPUT_DMA_ADAPTER )(PDMA_ADAPTER DmaAdapter ) ;


typedef PVOID ( *  PALLOCATE_COMMON_BUFFER )(PDMA_ADAPTER DmaAdapter , ULONG
	Length , PPHYSICAL_ADDRESS LogicalAddress , BOOLEAN CacheEnabled ) ;


typedef void ( *  PFREE_COMMON_BUFFER )(PDMA_ADAPTER DmaAdapter , ULONG Length ,
	PHYSICAL_ADDRESS LogicalAddress , PVOID VirtualAddress , BOOLEAN
	CacheEnabled ) ;


typedef NTSTATUS ( *  PALLOCATE_ADAPTER_CHANNEL )(PDMA_ADAPTER DmaAdapter ,
	PDEVICE_OBJECT DeviceObject , ULONG NumberOfMapRegisters ,
	PDRIVER_CONTROL ExecutionRoutine , PVOID Context ) ;


typedef BOOLEAN ( *  PFLUSH_ADAPTER_BUFFERS )(PDMA_ADAPTER DmaAdapter , PMDL Mdl
	, PVOID MapRegisterBase , PVOID CurrentVa , ULONG Length , BOOLEAN
	WriteToDevice ) ;


typedef void ( *  PFREE_ADAPTER_CHANNEL )(PDMA_ADAPTER DmaAdapter ) ;


typedef void ( *  PFREE_MAP_REGISTERS )(PDMA_ADAPTER DmaAdapter , PVOID
	MapRegisterBase , ULONG NumberOfMapRegisters ) ;


typedef PHYSICAL_ADDRESS ( *  PMAP_TRANSFER )(PDMA_ADAPTER DmaAdapter , PMDL Mdl
	, PVOID MapRegisterBase , PVOID CurrentVa , PULONG Length , BOOLEAN
	WriteToDevice ) ;


typedef ULONG ( *  PGET_DMA_ALIGNMENT )(PDMA_ADAPTER DmaAdapter ) ;


typedef ULONG ( *  PREAD_DMA_COUNTER )(PDMA_ADAPTER DmaAdapter ) ;


typedef void ( *  PDRIVER_LIST_CONTROL )(struct _DEVICE_OBJECT *  DeviceObject ,
	struct _IRP *  Irp , PSCATTER_GATHER_LIST ScatterGather , PVOID Context
	) ;


typedef NTSTATUS ( *  PGET_SCATTER_GATHER_LIST )(PDMA_ADAPTER DmaAdapter ,
	PDEVICE_OBJECT DeviceObject , PMDL Mdl , PVOID CurrentVa , ULONG Length
	, PDRIVER_LIST_CONTROL ExecutionRoutine , PVOID Context , BOOLEAN
	WriteToDevice ) ;


typedef void ( *  PPUT_SCATTER_GATHER_LIST )(PDMA_ADAPTER DmaAdapter ,
	PSCATTER_GATHER_LIST ScatterGather , BOOLEAN WriteToDevice ) ;


typedef struct _DMA_OPERATIONS {
	ULONG Size ;
	PPUT_DMA_ADAPTER PutDmaAdapter ;
	PALLOCATE_COMMON_BUFFER AllocateCommonBuffer ;
	PFREE_COMMON_BUFFER FreeCommonBuffer ;
	PALLOCATE_ADAPTER_CHANNEL AllocateAdapterChannel ;
	PFLUSH_ADAPTER_BUFFERS FlushAdapterBuffers ;
	PFREE_ADAPTER_CHANNEL FreeAdapterChannel ;
	PFREE_MAP_REGISTERS FreeMapRegisters ;
	PMAP_TRANSFER MapTransfer ;
	PGET_DMA_ALIGNMENT GetDmaAlignment ;
	PREAD_DMA_COUNTER ReadDmaCounter ;
	PGET_SCATTER_GATHER_LIST GetScatterGatherList ;
	PPUT_SCATTER_GATHER_LIST PutScatterGatherList ;
} DMA_OPERATIONS ;


__declspec(dllimport) NTSTATUS HalAllocateAdapterChannel(PADAPTER_OBJECT
	AdapterObject , PWAIT_CONTEXT_BLOCK Wcb , ULONG NumberOfMapRegisters ,
	PDRIVER_CONTROL ExecutionRoutine ) ;

__declspec(dllimport) PVOID HalAllocateCommonBuffer(PADAPTER_OBJECT
	AdapterObject , ULONG Length , PPHYSICAL_ADDRESS LogicalAddress ,
	BOOLEAN CacheEnabled ) ;

__declspec(dllimport) void HalFreeCommonBuffer(PADAPTER_OBJECT AdapterObject ,
	ULONG Length , PHYSICAL_ADDRESS LogicalAddress , PVOID VirtualAddress ,
	BOOLEAN CacheEnabled ) ;

__declspec(dllimport) ULONG HalReadDmaCounter(PADAPTER_OBJECT AdapterObject ) ;

__declspec(dllimport) BOOLEAN IoFlushAdapterBuffers(PADAPTER_OBJECT
	AdapterObject , PMDL Mdl , PVOID MapRegisterBase , PVOID CurrentVa ,
	ULONG Length , BOOLEAN WriteToDevice ) ;

__declspec(dllimport) void IoFreeAdapterChannel(PADAPTER_OBJECT AdapterObject )
	;

__declspec(dllimport) void IoFreeMapRegisters(PADAPTER_OBJECT AdapterObject ,
	PVOID MapRegisterBase , ULONG NumberOfMapRegisters ) ;

__declspec(dllimport) PHYSICAL_ADDRESS IoMapTransfer(PADAPTER_OBJECT
	AdapterObject , PMDL Mdl , PVOID MapRegisterBase , PVOID CurrentVa ,
	PULONG Length , BOOLEAN WriteToDevice ) ;

NTSTATUS HalGetScatterGatherList(PADAPTER_OBJECT DmaAdapter , PDEVICE_OBJECT
	DeviceObject , PMDL Mdl , PVOID CurrentVa , ULONG Length ,
	PDRIVER_LIST_CONTROL ExecutionRoutine , PVOID Context , BOOLEAN
	WriteToDevice ) ;

void HalPutScatterGatherList(PADAPTER_OBJECT DmaAdapter , PSCATTER_GATHER_LIST
	ScatterGather , BOOLEAN WriteToDevice ) ;

void HalPutDmaAdapter(PADAPTER_OBJECT DmaAdapter ) ;

__declspec(dllimport) void PoSetSystemState(EXECUTION_STATE Flags ) ;

__declspec(dllimport) PVOID PoRegisterSystemState(PVOID StateHandle ,
	EXECUTION_STATE Flags ) ;


typedef void ( *  PREQUEST_POWER_COMPLETE )(PDEVICE_OBJECT DeviceObject , UCHAR
	MinorFunction , POWER_STATE PowerState , PVOID Context ,
	PIO_STATUS_BLOCK IoStatus ) ;


__declspec(dllimport) NTSTATUS PoRequestPowerIrp(PDEVICE_OBJECT DeviceObject ,
	UCHAR MinorFunction , POWER_STATE PowerState , PREQUEST_POWER_COMPLETE
	CompletionFunction , PVOID Context , PIRP *  Irp ) ;

__declspec(dllimport) void PoUnregisterSystemState(PVOID StateHandle ) ;

__declspec(dllimport) POWER_STATE PoSetPowerState(PDEVICE_OBJECT DeviceObject ,
	POWER_STATE_TYPE Type , POWER_STATE State ) ;

__declspec(dllimport) NTSTATUS PoCallDriver(PDEVICE_OBJECT DeviceObject ) ;

__declspec(dllimport) void PoStartNextPowerIrp() ;

__declspec(dllimport) PULONG PoRegisterDeviceForIdleDetection(PDEVICE_OBJECT
	DeviceObject , ULONG ConservationIdleTime , ULONG PerformanceIdleTime ,
	DEVICE_POWER_STATE State ) ;

__declspec(dllimport) BOOLEAN FsRtlIsTotalDeviceFailure(NTSTATUS Status ) ;


typedef struct _OBJECT_HANDLE_INFORMATION {
	ULONG HandleAttributes ;
	ACCESS_MASK GrantedAccess ;
} OBJECT_HANDLE_INFORMATION , *  POBJECT_HANDLE_INFORMATION ;

__declspec(dllimport) NTSTATUS ObReferenceObjectByHandle(HANDLE Handle ,
	ACCESS_MASK DesiredAccess , POBJECT_TYPE ObjectType , KPROCESSOR_MODE
	AccessMode , PVOID *  Object , POBJECT_HANDLE_INFORMATION
	HandleInformation ) ;

__declspec(dllimport) void _fastcall ObfReferenceObject(PVOID Object ) ;

__declspec(dllimport) NTSTATUS ObReferenceObjectByPointer(PVOID Object ,
	ACCESS_MASK DesiredAccess , POBJECT_TYPE ObjectType , KPROCESSOR_MODE
	AccessMode ) ;

__declspec(dllimport) void _fastcall ObfDereferenceObject(PVOID Object ) ;

NTSTATUS ObGetObjectSecurity(PVOID Object , PSECURITY_DESCRIPTOR * 
	SecurityDescriptor , PBOOLEAN MemoryAllocated ) ;

void ObReleaseObjectSecurity(PSECURITY_DESCRIPTOR SecurityDescriptor , BOOLEAN
	MemoryAllocated ) ;


typedef struct _PCI_SLOT_NUMBER {
	union  {
		struct  {
			ULONG DeviceNumber  : 5;
			ULONG FunctionNumber  : 3;
			ULONG Reserved  : 24;
		} bits ;
		ULONG AsULONG ;
	} u ;
} PCI_SLOT_NUMBER , *  PPCI_SLOT_NUMBER ;


typedef struct _PCI_COMMON_CONFIG {
	USHORT VendorID ;
	USHORT DeviceID ;
	USHORT Command ;
	USHORT Status ;
	UCHAR RevisionID ;
	UCHAR ProgIf ;
	UCHAR SubClass ;
	UCHAR BaseClass ;
	UCHAR CacheLineSize ;
	UCHAR LatencyTimer ;
	UCHAR HeaderType ;
	UCHAR BIST ;
	union  {
		struct _PCI_HEADER_TYPE_0 {
			ULONG BaseAddresses[6] ;
			ULONG CIS ;
			USHORT SubVendorID ;
			USHORT SubSystemID ;
			ULONG ROMBaseAddress ;
			UCHAR CapabilitiesPtr ;
			UCHAR Reserved1[3] ;
			ULONG Reserved2 ;
			UCHAR InterruptLine ;
			UCHAR InterruptPin ;
			UCHAR MinimumGrant ;
			UCHAR MaximumLatency ;
		} type0 ;
		struct _PCI_HEADER_TYPE_1 {
			ULONG BaseAddresses[2] ;
			UCHAR PrimaryBus ;
			UCHAR SecondaryBus ;
			UCHAR SubordinateBus ;
			UCHAR SecondaryLatency ;
			UCHAR IOBase ;
			UCHAR IOLimit ;
			USHORT SecondaryStatus ;
			USHORT MemoryBase ;
			USHORT MemoryLimit ;
			USHORT PrefetchBase ;
			USHORT PrefetchLimit ;
			ULONG PrefetchBaseUpper32 ;
			ULONG PrefetchLimitUpper32 ;
			USHORT IOBaseUpper16 ;
			USHORT IOLimitUpper16 ;
			UCHAR CapabilitiesPtr ;
			UCHAR Reserved1[3] ;
			ULONG ROMBaseAddress ;
			UCHAR InterruptLine ;
			UCHAR InterruptPin ;
			USHORT BridgeControl ;
		} type1 ;
		struct _PCI_HEADER_TYPE_2 {
			ULONG SocketRegistersBaseAddress ;
			UCHAR CapabilitiesPtr ;
			UCHAR Reserved ;
			USHORT SecondaryStatus ;
			UCHAR PrimaryBus ;
			UCHAR SecondaryBus ;
			UCHAR SubordinateBus ;
			UCHAR SecondaryLatency ;
			struct  {
				ULONG Base ;
				ULONG Limit ;
			} Range[5 - 1] ;
			UCHAR InterruptLine ;
			UCHAR InterruptPin ;
			USHORT BridgeControl ;
		} type2 ;
	} u ;
	UCHAR DeviceSpecific[192] ;
} PCI_COMMON_CONFIG , *  PPCI_COMMON_CONFIG ;


typedef struct _PCI_CAPABILITIES_HEADER {
	UCHAR CapabilityID ;
	UCHAR Next ;
} PCI_CAPABILITIES_HEADER , *  PPCI_CAPABILITIES_HEADER ;


typedef struct _PCI_PMC {
	UCHAR Version  : 3;
	UCHAR PMEClock  : 1;
	UCHAR Rsvd1  : 1;
	UCHAR DeviceSpecificInitialization  : 1;
	UCHAR Rsvd2  : 2;
	struct _PM_SUPPORT {
		UCHAR Rsvd2  : 1;
		UCHAR D1  : 1;
		UCHAR D2  : 1;
		UCHAR PMED0  : 1;
		UCHAR PMED1  : 1;
		UCHAR PMED2  : 1;
		UCHAR PMED3Hot  : 1;
		UCHAR PMED3Cold  : 1;
	} Support ;
} PCI_PMC , *  PPCI_PMC ;

typedef struct _PCI_PMCSR {
	USHORT PowerState  : 2;
	USHORT Rsvd1  : 6;
	USHORT PMEEnable  : 1;
	USHORT DataSelect  : 4;
	USHORT DataScale  : 2;
	USHORT PMEStatus  : 1;
} PCI_PMCSR , *  PPCI_PMCSR ;


typedef struct _PCI_PMCSR_BSE {
	UCHAR Rsvd1  : 6;
	UCHAR D3HotSupportsStopClock  : 1;
	UCHAR BusPowerClockControlEnabled  : 1;
} PCI_PMCSR_BSE , *  PPCI_PMCSR_BSE ;


typedef struct _PCI_PM_CAPABILITY {
	PCI_CAPABILITIES_HEADER Header ;
	union  {
		PCI_PMC Capabilities ;
		USHORT AsUSHORT ;
	} PMC ;
	union  {
		PCI_PMCSR ControlStatus ;
		USHORT AsUSHORT ;
	} PMCSR ;
	union  {
		PCI_PMCSR_BSE BridgeSupport ;
		UCHAR AsUCHAR ;
	} PMCSR_BSE ;
	UCHAR Data ;
} PCI_PM_CAPABILITY , *  PPCI_PM_CAPABILITY ;


typedef struct _PCI_AGP_CAPABILITY {
	PCI_CAPABILITIES_HEADER Header ;
	USHORT Minor  : 4;
	USHORT Major  : 4;
	USHORT Rsvd1  : 8;
	struct _PCI_AGP_STATUS {
		ULONG Rate  : 3;
		ULONG Rsvd1  : 1;
		ULONG FastWrite  : 1;
		ULONG FourGB  : 1;
		ULONG Rsvd2  : 3;
		ULONG SideBandAddressing  : 1;
		ULONG Rsvd3  : 14;
		ULONG RequestQueueDepthMaximum  : 8;
	} AGPStatus ;
	struct _PCI_AGP_COMMAND {
		ULONG Rate  : 3;
		ULONG Rsvd1  : 1;
		ULONG FastWriteEnable  : 1;
		ULONG FourGBEnable  : 1;
		ULONG Rsvd2  : 2;
		ULONG AGPEnable  : 1;
		ULONG SBAEnable  : 1;
		ULONG Rsvd3  : 14;
		ULONG RequestQueueDepth  : 8;
	} AGPCommand ;
} PCI_AGP_CAPABILITY , *  PPCI_AGP_CAPABILITY ;


typedef struct _PCI_MSI_CAPABILITY {
	PCI_CAPABILITIES_HEADER Header ;
	struct _PCI_MSI_MESSAGE_CONTROL {
		USHORT MSIEnable  : 1;
		USHORT MultipleMessageCapable  : 3;
		USHORT MultipleMessageEnable  : 3;
		USHORT CapableOf64Bits  : 1;
		USHORT Reserved  : 8;
	} MessageControl ;
	union  {
		struct _PCI_MSI_MESSAGE_ADDRESS {
			ULONG_PTR Reserved  : 2;
			ULONG_PTR Address  : 30;
		} Register ;
		ULONG_PTR Raw ;
	} MessageAddress ;
	union  {
		struct _PCI_MSI_64BIT_DATA {
			ULONG MessageUpperAddress ;
			USHORT MessageData ;
		} Bit64 ;
		struct _PCI_MSI_32BIT_DATA {
			USHORT MessageData ;
			ULONG Unused ;
		} Bit32 ;
	} Data ;
} PCI_MSI_CAPABILITY , *  PPCI_PCI_CAPABILITY ;


typedef void ( *  PciPin2Line )(struct _BUS_HANDLER *  BusHandler ,
	struct _BUS_HANDLER *  RootHandler , PCI_SLOT_NUMBER SlotNumber ,
	PPCI_COMMON_CONFIG PciData ) ;


typedef void ( *  PciLine2Pin )(struct _BUS_HANDLER *  BusHandler ,
	struct _BUS_HANDLER *  RootHandler , PCI_SLOT_NUMBER SlotNumber ,
	PPCI_COMMON_CONFIG PciNewData , PPCI_COMMON_CONFIG PciOldData ) ;


typedef void ( *  PciReadWriteConfig )(struct _BUS_HANDLER *  BusHandler ,
	PCI_SLOT_NUMBER Slot , PVOID Buffer , ULONG Offset , ULONG Length ) ;


typedef struct _PCIBUSDATA {
	ULONG Tag ;
	ULONG Version ;
	PciReadWriteConfig ReadConfig ;
	PciReadWriteConfig WriteConfig ;
	PciPin2Line Pin2Line ;
	PciLine2Pin Line2Pin ;
	PCI_SLOT_NUMBER ParentSlot ;
	PVOID Reserved[4] ;
} PCIBUSDATA , *  PPCIBUSDATA ;

typedef ULONG ( *  PCI_READ_WRITE_CONFIG )(PVOID Context , UCHAR BusOffset ,
	ULONG Slot , PVOID Buffer , ULONG Offset , ULONG Length ) ;


typedef void ( *  PCI_PIN_TO_LINE )(PVOID Context , PPCI_COMMON_CONFIG PciData )
	;


typedef void ( *  PCI_LINE_TO_PIN )(PVOID Context , PPCI_COMMON_CONFIG
	PciNewData , PPCI_COMMON_CONFIG PciOldData ) ;


typedef struct _PCI_BUS_INTERFACE_STANDARD {
	USHORT Size ;
	USHORT Version ;
	PVOID Context ;
	PINTERFACE_REFERENCE InterfaceReference ;
	PINTERFACE_DEREFERENCE InterfaceDereference ;
	PCI_READ_WRITE_CONFIG ReadConfig ;
	PCI_READ_WRITE_CONFIG WriteConfig ;
	PCI_PIN_TO_LINE PinToLine ;
	PCI_LINE_TO_PIN LineToPin ;
} PCI_BUS_INTERFACE_STANDARD , *  PPCI_BUS_INTERFACE_STANDARD ;


typedef BOOLEAN ( *  PPCI_IS_DEVICE_PRESENT )(USHORT VendorID , USHORT DeviceID
	, UCHAR RevisionID , USHORT SubVendorID , USHORT SubSystemID , ULONG
	Flags ) ;


typedef struct _PCI_DEVICE_PRESENT_INTERFACE {
	USHORT Size ;
	USHORT Version ;
	PVOID Context ;
	PINTERFACE_REFERENCE InterfaceReference ;
	PINTERFACE_DEREFERENCE InterfaceDereference ;
	PPCI_IS_DEVICE_PRESENT IsDevicePresent ;
} PCI_DEVICE_PRESENT_INTERFACE , *  PPCI_DEVICE_PRESENT_INTERFACE ;


extern POBJECT_TYPE *  IoFileObjectType ;
extern POBJECT_TYPE *  ExEventObjectType ;
extern POBJECT_TYPE *  ExSemaphoreObjectType ;

__declspec(dllimport) NTSTATUS __stdcall ZwCreateFile(PHANDLE FileHandle ,
	ACCESS_MASK DesiredAccess , POBJECT_ATTRIBUTES ObjectAttributes ,
	PIO_STATUS_BLOCK IoStatusBlock , PLARGE_INTEGER AllocationSize , ULONG
	FileAttributes , ULONG ShareAccess , ULONG CreateDisposition , ULONG
	CreateOptions , PVOID EaBuffer , ULONG EaLength ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwOpenFile(PHANDLE FileHandle ,
	ACCESS_MASK DesiredAccess , POBJECT_ATTRIBUTES ObjectAttributes ,
	PIO_STATUS_BLOCK IoStatusBlock , ULONG ShareAccess , ULONG OpenOptions )
	;

__declspec(dllimport) NTSTATUS __stdcall ZwQueryInformationFile(HANDLE
	FileHandle , PIO_STATUS_BLOCK IoStatusBlock , PVOID FileInformation ,
	ULONG Length , FILE_INFORMATION_CLASS FileInformationClass ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwSetInformationFile(HANDLE FileHandle
	, PIO_STATUS_BLOCK IoStatusBlock , PVOID FileInformation , ULONG Length
	, FILE_INFORMATION_CLASS FileInformationClass ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwReadFile(HANDLE FileHandle , HANDLE
	Event , PIO_APC_ROUTINE ApcRoutine , PVOID ApcContext , PIO_STATUS_BLOCK
	IoStatusBlock , PVOID Buffer , ULONG Length , PLARGE_INTEGER ByteOffset
	, PULONG Key ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwWriteFile(HANDLE FileHandle , HANDLE
	Event , PIO_APC_ROUTINE ApcRoutine , PVOID ApcContext , PIO_STATUS_BLOCK
	IoStatusBlock , PVOID Buffer , ULONG Length , PLARGE_INTEGER ByteOffset
	, PULONG Key ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwClose(HANDLE Handle ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwCreateDirectoryObject(PHANDLE
	DirectoryHandle , ACCESS_MASK DesiredAccess , POBJECT_ATTRIBUTES
	ObjectAttributes ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwMakeTemporaryObject(HANDLE Handle ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwOpenSection(PHANDLE SectionHandle ,
	ACCESS_MASK DesiredAccess , POBJECT_ATTRIBUTES ObjectAttributes ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwMapViewOfSection(HANDLE SectionHandle
	, HANDLE ProcessHandle , PVOID *  BaseAddress , ULONG ZeroBits , ULONG
	CommitSize , PLARGE_INTEGER SectionOffset , PSIZE_T ViewSize ,
	SECTION_INHERIT InheritDisposition , ULONG AllocationType , ULONG
	Protect ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwUnmapViewOfSection(HANDLE
	ProcessHandle , PVOID BaseAddress ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwSetInformationThread(HANDLE
	ThreadHandle , THREADINFOCLASS ThreadInformationClass , PVOID
	ThreadInformation , ULONG ThreadInformationLength ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwCreateKey(PHANDLE KeyHandle ,
	ACCESS_MASK DesiredAccess , POBJECT_ATTRIBUTES ObjectAttributes , ULONG
	TitleIndex , PUNICODE_STRING Class , ULONG CreateOptions , PULONG
	Disposition ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwOpenKey(PHANDLE KeyHandle ,
	ACCESS_MASK DesiredAccess , POBJECT_ATTRIBUTES ObjectAttributes ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwDeleteKey(HANDLE KeyHandle ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwEnumerateKey(HANDLE KeyHandle , ULONG
	Index , KEY_INFORMATION_CLASS KeyInformationClass , PVOID KeyInformation
	, ULONG Length , PULONG ResultLength ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwEnumerateValueKey(HANDLE KeyHandle ,
	ULONG Index , KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass ,
	PVOID KeyValueInformation , ULONG Length , PULONG ResultLength ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwFlushKey(HANDLE KeyHandle ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwQueryKey(HANDLE KeyHandle ,
	KEY_INFORMATION_CLASS KeyInformationClass , PVOID KeyInformation , ULONG
	Length , PULONG ResultLength ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwQueryValueKey(HANDLE KeyHandle ,
	PUNICODE_STRING ValueName , KEY_VALUE_INFORMATION_CLASS
	KeyValueInformationClass , PVOID KeyValueInformation , ULONG Length ,
	PULONG ResultLength ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwSetValueKey(HANDLE KeyHandle ,
	PUNICODE_STRING ValueName , ULONG TitleIndex , ULONG Type , PVOID Data ,
	ULONG DataSize ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwOpenSymbolicLinkObject(PHANDLE
	LinkHandle , ACCESS_MASK DesiredAccess , POBJECT_ATTRIBUTES
	ObjectAttributes ) ;

__declspec(dllimport) NTSTATUS __stdcall ZwQuerySymbolicLinkObject(HANDLE
	LinkHandle , PUNICODE_STRING LinkTarget , PULONG ReturnedLength ) ;

NTSTATUS ZwCreateTimer(PHANDLE TimerHandle , ACCESS_MASK DesiredAccess ,
	POBJECT_ATTRIBUTES ObjectAttributes , TIMER_TYPE TimerType ) ;

NTSTATUS ZwOpenTimer(PHANDLE TimerHandle , ACCESS_MASK DesiredAccess ,
	POBJECT_ATTRIBUTES ObjectAttributes ) ;

NTSTATUS ZwCancelTimer(HANDLE TimerHandle , PBOOLEAN CurrentState ) ;

NTSTATUS ZwSetTimer(HANDLE TimerHandle , PLARGE_INTEGER DueTime ,
	PTIMER_APC_ROUTINE TimerApcRoutine , PVOID TimerContext , BOOLEAN
	WakeTimer , LONG Period , PBOOLEAN PreviousState ) ;



#pragma once

extern const GUID GUID_CLASS_KEYBOARD ;


typedef struct _KEYBOARD_INPUT_DATA {
	USHORT UnitId ;
	USHORT MakeCode ;
	USHORT Flags ;
	USHORT Reserved ;
	ULONG ExtraInformation ;
} KEYBOARD_INPUT_DATA , *  PKEYBOARD_INPUT_DATA ;


typedef struct _KEYBOARD_TYPEMATIC_PARAMETERS {
	USHORT UnitId ;
	USHORT Rate ;
	USHORT Delay ;
} KEYBOARD_TYPEMATIC_PARAMETERS , *  PKEYBOARD_TYPEMATIC_PARAMETERS ;


typedef struct _KEYBOARD_ID {
	UCHAR Type ;
	UCHAR Subtype ;
} KEYBOARD_ID , *  PKEYBOARD_ID ;

typedef struct _KEYBOARD_ATTRIBUTES {
	KEYBOARD_ID KeyboardIdentifier ;
	USHORT KeyboardMode ;
	USHORT NumberOfFunctionKeys ;
	USHORT NumberOfIndicators ;
	USHORT NumberOfKeysTotal ;
	ULONG InputDataQueueLength ;
	KEYBOARD_TYPEMATIC_PARAMETERS KeyRepeatMinimum ;
	KEYBOARD_TYPEMATIC_PARAMETERS KeyRepeatMaximum ;
} KEYBOARD_ATTRIBUTES , *  PKEYBOARD_ATTRIBUTES ;


typedef struct _KEYBOARD_INDICATOR_PARAMETERS {
	USHORT UnitId ;
	USHORT LedFlags ;
} KEYBOARD_INDICATOR_PARAMETERS , *  PKEYBOARD_INDICATOR_PARAMETERS ;


typedef struct _INDICATOR_LIST {
	USHORT MakeCode ;
	USHORT IndicatorFlags ;
} INDICATOR_LIST , *  PINDICATOR_LIST ;


typedef struct _KEYBOARD_INDICATOR_TRANSLATION {
	USHORT NumberOfIndicatorKeys ;
	INDICATOR_LIST IndicatorList[1] ;
} KEYBOARD_INDICATOR_TRANSLATION , *  PKEYBOARD_INDICATOR_TRANSLATION ;


typedef struct _KEYBOARD_UNIT_ID_PARAMETER {
	USHORT UnitId ;
} KEYBOARD_UNIT_ID_PARAMETER , *  PKEYBOARD_UNIT_ID_PARAMETER ;


typedef struct _KEYBOARD_IME_STATUS {
	USHORT UnitId ;
	ULONG ImeOpen ;
	ULONG ImeConvMode ;
} KEYBOARD_IME_STATUS , *  PKEYBOARD_IME_STATUS ;



#pragma once

extern const GUID GUID_CLASS_MOUSE ;


typedef struct _MOUSE_INPUT_DATA {
	USHORT UnitId ;
	USHORT Flags ;
	union  {
		ULONG Buttons ;
		struct  {
			USHORT ButtonFlags ;
			USHORT ButtonData ;
		}  ;
	}  ;
	ULONG RawButtons ;
	LONG LastX ;
	LONG LastY ;
	ULONG ExtraInformation ;
} MOUSE_INPUT_DATA , *  PMOUSE_INPUT_DATA ;


typedef struct _MOUSE_ATTRIBUTES {
	USHORT MouseIdentifier ;
	USHORT NumberOfButtons ;
	USHORT SampleRate ;
	ULONG InputDataQueueLength ;
} MOUSE_ATTRIBUTES , *  PMOUSE_ATTRIBUTES ;


typedef struct _MOUSE_UNIT_ID_PARAMETER {
	USHORT UnitId ;
} MOUSE_UNIT_ID_PARAMETER , *  PMOUSE_UNIT_ID_PARAMETER ;


typedef struct _CONNECT_DATA {
	PDEVICE_OBJECT ClassDeviceObject ;
	PVOID ClassService ;
} CONNECT_DATA , *  PCONNECT_DATA ;


typedef void ( *  PSERVICE_CALLBACK_ROUTINE )(PVOID NormalContext , PVOID
	SystemArgument1 , PVOID SystemArgument2 , PVOID SystemArgument3 ) ;


extern const GUID MSWmi_MofData_GUID ;


typedef struct _MSWmi_MofData {
	ULONG Unused1 ;
	ULONG Unused2 ;
	ULONG Size ;
	ULONG Unused4 ;
	UCHAR BinaryMofData[1] ;
} MSWmi_MofData , *  PMSWmi_MofData ;


extern const GUID MSWmi_ProviderInfo_GUID ;


typedef struct _MSWmi_ProviderInfo {
	char VariableData[1] ;
} MSWmi_ProviderInfo , *  PMSWmi_ProviderInfo ;


extern const GUID MSWmi_PnPDeviceId_GUID ;


typedef struct _MSWmi_PnPDeviceId {
	CHAR VariableData[1] ;
} MSWmi_PnPDeviceId , *  PMSWmi_PnPDeviceId ;


extern const GUID MSWmi_PnPInstanceNames_GUID ;


typedef struct _MSWmi_PnPInstanceNames {
	ULONG Count ;
	WCHAR InstanceNameList[1] ;
} MSWmi_PnPInstanceNames , *  PMSWmi_PnPInstanceNames ;


extern const GUID MSSmBios_RawSMBiosTables_GUID ;


typedef struct _MSSmBios_RawSMBiosTables {
	BOOLEAN Used20CallingMethod ;
	UCHAR SmbiosMajorVersion ;
	UCHAR SmbiosMinorVersion ;
	UCHAR DmiRevision ;
	ULONG Size ;
	UCHAR SMBiosData[1] ;
} MSSmBios_RawSMBiosTables , *  PMSSmBios_RawSMBiosTables ;


extern const GUID MSPower_DeviceEnable_GUID ;


typedef struct _MSPower_DeviceEnable {
	BOOLEAN Enable ;
} MSPower_DeviceEnable , *  PMSPower_DeviceEnable ;


extern const GUID MSPower_DeviceWakeEnable_GUID ;


typedef struct _MSPower_DeviceWakeEnable {
	BOOLEAN Enable ;
} MSPower_DeviceWakeEnable , *  PMSPower_DeviceWakeEnable ;


extern const GUID MSNdis_NetworkAddress_GUID ;


typedef struct _MSNdis_NetworkAddress {
	UCHAR Address[6] ;
} MSNdis_NetworkAddress , *  PMSNdis_NetworkAddress ;


extern const GUID MSNdis_NetworkShortAddress_GUID ;


typedef struct _MSNdis_NetworkShortAddress {
	UCHAR Address[2] ;
} MSNdis_NetworkShortAddress , *  PMSNdis_NetworkShortAddress ;


extern const GUID MSNdis_NetworkLinkSpeed_GUID ;


typedef struct _MSNdis_NetworkLinkSpeed {
	ULONG Outbound ;
	ULONG Inbound ;
} MSNdis_NetworkLinkSpeed , *  PMSNdis_NetworkLinkSpeed ;


extern const GUID MSNdis_EnumerateAdapter_GUID ;


typedef struct _MSNdis_EnumerateAdapter {
	CHAR VariableData[1] ;
} MSNdis_EnumerateAdapter , *  PMSNdis_EnumerateAdapter ;


extern const GUID MSNdis_NotifyAdapterRemoval_GUID ;


typedef struct _MSNdis_NotifyAdapterRemoval {
	CHAR VariableData[1] ;
} MSNdis_NotifyAdapterRemoval , *  PMSNdis_NotifyAdapterRemoval ;


extern const GUID MSNdis_NotifyAdapterArrival_GUID ;


typedef struct _MSNdis_NotifyAdapterArrival {
	CHAR VariableData[1] ;
} MSNdis_NotifyAdapterArrival , *  PMSNdis_NotifyAdapterArrival ;


extern const GUID MSNdis_NdisEnumerateVc_GUID ;


typedef struct _MSNdis_NdisEnumerateVc {
	char VariableData[1] ;
} MSNdis_NdisEnumerateVc , *  PMSNdis_NdisEnumerateVc ;


extern const GUID MSNdis_NotifyVcRemoval_GUID ;


typedef struct _MSNdis_NotifyVcRemoval {
	char VariableData[1] ;
} MSNdis_NotifyVcRemoval , *  PMSNdis_NotifyVcRemoval ;


extern const GUID MSNdis_NotifyVcArrival_GUID ;


typedef struct _MSNdis_NotifyVcArrival {
	char VariableData[1] ;
} MSNdis_NotifyVcArrival , *  PMSNdis_NotifyVcArrival ;


extern const GUID MSNdis_HardwareStatus_GUID ;


typedef struct _MSNdis_HardwareStatus {
	ULONG NdisHardwareStatus ;
} MSNdis_HardwareStatus , *  PMSNdis_HardwareStatus ;


extern const GUID MSNdis_MediaSupported_GUID ;


typedef struct _MSNdis_MediaSupported {
	ULONG NumberElements ;
	ULONG NdisMediaSupported[1] ;
} MSNdis_MediaSupported , *  PMSNdis_MediaSupported ;


extern const GUID MSNdis_MediaInUse_GUID ;


typedef struct _MSNdis_MediaInUse {
	ULONG NumberElements ;
	ULONG NdisMediaInUse[1] ;
} MSNdis_MediaInUse , *  PMSNdis_MediaInUse ;


extern const GUID MSNdis_MaximumLookahead_GUID ;


typedef struct _MSNdis_MaximumLookahead {
	ULONG NdisMaximumLookahead ;
} MSNdis_MaximumLookahead , *  PMSNdis_MaximumLookahead ;


extern const GUID MSNdis_MaximumFrameSize_GUID ;


typedef struct _MSNdis_MaximumFrameSize {
	ULONG NdisMaximumFrameSize ;
} MSNdis_MaximumFrameSize , *  PMSNdis_MaximumFrameSize ;


extern const GUID MSNdis_LinkSpeed_GUID ;


typedef struct _MSNdis_LinkSpeed {
	ULONG NdisLinkSpeed ;
} MSNdis_LinkSpeed , *  PMSNdis_LinkSpeed ;


extern const GUID MSNdis_TransmitBufferSpace_GUID ;


typedef struct _MSNdis_TransmitBufferSpace {
	ULONG NdisTransmitBufferSpace ;
} MSNdis_TransmitBufferSpace , *  PMSNdis_TransmitBufferSpace ;


extern const GUID MSNdis_ReceiveBufferSpace_GUID ;


typedef struct _MSNdis_ReceiveBufferSpace {
	ULONG NdisReceiveBufferSpace ;
} MSNdis_ReceiveBufferSpace , *  PMSNdis_ReceiveBufferSpace ;


extern const GUID MSNdis_TransmitBlockSize_GUID ;


typedef struct _MSNdis_TransmitBlockSize {
	ULONG NdisTransmitBlockSize ;
} MSNdis_TransmitBlockSize , *  PMSNdis_TransmitBlockSize ;


extern const GUID MSNdis_ReceiveBlockSize_GUID ;


typedef struct _MSNdis_ReceiveBlockSize {
	ULONG NdisReceiveBlockSize ;
} MSNdis_ReceiveBlockSize , *  PMSNdis_ReceiveBlockSize ;


extern const GUID MSNdis_VendorID_GUID ;


typedef struct _MSNdis_VendorID {
	ULONG NdisVendorID ;
} MSNdis_VendorID , *  PMSNdis_VendorID ;


extern const GUID MSNdis_VendorDescription_GUID ;


typedef struct _MSNdis_VendorDescription {
	CHAR VariableData[1] ;
} MSNdis_VendorDescription , *  PMSNdis_VendorDescription ;


extern const GUID MSNdis_CurrentPacketFilter_GUID ;


typedef struct _MSNdis_CurrentPacketFilter {
	ULONG NdisCurrentPacketFilter ;
} MSNdis_CurrentPacketFilter , *  PMSNdis_CurrentPacketFilter ;


extern const GUID MSNdis_CurrentLookahead_GUID ;


typedef struct _MSNdis_CurrentLookahead {
	ULONG NdisCurrentLookahead ;
} MSNdis_CurrentLookahead , *  PMSNdis_CurrentLookahead ;


extern const GUID MSNdis_DriverVersion_GUID ;


typedef struct _MSNdis_DriverVersion {
	USHORT NdisDriverVersion ;
} MSNdis_DriverVersion , *  PMSNdis_DriverVersion ;


extern const GUID MSNdis_MaximumTotalSize_GUID ;


typedef struct _MSNdis_MaximumTotalSize {
	ULONG NdisMaximumTotalSize ;
} MSNdis_MaximumTotalSize , *  PMSNdis_MaximumTotalSize ;


extern const GUID MSNdis_MacOptions_GUID ;


typedef struct _MSNdis_MacOptions {
	ULONG NdisMacOptions ;
} MSNdis_MacOptions , *  PMSNdis_MacOptions ;


extern const GUID MSNdis_MediaConnectStatus_GUID ;


typedef struct _MSNdis_MediaConnectStatus {
	ULONG NdisMediaConnectStatus ;
} MSNdis_MediaConnectStatus , *  PMSNdis_MediaConnectStatus ;


extern const GUID MSNdis_MaximumSendPackets_GUID ;


typedef struct _MSNdis_MaximumSendPackets {
	ULONG NdisMaximumSendPackets ;
} MSNdis_MaximumSendPackets , *  PMSNdis_MaximumSendPackets ;


extern const GUID MSNdis_VendorDriverVersion_GUID ;


typedef struct _MSNdis_VendorDriverVersion {
	ULONG NdisVendorDriverVersion ;
} MSNdis_VendorDriverVersion , *  PMSNdis_VendorDriverVersion ;


extern const GUID MSNdis_TransmitsOk_GUID ;


typedef struct _MSNdis_TransmitsOk {
	ULONG NdisTransmitsOk ;
} MSNdis_TransmitsOk , *  PMSNdis_TransmitsOk ;


extern const GUID MSNdis_ReceivesOk_GUID ;


typedef struct _MSNdis_ReceivesOk {
	ULONG NdisReceivesOk ;
} MSNdis_ReceivesOk , *  PMSNdis_ReceivesOk ;


extern const GUID MSNdis_TransmitsError_GUID ;


typedef struct _MSNdis_TransmitsError {
	ULONG NdisTransmitsError ;
} MSNdis_TransmitsError , *  PMSNdis_TransmitsError ;


extern const GUID MSNdis_ReceiveError_GUID ;


typedef struct _MSNdis_ReceiveError {
	ULONG NdisReceiveError ;
} MSNdis_ReceiveError , *  PMSNdis_ReceiveError ;


extern const GUID MSNdis_ReceiveNoBuffer_GUID ;


typedef struct _MSNdis_ReceiveNoBuffer {
	ULONG NdisReceiveNoBuffer ;
} MSNdis_ReceiveNoBuffer , *  PMSNdis_ReceiveNoBuffer ;


extern const GUID MSNdis_CoHardwareStatus_GUID ;


typedef struct _MSNdis_CoHardwareStatus {
	ULONG NdisCoHardwareStatus ;
} MSNdis_CoHardwareStatus , *  PMSNdis_CoHardwareStatus ;


extern const GUID MSNdis_CoMediaSupported_GUID ;


typedef struct _MSNdis_CoMediaSupported {
	ULONG NumberElements ;
	ULONG NdisCoMediaSupported[1] ;
} MSNdis_CoMediaSupported , *  PMSNdis_CoMediaSupported ;


extern const GUID MSNdis_CoMediaInUse_GUID ;


typedef struct _MSNdis_CoMediaInUse {
	ULONG NumberElements ;
	ULONG NdisCoMediaInUse[1] ;
} MSNdis_CoMediaInUse , *  PMSNdis_CoMediaInUse ;


extern const GUID MSNdis_CoLinkSpeed_GUID ;


typedef struct _MSNdis_CoLinkSpeed {
	MSNdis_NetworkLinkSpeed NdisCoLinkSpeed ;
} MSNdis_CoLinkSpeed , *  PMSNdis_CoLinkSpeed ;


extern const GUID MSNdis_CoVendorId_GUID ;


typedef struct _MSNdis_CoVendorId {
	ULONG NdisCoVendorID ;
} MSNdis_CoVendorId , *  PMSNdis_CoVendorId ;


extern const GUID MSNdis_CoVendorDescription_GUID ;


typedef struct _MSNdis_CoVendorDescription {
	CHAR VariableData[1] ;
} MSNdis_CoVendorDescription , *  PMSNdis_CoVendorDescription ;


extern const GUID MSNdis_CoDriverVersion_GUID ;


typedef struct _MSNdis_CoDriverVersion {
	USHORT NdisCoDriverVersion ;
} MSNdis_CoDriverVersion , *  PMSNdis_CoDriverVersion ;


extern const GUID MSNdis_CoMacOptions_GUID ;


typedef struct _MSNdis_CoMacOptions {
	ULONG NdisCoMacOptions ;
} MSNdis_CoMacOptions , *  PMSNdis_CoMacOptions ;


extern const GUID MSNdis_CoMediaConnectStatus_GUID ;


typedef struct _MSNdis_CoMediaConnectStatus {
	ULONG NdisCoMediaConnectStatus ;
} MSNdis_CoMediaConnectStatus , *  PMSNdis_CoMediaConnectStatus ;


extern const GUID MSNdis_CoVendorDriverVersion_GUID ;


typedef struct _MSNdis_CoVendorDriverVersion {
	ULONG NdisCoVendorDriverVersion ;
} MSNdis_CoVendorDriverVersion , *  PMSNdis_CoVendorDriverVersion ;


extern const GUID MSNdis_CoMinimumLinkSpeed_GUID ;


typedef struct _MSNdis_CoMinimumLinkSpeed {
	MSNdis_NetworkLinkSpeed NdisCoMinimumLinkSpeed ;
} MSNdis_CoMinimumLinkSpeed , *  PMSNdis_CoMinimumLinkSpeed ;


extern const GUID MSNdis_CoTransmitPdusOk_GUID ;


typedef struct _MSNdis_CoTransmitPdusOk {
	ULONG NdisCoTransmitPdusOk ;
} MSNdis_CoTransmitPdusOk , *  PMSNdis_CoTransmitPdusOk ;


extern const GUID MSNdis_CoReceivePdusOk_GUID ;


typedef struct _MSNdis_CoReceivePdusOk {
	ULONG NdisCoReceivePdusOk ;
} MSNdis_CoReceivePdusOk , *  PMSNdis_CoReceivePdusOk ;


extern const GUID MSNdis_CoTransmitPduErrors_GUID ;


typedef struct _MSNdis_CoTransmitPduErrors {
	ULONG NdisCoTransmitPduErrors ;
} MSNdis_CoTransmitPduErrors , *  PMSNdis_CoTransmitPduErrors ;


extern const GUID MSNdis_CoReceivePduErrors_GUID ;


typedef struct _MSNdis_CoReceivePduErrors {
	ULONG NdisCoReceivePduErrors ;
} MSNdis_CoReceivePduErrors , *  PMSNdis_CoReceivePduErrors ;


extern const GUID MSNdis_CoReceivePdusNoBuffer_GUID ;


typedef struct _MSNdis_CoReceivePdusNoBuffer {
	ULONG NdisCoReceivePdusNoBuffer ;
} MSNdis_CoReceivePdusNoBuffer , *  PMSNdis_CoReceivePdusNoBuffer ;


extern const GUID MSNdis_AtmSupportedVcRates_GUID ;


typedef struct _MSNdis_AtmSupportedVcRates {
	ULONG MinCellRate ;
	ULONG MaxCellRate ;
} MSNdis_AtmSupportedVcRates , *  PMSNdis_AtmSupportedVcRates ;


extern const GUID MSNdis_AtmSupportedServiceCategory_GUID ;


typedef struct _MSNdis_AtmSupportedServiceCategory {
	ULONG NdisAtmSupportedServiceCategory ;
} MSNdis_AtmSupportedServiceCategory , *  PMSNdis_AtmSupportedServiceCategory ;


extern const GUID MSNdis_AtmSupportedAalTypes_GUID ;


typedef struct _MSNdis_AtmSupportedAalTypes {
	ULONG NdisAtmSupportedAalTypes ;
} MSNdis_AtmSupportedAalTypes , *  PMSNdis_AtmSupportedAalTypes ;


extern const GUID MSNdis_AtmHardwareCurrentAddress_GUID ;


typedef struct _MSNdis_AtmHardwareCurrentAddress {
	MSNdis_NetworkAddress NdisAtmHardwareCurrentAddress ;
} MSNdis_AtmHardwareCurrentAddress , *  PMSNdis_AtmHardwareCurrentAddress ;


extern const GUID MSNdis_AtmMaxActiveVcs_GUID ;


typedef struct _MSNdis_AtmMaxActiveVcs {
	ULONG NdisAtmMaxActiveVcs ;
} MSNdis_AtmMaxActiveVcs , *  PMSNdis_AtmMaxActiveVcs ;


extern const GUID MSNdis_AtmMaxActiveVciBits_GUID ;


typedef struct _MSNdis_AtmMaxActiveVciBits {
	ULONG NdisAtmMaxActiveVciBits ;
} MSNdis_AtmMaxActiveVciBits , *  PMSNdis_AtmMaxActiveVciBits ;


extern const GUID MSNdis_AtmMaxActiveVpiBits_GUID ;


typedef struct _MSNdis_AtmMaxActiveVpiBits {
	ULONG NdisAtmMaxActiveVpiBits ;
} MSNdis_AtmMaxActiveVpiBits , *  PMSNdis_AtmMaxActiveVpiBits ;


extern const GUID MSNdis_AtmMaxAal0PacketSize_GUID ;


typedef struct _MSNdis_AtmMaxAal0PacketSize {
	ULONG NdisAtmMaxAal0PacketSize ;
} MSNdis_AtmMaxAal0PacketSize , *  PMSNdis_AtmMaxAal0PacketSize ;


extern const GUID MSNdis_AtmMaxAal1PacketSize_GUID ;


typedef struct _MSNdis_AtmMaxAal1PacketSize {
	ULONG NdisAtmMaxAal1PacketSize ;
} MSNdis_AtmMaxAal1PacketSize , *  PMSNdis_AtmMaxAal1PacketSize ;


extern const GUID MSNdis_AtmMaxAal34PacketSize_GUID ;


typedef struct _MSNdis_AtmMaxAal34PacketSize {
	ULONG NdisAtmMaxAal34PacketSize ;
} MSNdis_AtmMaxAal34PacketSize , *  PMSNdis_AtmMaxAal34PacketSize ;


extern const GUID MSNdis_AtmMaxAal5PacketSize_GUID ;


typedef struct _MSNdis_AtmMaxAal5PacketSize {
	ULONG NdisAtmMaxAal5PacketSize ;
} MSNdis_AtmMaxAal5PacketSize , *  PMSNdis_AtmMaxAal5PacketSize ;


extern const GUID MSNdis_AtmReceiveCellsOk_GUID ;


typedef struct _MSNdis_AtmReceiveCellsOk {
	ULONGLONG NdisAtmReceiveCellsOk ;
} MSNdis_AtmReceiveCellsOk , *  PMSNdis_AtmReceiveCellsOk ;


extern const GUID MSNdis_AtmTransmitCellsOk_GUID ;


typedef struct _MSNdis_AtmTransmitCellsOk {
	ULONGLONG NdisAtmTransmitCellsOk ;
} MSNdis_AtmTransmitCellsOk , *  PMSNdis_AtmTransmitCellsOk ;


extern const GUID MSNdis_AtmReceiveCellsDropped_GUID ;


typedef struct _MSNdis_AtmReceiveCellsDropped {
	ULONGLONG NdisAtmReceiveCellsDropped ;
} MSNdis_AtmReceiveCellsDropped , *  PMSNdis_AtmReceiveCellsDropped ;


extern const GUID MSNdis_EthernetPermanentAddress_GUID ;


typedef struct _MSNdis_EthernetPermanentAddress {
	MSNdis_NetworkAddress NdisPermanentAddress ;
} MSNdis_EthernetPermanentAddress , *  PMSNdis_EthernetPermanentAddress ;


extern const GUID MSNdis_EthernetCurrentAddress_GUID ;


typedef struct _MSNdis_EthernetCurrentAddress {
	MSNdis_NetworkAddress NdisCurrentAddress ;
} MSNdis_EthernetCurrentAddress , *  PMSNdis_EthernetCurrentAddress ;


extern const GUID MSNdis_EthernetMulticastList_GUID ;


typedef struct _MSNdis_EthernetMulticastList {
	ULONG NumberElements ;
	MSNdis_NetworkAddress NdisMulticastList[1] ;
} MSNdis_EthernetMulticastList , *  PMSNdis_EthernetMulticastList ;


extern const GUID MSNdis_EthernetMaximumMulticastListSize_GUID ;


typedef struct _MSNdis_EthernetMaximumMulticastListSize {
	ULONG NdisEthernetMaximumMulticastListSize ;
} MSNdis_EthernetMaximumMulticastListSize , * 
	PMSNdis_EthernetMaximumMulticastListSize ;


extern const GUID MSNdis_EthernetMacOptions_GUID ;


typedef struct _MSNdis_EthernetMacOptions {
	ULONG NdisEthernetMacOptions ;
} MSNdis_EthernetMacOptions , *  PMSNdis_EthernetMacOptions ;


extern const GUID MSNdis_EthernetReceiveErrorAlignment_GUID ;


typedef struct _MSNdis_EthernetReceiveErrorAlignment {
	ULONG NdisEthernetReceiveErrorAlignment ;
} MSNdis_EthernetReceiveErrorAlignment , * 
	PMSNdis_EthernetReceiveErrorAlignment ;


extern const GUID MSNdis_EthernetOneTransmitCollision_GUID ;


typedef struct _MSNdis_EthernetOneTransmitCollision {
	ULONG NdisEthernetOneTransmitCollision ;
} MSNdis_EthernetOneTransmitCollision , *  PMSNdis_EthernetOneTransmitCollision
	;


extern const GUID MSNdis_EthernetMoreTransmitCollisions_GUID ;


typedef struct _MSNdis_EthernetMoreTransmitCollisions {
	ULONG NdisEthernetMoreTransmitCollisions ;
} MSNdis_EthernetMoreTransmitCollisions , * 
	PMSNdis_EthernetMoreTransmitCollisions ;


extern const GUID MSNdis_TokenRingPermanentAddress_GUID ;


typedef struct _MSNdis_TokenRingPermanentAddress {
	MSNdis_NetworkAddress NdisPermanentAddress ;
} MSNdis_TokenRingPermanentAddress , *  PMSNdis_TokenRingPermanentAddress ;


extern const GUID MSNdis_TokenRingCurrentAddress_GUID ;


typedef struct _MSNdis_TokenRingCurrentAddress {
	MSNdis_NetworkAddress NdisCurrentAddress ;
} MSNdis_TokenRingCurrentAddress , *  PMSNdis_TokenRingCurrentAddress ;


extern const GUID MSNdis_TokenRingCurrentFunctional_GUID ;


typedef struct _MSNdis_TokenRingCurrentFunctional {
	ULONG NdisTokenRingCurrentFunctional ;
} MSNdis_TokenRingCurrentFunctional , *  PMSNdis_TokenRingCurrentFunctional ;


extern const GUID MSNdis_TokenRingCurrentGroup_GUID ;


typedef struct _MSNdis_TokenRingCurrentGroup {
	ULONG NdisTokenRingCurrentGroup ;
} MSNdis_TokenRingCurrentGroup , *  PMSNdis_TokenRingCurrentGroup ;


extern const GUID MSNdis_TokenRingLastOpenStatus_GUID ;


typedef struct _MSNdis_TokenRingLastOpenStatus {
	ULONG NdisTokenRingLastOpenStatus ;
} MSNdis_TokenRingLastOpenStatus , *  PMSNdis_TokenRingLastOpenStatus ;


extern const GUID MSNdis_TokenRingCurrentRingStatus_GUID ;


typedef struct _MSNdis_TokenRingCurrentRingStatus {
	ULONG NdisTokenRingCurrentRingStatus ;
} MSNdis_TokenRingCurrentRingStatus , *  PMSNdis_TokenRingCurrentRingStatus ;


extern const GUID MSNdis_TokenRingCurrentRingState_GUID ;


typedef struct _MSNdis_TokenRingCurrentRingState {
	ULONG NdisTokenRingCurrentRingState ;
} MSNdis_TokenRingCurrentRingState , *  PMSNdis_TokenRingCurrentRingState ;


extern const GUID MSNdis_TokenRingLineErrors_GUID ;


typedef struct _MSNdis_TokenRingLineErrors {
	ULONG NdisTokenRingLineErrors ;
} MSNdis_TokenRingLineErrors , *  PMSNdis_TokenRingLineErrors ;


extern const GUID MSNdis_TokenRingLostFrames_GUID ;


typedef struct _MSNdis_TokenRingLostFrames {
	ULONG NdisTokenRingLostFrames ;
} MSNdis_TokenRingLostFrames , *  PMSNdis_TokenRingLostFrames ;


extern const GUID MSNdis_FddiLongPermanentAddress_GUID ;


typedef struct _MSNdis_FddiLongPermanentAddress {
	MSNdis_NetworkAddress NdisPermanentAddress ;
} MSNdis_FddiLongPermanentAddress , *  PMSNdis_FddiLongPermanentAddress ;


extern const GUID MSNdis_FddiLongCurrentAddress_GUID ;


typedef struct _MSNdis_FddiLongCurrentAddress {
	MSNdis_NetworkAddress NdisCurrentAddress ;
} MSNdis_FddiLongCurrentAddress , *  PMSNdis_FddiLongCurrentAddress ;


extern const GUID MSNdis_FddiLongMulticastList_GUID ;


typedef struct _MSNdis_FddiLongMulticastList {
	ULONG NumberElements ;
	MSNdis_NetworkAddress NdisMulticastList[1] ;
} MSNdis_FddiLongMulticastList , *  PMSNdis_FddiLongMulticastList ;


extern const GUID MSNdis_FddiLongMaximumListSize_GUID ;


typedef struct _MSNdis_FddiLongMaximumListSize {
	ULONG NdisFddiLongMaximumListSize ;
} MSNdis_FddiLongMaximumListSize , *  PMSNdis_FddiLongMaximumListSize ;


extern const GUID MSNdis_FddiShortPermanentAddress_GUID ;


typedef struct _MSNdis_FddiShortPermanentAddress {
	MSNdis_NetworkShortAddress NdisPermanentAddress ;
} MSNdis_FddiShortPermanentAddress , *  PMSNdis_FddiShortPermanentAddress ;


extern const GUID MSNdis_FddiShortCurrentAddress_GUID ;


typedef struct _MSNdis_FddiShortCurrentAddress {
	MSNdis_NetworkShortAddress NdisCurrentAddress ;
} MSNdis_FddiShortCurrentAddress , *  PMSNdis_FddiShortCurrentAddress ;


extern const GUID MSNdis_FddiShortMulticastList_GUID ;


typedef struct _MSNdis_FddiShortMulticastList {
	ULONG NumberElements ;
	MSNdis_NetworkShortAddress NdisMulticastList[1] ;
} MSNdis_FddiShortMulticastList , *  PMSNdis_FddiShortMulticastList ;


extern const GUID MSNdis_FddiShortMaximumListSize_GUID ;


typedef struct _MSNdis_FddiShortMaximumListSize {
	ULONG NdisFddiShortMaximumListSize ;
} MSNdis_FddiShortMaximumListSize , *  PMSNdis_FddiShortMaximumListSize ;


extern const GUID MSNdis_FddiAttachmentType_GUID ;


typedef struct _MSNdis_FddiAttachmentType {
	ULONG NdisFddiAttachmentType ;
} MSNdis_FddiAttachmentType , *  PMSNdis_FddiAttachmentType ;


extern const GUID MSNdis_FddiUpstreamNodeLong_GUID ;


typedef struct _MSNdis_FddiUpstreamNodeLong {
	MSNdis_NetworkAddress NdisFddiUpstreamNodeLong ;
} MSNdis_FddiUpstreamNodeLong , *  PMSNdis_FddiUpstreamNodeLong ;


extern const GUID MSNdis_FddiDownstreamNodeLong_GUID ;


typedef struct _MSNdis_FddiDownstreamNodeLong {
	MSNdis_NetworkAddress NdisFddiDownstreamNodeLong ;
} MSNdis_FddiDownstreamNodeLong , *  PMSNdis_FddiDownstreamNodeLong ;


extern const GUID MSNdis_FddiFrameErrors_GUID ;


typedef struct _MSNdis_FddiFrameErrors {
	ULONG NdisFddiFrameErrors ;
} MSNdis_FddiFrameErrors , *  PMSNdis_FddiFrameErrors ;


extern const GUID MSNdis_FddiFramesLost_GUID ;


typedef struct _MSNdis_FddiFramesLost {
	ULONG NdisFddiFramesLost ;
} MSNdis_FddiFramesLost , *  PMSNdis_FddiFramesLost ;


extern const GUID MSNdis_FddiRingManagmentState_GUID ;


typedef struct _MSNdis_FddiRingManagmentState {
	ULONG NdisFddiRingManagmentState ;
} MSNdis_FddiRingManagmentState , *  PMSNdis_FddiRingManagmentState ;


extern const GUID MSNdis_FddiLctFailures_GUID ;


typedef struct _MSNdis_FddiLctFailures {
	ULONG NdisFddiLctFailures ;
} MSNdis_FddiLctFailures , *  PMSNdis_FddiLctFailures ;


extern const GUID MSNdis_FddiLemRejects_GUID ;


typedef struct _MSNdis_FddiLemRejects {
	ULONG NdisFddiLemRejects ;
} MSNdis_FddiLemRejects , *  PMSNdis_FddiLemRejects ;


extern const GUID MSNdis_FddiLConnectionState_GUID ;


typedef struct _MSNdis_FddiLConnectionState {
	ULONG NdisFddiLConnectionState ;
} MSNdis_FddiLConnectionState , *  PMSNdis_FddiLConnectionState ;


extern const GUID MSNdis_StatusResetStart_GUID ;


typedef struct _MSNdis_StatusResetStart {
	char VariableData[1] ;
} MSNdis_StatusResetStart , *  PMSNdis_StatusResetStart ;


extern const GUID MSNdis_StatusResetEnd_GUID ;


typedef struct _MSNdis_StatusResetEnd {
	char VariableData[1] ;
} MSNdis_StatusResetEnd , *  PMSNdis_StatusResetEnd ;


extern const GUID MSNdis_StatusMediaConnect_GUID ;


typedef struct _MSNdis_StatusMediaConnect {
	char VariableData[1] ;
} MSNdis_StatusMediaConnect , *  PMSNdis_StatusMediaConnect ;


extern const GUID MSNdis_StatusMediaDisconnect_GUID ;


typedef struct _MSNdis_StatusMediaDisconnect {
	char VariableData[1] ;
} MSNdis_StatusMediaDisconnect , *  PMSNdis_StatusMediaDisconnect ;


extern const GUID MSNdis_StatusMediaSpecificIndication_GUID ;


typedef struct _MSNdis_StatusMediaSpecificIndication {
	ULONG NumberElements ;
	UCHAR NdisStatusMediaSpecificIndication[1] ;
} MSNdis_StatusMediaSpecificIndication , * 
	PMSNdis_StatusMediaSpecificIndication ;


extern const GUID MSNdis_StatusLinkSpeedChange_GUID ;


typedef struct _MSNdis_StatusLinkSpeedChange {
	MSNdis_NetworkLinkSpeed NdisStatusLinkSpeedChange ;
} MSNdis_StatusLinkSpeedChange , *  PMSNdis_StatusLinkSpeedChange ;


extern const GUID MSNdis_StatusProtocolBind_GUID ;


typedef struct _MSNdis_StatusProtocolBind {
	CHAR VariableData[1] ;
} MSNdis_StatusProtocolBind , *  PMSNdis_StatusProtocolBind ;


extern const GUID MSNdis_StatusProtocolUnbind_GUID ;


typedef struct _MSNdis_StatusProtocolUnbind {
	CHAR VariableData[1] ;
} MSNdis_StatusProtocolUnbind , *  PMSNdis_StatusProtocolUnbind ;


extern const GUID MSKeyboard_PortInformation_GUID ;


typedef struct _KEYBOARD_PORT_WMI_STD_DATA {
	ULONG ConnectorType ;
	ULONG DataQueueSize ;
	ULONG ErrorCount ;
	ULONG FunctionKeys ;
	ULONG Indicators ;
} KEYBOARD_PORT_WMI_STD_DATA , *  PKEYBOARD_PORT_WMI_STD_DATA ;


extern const GUID MSMouse_PortInformation_GUID ;


typedef struct _POINTER_PORT_WMI_STD_DATA {
	ULONG ConnectorType ;
	ULONG DataQueueSize ;
	ULONG ErrorCount ;
	ULONG Buttons ;
	ULONG HardwareType ;
} POINTER_PORT_WMI_STD_DATA , *  PPOINTER_PORT_WMI_STD_DATA ;


extern const GUID MSMouse_ClassInformation_GUID ;


typedef struct _MSMouse_ClassInformation {
	ULONGLONG DeviceId ;
} MSMouse_ClassInformation , *  PMSMouse_ClassInformation ;


extern const GUID MSKeyboard_ClassInformation_GUID ;


typedef struct _MSKeyboard_ClassInformation {
	ULONGLONG DeviceId ;
} MSKeyboard_ClassInformation , *  PMSKeyboard_ClassInformation ;


extern const GUID MSAcpi_ThermalZoneTemperature_GUID ;


typedef struct _MSAcpi_ThermalZoneTemperature {
	ULONG ThermalStamp ;
	ULONG ThermalConstant1 ;
	ULONG ThermalConstant2 ;
	ULONG Reserved ;
	ULONG SamplingPeriod ;
	ULONG CurrentTemperature ;
	ULONG PassiveTripPoint ;
	ULONG CriticalTripPoint ;
	ULONG ActiveTripPointCount ;
	ULONG ActiveTripPoint[10] ;
} MSAcpi_ThermalZoneTemperature , *  PMSAcpi_ThermalZoneTemperature ;


extern const GUID MSDiskDriver_Geometry_GUID ;


typedef struct _WMI_DISK_GEOMETRY {
	LONGLONG Cylinders ;
	ULONG MediaType ;
	ULONG TracksPerCylinder ;
	ULONG SectorsPerTrack ;
	ULONG BytesPerSector ;
} WMI_DISK_GEOMETRY , *  PWMI_DISK_GEOMETRY ;


extern const GUID MSDiskDriver_PerformanceData_GUID ;


typedef struct _WMI_DISK_PERFORMANCE {
	LONGLONG BytesRead ;
	LONGLONG BytesWritten ;
	LONGLONG ReadTime ;
	LONGLONG WriteTime ;
	LONGLONG IdleTime ;
	ULONG ReadCount ;
	ULONG WriteCount ;
	ULONG QueueDepth ;
	ULONG SplitCount ;
	LONGLONG QueryTime ;
	ULONG StorageDeviceNumber ;
	USHORT StorageManagerName[8] ;
} WMI_DISK_PERFORMANCE , *  PWMI_DISK_PERFORMANCE ;


extern const GUID MSDiskDriver_Performance_GUID ;


typedef struct _MSDiskDriver_Performance {
	WMI_DISK_PERFORMANCE PerfData ;
	CHAR VariableData[1] ;
} MSDiskDriver_Performance , *  PMSDiskDriver_Performance ;


extern const GUID MSStorageDriver_FailurePredictStatus_GUID ;


typedef struct _STORAGE_FAILURE_PREDICT_STATUS {
	ULONG Reason ;
	BOOLEAN PredictFailure ;
} STORAGE_FAILURE_PREDICT_STATUS , *  PSTORAGE_FAILURE_PREDICT_STATUS ;


extern const GUID MSStorageDriver_FailurePredictData_GUID ;


typedef struct _STORAGE_FAILURE_PREDICT_DATA {
	ULONG Length ;
	UCHAR VendorSpecific[512] ;
} STORAGE_FAILURE_PREDICT_DATA , *  PSTORAGE_FAILURE_PREDICT_DATA ;


extern const GUID MSStorageDriver_FailurePredictEvent_GUID ;


typedef struct _STORAGE_FAILURE_PREDICT_EVENT {
	ULONG Length ;
	UCHAR VendorSpecific[1] ;
} STORAGE_FAILURE_PREDICT_EVENT , *  PSTORAGE_FAILURE_PREDICT_EVENT ;


extern const GUID MSStorageDriver_FailurePredictFunction_GUID ;


typedef struct _STORAGE_FAILURE_PREDICT_FUNCTION {
	char VariableData[1] ;
} STORAGE_FAILURE_PREDICT_FUNCTION , *  PSTORAGE_FAILURE_PREDICT_FUNCTION ;


extern const GUID MSIde_PortDeviceInfo_GUID ;


typedef struct _MSIde_PortDeviceInfo {
	UCHAR Bus ;
	UCHAR Target ;
	UCHAR Lun ;
} MSIde_PortDeviceInfo , *  PMSIde_PortDeviceInfo ;


extern const GUID MSSerial_PortName_GUID ;


typedef struct _MSSerial_PortName {
	CHAR VariableData[1] ;
} MSSerial_PortName , *  PMSSerial_PortName ;


extern const GUID MSSerial_CommInfo_GUID ;


typedef struct _SERIAL_WMI_COMM_DATA {
	ULONG BaudRate ;
	ULONG BitsPerByte ;
	ULONG Parity ;
	BOOLEAN ParityCheckEnable ;
	ULONG StopBits ;
	ULONG XoffCharacter ;
	ULONG XoffXmitThreshold ;
	ULONG XonCharacter ;
	ULONG XonXmitThreshold ;
	ULONG MaximumBaudRate ;
	ULONG MaximumOutputBufferSize ;
	ULONG MaximumInputBufferSize ;
	BOOLEAN Support16BitMode ;
	BOOLEAN SupportDTRDSR ;
	BOOLEAN SupportIntervalTimeouts ;
	BOOLEAN SupportParityCheck ;
	BOOLEAN SupportRTSCTS ;
	BOOLEAN SupportXonXoff ;
	BOOLEAN SettableBaudRate ;
	BOOLEAN SettableDataBits ;
	BOOLEAN SettableFlowControl ;
	BOOLEAN SettableParity ;
	BOOLEAN SettableParityCheck ;
	BOOLEAN SettableStopBits ;
	BOOLEAN IsBusy ;
} SERIAL_WMI_COMM_DATA , *  PSERIAL_WMI_COMM_DATA ;


extern const GUID MSSerial_HardwareConfiguration_GUID ;


typedef struct _SERIAL_WMI_HW_DATA {
	ULONG IrqNumber ;
	ULONG IrqVector ;
	ULONG IrqLevel ;
	ULONG IrqAffinityMask ;
	ULONG InterruptType ;
	ULONGLONG BaseIOAddress ;
} SERIAL_WMI_HW_DATA , *  PSERIAL_WMI_HW_DATA ;


extern const GUID MSSerial_PerformanceInformation_GUID ;


typedef struct _SERIAL_WMI_PERF_DATA {
	ULONG ReceivedCount ;
	ULONG TransmittedCount ;
	ULONG FrameErrorCount ;
	ULONG SerialOverrunErrorCount ;
	ULONG BufferOverrunErrorCount ;
	ULONG ParityErrorCount ;
} SERIAL_WMI_PERF_DATA , *  PSERIAL_WMI_PERF_DATA ;


extern const GUID MSSerial_CommProperties_GUID ;


typedef struct _SERIAL_WMI_COMMPROP {
	USHORT wPacketLength ;
	USHORT wPacketVersion ;
	ULONG dwServiceMask ;
	ULONG dwReserved1 ;
	ULONG dwMaxTxQueue ;
	ULONG dwMaxRxQueue ;
	ULONG dwMaxBaud ;
	ULONG dwProvSubType ;
	ULONG dwProvCapabilities ;
	ULONG dwSettableParams ;
	ULONG dwSettableBaud ;
	USHORT wSettableData ;
	USHORT wSettableStopParity ;
	ULONG dwCurrentTxQueue ;
	ULONG dwCurrentRxQueue ;
	ULONG dwProvSpec1 ;
	ULONG dwProvSpec2 ;
	ULONG dwProvCharSize ;
	UCHAR wcProvChar[1] ;
} SERIAL_WMI_COMMPROP , *  PSERIAL_WMI_COMMPROP ;


extern const GUID MSParallel_AllocFreeCounts_GUID ;


typedef struct _PARPORT_WMI_ALLOC_FREE_COUNTS {
	ULONG PortAllocates ;
	ULONG PortFrees ;
} PARPORT_WMI_ALLOC_FREE_COUNTS , *  PPARPORT_WMI_ALLOC_FREE_COUNTS ;


extern const GUID MSParallel_DeviceBytesTransferred_GUID ;


typedef struct _PARALLEL_WMI_LOG_INFO {
	ULONG Flags1 ;
	ULONG Flags2 ;
	ULONG spare[2] ;
	LONGLONG SppWriteCount ;
	LONGLONG NibbleReadCount ;
	LONGLONG BoundedEcpWriteCount ;
	LONGLONG BoundedEcpReadCount ;
	LONGLONG HwEcpWriteCount ;
	LONGLONG HwEcpReadCount ;
	LONGLONG SwEcpWriteCount ;
	LONGLONG SwEcpReadCount ;
	LONGLONG HwEppWriteCount ;
	LONGLONG HwEppReadCount ;
	LONGLONG SwEppWriteCount ;
	LONGLONG SwEppReadCount ;
	LONGLONG ByteReadCount ;
	LONGLONG ChannelNibbleReadCount ;
} PARALLEL_WMI_LOG_INFO , *  PPARALLEL_WMI_LOG_INFO ;


extern const GUID MSRedbook_DriverInformationGuid ;


typedef struct _REDBOOK_WMI_STD_DATA {
	ULONG NumberOfBuffers ;
	ULONG SectorsPerRead ;
	ULONG SectorsPerReadMask ;
	ULONG MaximumSectorsPerRead ;
	BOOLEAN PlayEnabled ;
	BOOLEAN CDDASupported ;
	BOOLEAN CDDAAccurate ;
	BOOLEAN Reserved1 ;
} REDBOOK_WMI_STD_DATA , *  PREDBOOK_WMI_STD_DATA ;


extern const GUID MSRedbook_PerformanceGuid ;


typedef struct _REDBOOK_WMI_PERF_DATA {
	LONGLONG TimeReadDelay ;
	LONGLONG TimeReading ;
	LONGLONG TimeStreamDelay ;
	LONGLONG TimeStreaming ;
	LONGLONG DataProcessed ;
	ULONG StreamPausedCount ;
} REDBOOK_WMI_PERF_DATA , *  PREDBOOK_WMI_PERF_DATA ;


extern const GUID RegisteredGuids_GUID ;


typedef struct _RegisteredGuids {
	ULONG GuidType ;
	ULONG LoggerId ;
	ULONG EnableLevel ;
	ULONG EnableFlags ;
	BOOLEAN IsEnabled ;
} RegisteredGuids , *  PRegisteredGuids ;



#pragma once

typedef NTSTATUS ( *  PI8042_SYNCH_READ_PORT )(PVOID Context , PUCHAR Value ,
	BOOLEAN WaitForACK ) ;


typedef NTSTATUS ( *  PI8042_SYNCH_WRITE_PORT )(PVOID Context , UCHAR Value ,
	BOOLEAN WaitForACK ) ;


typedef void ( *  PI8042_ISR_WRITE_PORT )(PVOID Context , UCHAR Value ) ;


typedef void ( *  PI8042_QUEUE_PACKET )(PVOID Context ) ;


typedef enum _TRANSMIT_STATE {
	Idle = 0,
	SendingBytes
} TRANSMIT_STATE ;


typedef struct _OUTPUT_PACKET {
	PUCHAR Bytes ;
	ULONG CurrentByte ;
	ULONG ByteCount ;
	TRANSMIT_STATE State ;
} OUTPUT_PACKET , *  POUTPUT_PACKET ;

typedef enum _MOUSE_STATE {
	MouseIdle,
	XMovement,
	YMovement,
	ZMovement,
	MouseExpectingACK,
	MouseResetting
} MOUSE_STATE , *  PMOUSE_STATE ;


typedef enum _MOUSE_RESET_SUBSTATE {
	ExpectingReset = 0,
	ExpectingResetId,
	ExpectingGetDeviceIdACK,
	ExpectingGetDeviceIdValue,
	ExpectingSetResolutionDefaultACK,
	ExpectingSetResolutionDefaultValueACK,
	ExpectingSetResolutionACK,
	ExpectingSetResolutionValueACK,
	ExpectingSetScaling1to1ACK,
	ExpectingSetScaling1to1ACK2,
	ExpectingSetScaling1to1ACK3,
	ExpectingReadMouseStatusACK,
	ExpectingReadMouseStatusByte1,
	ExpectingReadMouseStatusByte2,
	ExpectingReadMouseStatusByte3,
	StartPnPIdDetection,
	ExpectingLoopSetSamplingRateACK,
	ExpectingLoopSetSamplingRateValueACK,
	ExpectingPnpIdByte1,
	ExpectingPnpIdByte2,
	ExpectingPnpIdByte3,
	ExpectingPnpIdByte4,
	ExpectingPnpIdByte5,
	ExpectingPnpIdByte6,
	ExpectingPnpIdByte7,
	EnableWheel,
	Enable5Buttons,
	ExpectingGetDeviceId2ACK,
	ExpectingGetDeviceId2Value,
	ExpectingSetSamplingRateACK,
	ExpectingSetSamplingRateValueACK,
	ExpectingEnableACK,
	ExpectingFinalResolutionACK,
	ExpectingFinalResolutionValueACK,
	CustomHookStateMinimum = 100,
	CustomHookStateMaximum = 999,
	I8042ReservedMinimum = 1000
} MOUSE_RESET_SUBSTATE , *  PMOUSE_RESET_SUBSTATE ;


typedef BOOLEAN ( *  PI8042_MOUSE_ISR )(PVOID IsrContext , PMOUSE_INPUT_DATA
	CurrentInput , POUTPUT_PACKET CurrentOutput , UCHAR StatusByte , PUCHAR
	Byte , PBOOLEAN ContinueProcessing , PMOUSE_STATE MouseState ,
	PMOUSE_RESET_SUBSTATE ResetSubState ) ;


typedef struct _INTERNAL_I8042_HOOK_MOUSE {
	PVOID Context ;
	PI8042_MOUSE_ISR IsrRoutine ;
	PI8042_ISR_WRITE_PORT IsrWritePort ;
	PI8042_QUEUE_PACKET QueueMousePacket ;
	PVOID CallContext ;
} INTERNAL_I8042_HOOK_MOUSE , *  PINTERNAL_I8042_HOOK_MOUSE ;


typedef enum _KEYBOARD_SCAN_STATE {
	Normal,
	GotE0,
	GotE1
} KEYBOARD_SCAN_STATE , *  PKEYBOARD_SCAN_STATE ;

typedef NTSTATUS ( *  PI8042_KEYBOARD_INITIALIZATION_ROUTINE )(PVOID
	InitializationContext , PVOID SynchFuncContext , PI8042_SYNCH_READ_PORT
	ReadPort , PI8042_SYNCH_WRITE_PORT WritePort , PBOOLEAN
	TurnTranslationOn ) ;


typedef BOOLEAN ( *  PI8042_KEYBOARD_ISR )(PVOID IsrContext ,
	PKEYBOARD_INPUT_DATA CurrentInput , POUTPUT_PACKET CurrentOutput , UCHAR
	StatusByte , PUCHAR Byte , PBOOLEAN ContinueProcessing ,
	PKEYBOARD_SCAN_STATE ScanState ) ;


typedef struct _INTERNAL_I8042_HOOK_KEYBOARD {
	PVOID Context ;
	PI8042_KEYBOARD_INITIALIZATION_ROUTINE InitializationRoutine ;
	PI8042_KEYBOARD_ISR IsrRoutine ;
	PI8042_ISR_WRITE_PORT IsrWritePort ;
	PI8042_QUEUE_PACKET QueueKeyboardPacket ;
	PVOID CallContext ;
} INTERNAL_I8042_HOOK_KEYBOARD , *  PINTERNAL_I8042_HOOK_KEYBOARD ;


typedef struct _INTERNAL_I8042_START_INFORMATION {
	ULONG Size ;
	PKINTERRUPT InterruptObject ;
	ULONG Reserved[8] ;
} INTERNAL_I8042_START_INFORMATION , *  PINTERNAL_I8042_START_INFORMATION ;


typedef struct _DEVICE_EXTENSION {
	PDEVICE_OBJECT Self ;
	PDEVICE_OBJECT PDO ;
	PDEVICE_OBJECT TopOfStack ;
	LONG EnableCount ;
	CONNECT_DATA UpperConnectData ;
	PVOID UpperContext ;
	PI8042_KEYBOARD_INITIALIZATION_ROUTINE UpperInitializationRoutine ;
	PI8042_KEYBOARD_ISR UpperIsrHook ;
	PI8042_ISR_WRITE_PORT IsrWritePort ;
	PI8042_QUEUE_PACKET QueueKeyboardPacket ;
	PVOID CallContext ;
	DEVICE_POWER_STATE DeviceState ;
	BOOLEAN Started ;
	BOOLEAN SurpriseRemoved ;
	BOOLEAN Removed ;
} DEVICE_EXTENSION , *  PDEVICE_EXTENSION ;


NTSTATUS KbFilter_AddDevice(PDRIVER_OBJECT DriverObject , PDEVICE_OBJECT
	BusDeviceObject ) ;

NTSTATUS KbFilter_CreateClose(PDEVICE_OBJECT DeviceObject ) ;

NTSTATUS KbFilter_DispatchPassThrough(PDEVICE_OBJECT DeviceObject ) ;

NTSTATUS KbFilter_InternIoCtl(PDEVICE_OBJECT DeviceObject ) ;

NTSTATUS KbFilter_IoCtl(PDEVICE_OBJECT DeviceObject ) { return 0;}

NTSTATUS KbFilter_PnP(PDEVICE_OBJECT DeviceObject ) ;

NTSTATUS KbFilter_Power(PDEVICE_OBJECT DeviceObject  ) ;

NTSTATUS KbFilter_InitializationRoutine(PDEVICE_OBJECT DeviceObject , PVOID
	SynchFuncContext , PI8042_SYNCH_READ_PORT ReadPort ,
	PI8042_SYNCH_WRITE_PORT WritePort , PBOOLEAN TurnTranslationOn ) ;

BOOLEAN KbFilter_IsrHook(PDEVICE_OBJECT DeviceObject , PKEYBOARD_INPUT_DATA
	CurrentInput , POUTPUT_PACKET CurrentOutput , UCHAR StatusByte , PUCHAR
	DataByte , PBOOLEAN ContinueProcessing , PKEYBOARD_SCAN_STATE ScanState
	) ;

void KbFilter_ServiceCallback(PDEVICE_OBJECT DeviceObject , PKEYBOARD_INPUT_DATA
	InputDataStart , PKEYBOARD_INPUT_DATA InputDataEnd , PULONG
	InputDataConsumed ) ;

void KbFilter_Unload(PDRIVER_OBJECT DriverObject ) ;

NTSTATUS DriverEntry(PDRIVER_OBJECT , PUNICODE_STRING ) ;



#pragma alloc_text(INIT, DriverEntry)


#pragma alloc_text(PAGE, KbFilter_AddDevice)


#pragma alloc_text(PAGE, KbFilter_CreateClose)


#pragma alloc_text(PAGE, KbFilter_IoCtl)


#pragma alloc_text(PAGE, KbFilter_InternIoCtl)


#pragma alloc_text(PAGE, KbFilter_Unload)


#pragma alloc_text(PAGE, KbFilter_DispatchPassThrough)


#pragma alloc_text(PAGE, KbFilter_PnP)


#pragma alloc_text(PAGE, KbFilter_Power)


int s ;
#define	UNLOADED  0
#define	NP  1
#define	DC  2
#define	SKIP1  3
#define	SKIP2  4
#define	MPR1  5
#define	MPR3  6
#define	IPC  7


int pended ;
PIO_COMPLETION_ROUTINE compFptr ;
int compRegistered ;
int lowerDriverReturn ;
int setEventCalled ;
int customIrp ;
int myStatus ;

IRP girp;

void _BLAST_init()
{
	
	
	s = UNLOADED;
	pended = 0;
	compFptr = 0;
	compRegistered = 0;
	lowerDriverReturn = 0;
	setEventCalled = 0;
	customIrp = 0;
}


NTSTATUS DriverEntry(PDRIVER_OBJECT DriverObject , PUNICODE_STRING RegistryPath
	)
{
	
	ULONG i ;
	
	RegistryPath;
	
	//for(i = 0; i < 0x1b; i++)
	{
		
	  //(DriverObject->MajorFunction)[i] = KbFilter_DispatchPassThrough;
	}
	
	(DriverObject->MajorFunction)[0x00] = KbFilter_CreateClose;
	(DriverObject->MajorFunction)[0x02] = KbFilter_CreateClose;
	(DriverObject->MajorFunction)[0x1b] = KbFilter_PnP;
	(DriverObject->MajorFunction)[0x16] = KbFilter_Power;
	(DriverObject->MajorFunction)[0x0f] = KbFilter_InternIoCtl;
	
	DriverObject->DriverUnload = KbFilter_Unload;
	(DriverObject->DriverExtension)->AddDevice = KbFilter_AddDevice;
	
	return (NTSTATUS )0x00000000L;
}

NTSTATUS KbFilter_AddDevice(PDRIVER_OBJECT Driver , PDEVICE_OBJECT PDO )
{
	
	PDEVICE_EXTENSION devExt ;
	IO_ERROR_LOG_PACKET errorLogEntry ;
	PDEVICE_OBJECT device ;
	NTSTATUS status = (NTSTATUS )0x00000000L;
	
	;
	
	status = IoCreateDevice(Driver, sizeof(DEVICE_EXTENSION ), (void *  )0,
		0x0000000b, 0, 0, & device);
	
	if(! ((NTSTATUS )status >= 0))
	{
		
		return status;
	}
	
	memset(device->DeviceExtension, 0, sizeof(DEVICE_EXTENSION ));
	
	devExt = (PDEVICE_EXTENSION )device->DeviceExtension;
	devExt->TopOfStack = IoAttachDeviceToDeviceStack(device, PDO);
	
	;
	
	devExt->Self = device;
	devExt->PDO = PDO;
	devExt->DeviceState = PowerDeviceD0;
	
	devExt->SurpriseRemoved = 0;
	devExt->Removed = 0;
	devExt->Started = 0;
	
	device->Flags |= 0x00000004 | 0x00002000;
	device->Flags &= ~ 0x00000080;
	
	return status;
}

NTSTATUS KbFilter_Complete(PDEVICE_OBJECT DeviceObject , PVOID
	Context )
{
	
	PKEVENT event ;
	
	event = (PKEVENT )Context;
	
	DeviceObject;
	//Irp;
	
	KeSetEvent(event, 0, 0);
	
	return (NTSTATUS )0xC0000016L;
}

NTSTATUS KbFilter_CreateClose(PDEVICE_OBJECT DeviceObject )
{
	
	PIO_STACK_LOCATION irpStack ;
	NTSTATUS status ;
	PDEVICE_EXTENSION devExt ;
	;
	
	irpStack = ((girp.Tail).Overlay).CurrentStackLocation;
	devExt = (PDEVICE_EXTENSION )DeviceObject->DeviceExtension;
	
	status = (girp.IoStatus).Status;
	status = myStatus;
	
	switch(irpStack->MajorFunction)
	{
		
	case 0x00:
			
			;
		
		if((void *  )0 == (devExt->UpperConnectData).ClassService)
		{
			
			status = (NTSTATUS )0xC0000184L;
		}
		else
		{
			
			if(1 == InterlockedIncrement(& devExt->EnableCount))
			{
			}
			else
			{
			}
		}
		
		break;
		
	case 0x02:
			
			;
		
		if(0 == InterlockedDecrement(& devExt->EnableCount))
		{
		}
		
		break;
	}
	
	(girp.IoStatus).Status = status;
	myStatus = status;
	
	return KbFilter_DispatchPassThrough(DeviceObject);
}

NTSTATUS KbFilter_DispatchPassThrough(PDEVICE_OBJECT DeviceObject )
{
	
	PIO_STACK_LOCATION irpStack
		= ((girp.Tail).Overlay).CurrentStackLocation;
	
	if(s == NP)
		
		s = SKIP1;
	else
		
		//assert(0); //the only

	girp.CurrentLocation++;
	
	((girp.Tail).Overlay).CurrentStackLocation++;
	
	;
	
	return IofCallDriver(((PDEVICE_EXTENSION
		)DeviceObject->DeviceExtension)->TopOfStack);
}


NTSTATUS KbFilter_InternIoCtl(PDEVICE_OBJECT DeviceObject)
{
	
	PIO_STACK_LOCATION irpStack ;
	PDEVICE_EXTENSION devExt ;
	PINTERNAL_I8042_HOOK_KEYBOARD hookKeyboard ;
	KEVENT event ;
	PCONNECT_DATA connectData ;
	NTSTATUS status = (NTSTATUS )0x00000001L; //change initialization of a variable (probably, irrelevant)
	
	devExt = (PDEVICE_EXTENSION )DeviceObject->DeviceExtension;
	(girp.IoStatus).Information = 0;
	irpStack = ((girp.Tail).Overlay).CurrentStackLocation;
	
	switch(((irpStack->Parameters).DeviceIoControl).IoControlCode)
	{
		
	case 0x0000000b << 16 | 0 << 14 | 0x0080 << 2 | 3:
			
			;
		
		if((devExt->UpperConnectData).ClassService != (void *  )0)
		{
			
			status = (NTSTATUS )0xC0000043L;
			break;
		}
		else
		{
			
			if(((irpStack->Parameters).DeviceIoControl).InputBufferLength
				< sizeof(CONNECT_DATA ))
			{
				
				status = (NTSTATUS )0xC000000DL;
				break;
			}
		}
		
		connectData = (PCONNECT_DATA
			)((irpStack->Parameters).DeviceIoControl).Type3InputBuffer
			;
		devExt->UpperConnectData = * connectData;
		
		connectData->ClassDeviceObject = devExt->Self;
		connectData->ClassService = KbFilter_ServiceCallback;
		
		break;
		
	case 0x0000000b << 16 | 0 << 14 | 0x0100 << 2 | 3:
			
			;
		
		status = (NTSTATUS )0xC0000002L;
		break;
		
	case 0x0000000b << 16 | 0 << 14 | 0x0FF0 << 2 | 3:
			
			;
		;
		if(((irpStack->Parameters).DeviceIoControl).InputBufferLength <
			sizeof(INTERNAL_I8042_HOOK_KEYBOARD ))
		{
			
			;
			
			status = (NTSTATUS )0xC000000DL;
			break;
		}
		hookKeyboard = (PINTERNAL_I8042_HOOK_KEYBOARD
			)((irpStack->Parameters).DeviceIoControl).Type3InputBuffer
			;
		
		devExt->UpperContext = hookKeyboard->Context;
		
		hookKeyboard->Context = (PVOID )DeviceObject;
		
		if(hookKeyboard->InitializationRoutine)
		{
			
			devExt->UpperInitializationRoutine =
				hookKeyboard->InitializationRoutine;
		}
		hookKeyboard->InitializationRoutine =
			(PI8042_KEYBOARD_INITIALIZATION_ROUTINE
			)KbFilter_InitializationRoutine;
		
		if(hookKeyboard->IsrRoutine)
		{
			
			devExt->UpperIsrHook = hookKeyboard->IsrRoutine;
		}
		hookKeyboard->IsrRoutine = (PI8042_KEYBOARD_ISR
			)KbFilter_IsrHook;
		
		devExt->IsrWritePort = hookKeyboard->IsrWritePort;
		devExt->QueueKeyboardPacket = hookKeyboard->QueueKeyboardPacket;
		devExt->CallContext = hookKeyboard->CallContext;
		
		status = (NTSTATUS )0x00000000L;
		break;
		
	case 0x0000000b << 16 | 0 << 14 | 0x0000 << 2 | 0:
			
			;
	case 0x0000000b << 16 | 0 << 14 | 0x0020 << 2 | 0:
			
			;
	case 0x0000000b << 16 | 0 << 14 | 0x0010 << 2 | 0:
			
			;
	case 0x0000000b << 16 | 0 << 14 | 0x0002 << 2 | 0:
			
			;
	case 0x0000000b << 16 | 0 << 14 | 0x0008 << 2 | 0:
			
			;
	case 0x0000000b << 16 | 0 << 14 | 0x0001 << 2 | 0:
			
			;
		break;
	}
	
	if(! ((NTSTATUS )status >= 0))
	{
		
		(girp.IoStatus).Status = status;
		myStatus = status;
		//IofCompleteRequest(0);
		return status;
	}
	
	return KbFilter_DispatchPassThrough(DeviceObject);
}

NTSTATUS KbFilter_PnP(PDEVICE_OBJECT DeviceObject)
{
	
	PDEVICE_EXTENSION devExt ;
	PIO_STACK_LOCATION irpStack ;
	NTSTATUS status = (NTSTATUS )0x00000000L;
	KIRQL oldIrql ;
	KEVENT event ;
	;
	
	devExt = (PDEVICE_EXTENSION )DeviceObject->DeviceExtension;
	irpStack = ((girp.Tail).Overlay).CurrentStackLocation;
	
	switch(irpStack->MinorFunction)
	{
		
	case 0x00:
			
			;
		{
			{
				
				PIO_STACK_LOCATION irpSp ;
				
				PIO_STACK_LOCATION nextIrpSp ;
				
				irpSp =
					((girp.Tail).Overlay).CurrentStackLocation;
				
				nextIrpSp =
					((girp.Tail).Overlay).CurrentStackLocation
					- 1;
				
				memcpy(nextIrpSp, irpSp, (LONG )((LONG_PTR )(&
					((IO_STACK_LOCATION * 
					)0)->CompletionRoutine)));
				
				nextIrpSp->Control = 0;
			}
			
			;
			KeInitializeEvent(& event, NotificationEvent, 0);
			
			if(s != NP)
				
				;//assert(0);
			else
			{
				
				if(compRegistered != 0)
					
					;//assert(0); //BUG in FF
				else
				{
					
					compRegistered = 1;
					compFptr = KbFilter_Complete;
				}
			}
			{
				
				PIO_STACK_LOCATION irpSp ;
				
				;
				
				irpSp =
					((girp.Tail).Overlay).CurrentStackLocation
					- 1;
				
				irpSp->CompletionRoutine =
					(PIO_COMPLETION_ROUTINE
					)KbFilter_Complete;
				
				irpSp->Context = & event;
				
				irpSp->Control = 0;
				
				if(1)
				{
					
					irpSp->Control = 0x40;
				}
				
				if(1)
				{
					
					irpSp->Control |= 0x80;
				}
				
				if(1)
				{
					
					irpSp->Control |= 0x20;
				}
			}
			
			;
			
			status = IofCallDriver(devExt->TopOfStack);
			
			if((NTSTATUS )0x00000103L == status)
			{
				
				KeWaitForSingleObject(& event, Executive,
					KernelMode, 0, (void *  )0);
			}
			
			if((NTSTATUS )status >= 0 && (NTSTATUS )myStatus >= 0)
			{
				
				devExt->Started = 1;
				devExt->Removed = 0;
				devExt->SurpriseRemoved = 0;
			}
			
			(girp.IoStatus).Status = status;
			myStatus = status;
			(girp.IoStatus).Information = 0;
		if(s == NP)
			
			s = SKIP1;
		else
			{
			assert(0);
			IofCompleteRequest( 0);}
			
			break;
		}
		
	case 0x17:
			
			;
		
		devExt->SurpriseRemoved = 1;
		
		if(s == NP)
			
			s = SKIP1;
		else
			
			;//assert(0);
		girp.CurrentLocation++;
		
		((girp.Tail).Overlay).CurrentStackLocation++;
		
		;
		status = IofCallDriver(devExt->TopOfStack);
		break;
		
	case 0x02:
			
			;
		
		devExt->Removed = 1;
		
		if(s == NP)
			
			s = SKIP1;
		else
			
			;//assert(0);
		girp.CurrentLocation++;
		
		((girp.Tail).Overlay).CurrentStackLocation++;
		
		;
		IofCallDriver(devExt->TopOfStack);
		
		IoDetachDevice(devExt->TopOfStack);
		IoDeleteDevice(DeviceObject);
		
		status = (NTSTATUS )0x00000000L;
		break;
		
	case 0x01:
			
			;
	case 0x05:
			
			;
	case 0x03:
			
			;
	case 0x06:
			
			;
	case 0x0D:
			
			;
	case 0x04:
			
			;
	case 0x07:
			
			;
	case 0x08:
			
			;
	case 0x09:
			
			;
	case 0x0C:
			
			;
	case 0x0A:
			
			;
	case 0x0B:
			
			;
	case 0x0F:
			
			;
	case 0x10:
			
			;
	case 0x11:
			
			;
	case 0x12:
			
			;
	case 0x13:
			
			;
	case 0x14:
			
			;
	default :
			
			;
		
		if(s == NP)
			
			s = SKIP1;
		else
			
			;//assert(0);
		girp.CurrentLocation++;
		
		((girp.Tail).Overlay).CurrentStackLocation++;
		
		;
		status = IofCallDriver(devExt->TopOfStack);
		break;
	}
	
	return status;
}

NTSTATUS KbFilter_Power(PDEVICE_OBJECT DeviceObject )
{
	
	PIO_STACK_LOCATION irpStack ;
	PDEVICE_EXTENSION devExt ;
	POWER_STATE powerState ;
	POWER_STATE_TYPE powerType ;
	
	;
	
	devExt = (PDEVICE_EXTENSION )DeviceObject->DeviceExtension;
	irpStack = ((girp.Tail).Overlay).CurrentStackLocation;
	
	powerType = ((irpStack->Parameters).Power).Type;
	powerState = ((irpStack->Parameters).Power).State;
	
	switch(irpStack->MinorFunction)
	{
		
	case 0x02:
			
			;
		if(powerType == DevicePowerState)
		{
			
			devExt->DeviceState = powerState.DeviceState;
		}
		
	case 0x01:
			
			;
	case 0x00:
			
			;
	case 0x03:
			
			;
	default :
			
			;
		break;
	}
	
	PoStartNextPowerIrp();
	
	if(s == NP)
		
		s = SKIP1;
	else
		
		;//assert(0);
	girp.CurrentLocation++;
	
	((girp.Tail).Overlay).CurrentStackLocation++;
	
	;
	return PoCallDriver(devExt->TopOfStack);
}

NTSTATUS KbFilter_InitializationRoutine(PDEVICE_OBJECT DeviceObject , PVOID
	SynchFuncContext , PI8042_SYNCH_READ_PORT ReadPort ,
	PI8042_SYNCH_WRITE_PORT WritePort , PBOOLEAN TurnTranslationOn )
{
	
	PDEVICE_EXTENSION devExt ;
	NTSTATUS status = (NTSTATUS )0x00000000L;
	
	devExt = DeviceObject->DeviceExtension;
	
	if(devExt->UpperInitializationRoutine)
	{
		
		status = (*
			devExt->UpperInitializationRoutine)(devExt->UpperContext,
			SynchFuncContext, ReadPort, WritePort,
			TurnTranslationOn);
		
		if(! ((NTSTATUS )status >= 0))
		{
			
			return status;
		}
	}
	
	* TurnTranslationOn = 1;
	return status;
}

BOOLEAN KbFilter_IsrHook(PDEVICE_OBJECT DeviceObject , PKEYBOARD_INPUT_DATA
	CurrentInput , POUTPUT_PACKET CurrentOutput , UCHAR StatusByte , PUCHAR
	DataByte , PBOOLEAN ContinueProcessing , PKEYBOARD_SCAN_STATE ScanState
	)
{
	
	PDEVICE_EXTENSION devExt ;
	BOOLEAN retVal = 1;
	
	devExt = DeviceObject->DeviceExtension;
	
	if(devExt->UpperIsrHook)
	{
		
		retVal = (* devExt->UpperIsrHook)(devExt->UpperContext,
			CurrentInput, CurrentOutput, StatusByte, DataByte,
			ContinueProcessing, ScanState);
		
		if(! retVal || ! * ContinueProcessing)
		{
			
			return retVal;
		}
	}
	
	* ContinueProcessing = 1;
	return retVal;
}

void KbFilter_ServiceCallback(PDEVICE_OBJECT DeviceObject , PKEYBOARD_INPUT_DATA
	InputDataStart , PKEYBOARD_INPUT_DATA InputDataEnd , PULONG
	InputDataConsumed )
{
	
	PDEVICE_EXTENSION devExt ;
	
	devExt = (PDEVICE_EXTENSION )DeviceObject->DeviceExtension;
	
	(* (PSERVICE_CALLBACK_ROUTINE
		)(devExt->UpperConnectData).ClassService)((devExt->UpperConnectData
		).ClassDeviceObject, InputDataStart, InputDataEnd,
		InputDataConsumed);
}


void KbFilter_Unload(PDRIVER_OBJECT Driver )
{
	
	;
	
	Driver;
	
	;
}



#pragma once


#pragma pack(push, 8)

typedef enum _EXCEPTION_DISPOSITION ;


struct _EXCEPTION_RECORD ;


struct _CONTEXT ;



#pragma pack(pop)


#pragma once


#pragma once

typedef unsigned short ;


typedef wchar_t ;


typedef wchar_t ;


typedef unsigned long ;



#pragma once

typedef int ;


typedef int ;


typedef unsigned int ;


typedef unsigned int ;


typedef unsigned int ;


typedef int ;


typedef unsigned int ;

typedef long ;


typedef unsigned long ;


typedef unsigned short ;


typedef short ;


typedef unsigned long ;


typedef ULONG_PTR ;


typedef LONG_PTR ;


typedef ULONG_PTR ;


typedef __int64 ;


typedef __int64 ;


typedef unsigned __int64 ;


typedef unsigned __int64 ;


typedef unsigned __int64 ;


typedef void ;


typedef void ;


typedef char ;


typedef short ;


typedef long ;


typedef wchar_t ;


typedef WCHAR ;


typedef WCHAR ;


typedef const WCHAR ;


typedef WCHAR ;


typedef WCHAR ;

typedef const WCHAR ;


typedef CHAR ;


typedef CHAR ;

typedef const CHAR ;


typedef CHAR ;


typedef CHAR ;


typedef const CHAR ;


typedef char ;


typedef unsigned char ;


typedef LPSTR ;


typedef LPSTR ;


typedef LPCSTR ;


typedef double ;

typedef struct _QUAD ;


typedef SHORT ;


typedef LONG ;


typedef QUAD ;


typedef unsigned char ;


typedef unsigned short ;


typedef unsigned long ;


typedef QUAD ;


typedef UCHAR ;


typedef USHORT ;


typedef ULONG ;


typedef UQUAD ;


typedef signed char ;


typedef SCHAR ;


typedef void ;


typedef HANDLE ;


typedef UCHAR ;


typedef USHORT ;


typedef ULONG ;


typedef LONG ;


typedef char ;


typedef short ;


typedef ULONG ;

typedef CCHAR ;


typedef CSHORT ;


typedef CLONG ;


typedef ULONG ;


typedef PULONG ;


typedef USHORT ;


typedef ULONG ;


typedef ULONG ;


typedef LONG ;

typedef NTSTATUS ;


typedef struct _FLOAT128 ;


typedef FLOAT128 ;


typedef __int64 ;


typedef unsigned __int64 ;


typedef LONGLONG ;


typedef ULONGLONG ;


typedef LONGLONG ;


typedef union _LARGE_INTEGER ;


typedef LARGE_INTEGER ;


typedef union _ULARGE_INTEGER ;


typedef ULARGE_INTEGER ;


typedef struct _LUID ;


typedef ULONGLONG ;


typedef DWORDLONG ;


typedef LARGE_INTEGER ;



#pragma warning(push)

#pragma warning(disable:4035)
__inline ULONGLONG __stdcall Int64ShllMod32___1(ULONGLONG Value , ULONG
	ShiftCount )
{
	
/*
	__asm {
        mov     ecx, ShiftCount
        mov     eax, dword ptr [Value]
        mov     edx, dword ptr [Value+4]
        shld    edx, eax, cl
        shl     eax, cl
    
		};
*/
}


__inline LONGLONG __stdcall Int64ShraMod32___1(LONGLONG Value , ULONG ShiftCount
	)
{
	
/*
	__asm {
        mov     ecx, ShiftCount
        mov     eax, dword ptr [Value]
        mov     edx, dword ptr [Value+4]
        shrd    eax, edx, cl
        sar     edx, cl
    
		};
*/
}


__inline ULONGLONG __stdcall Int64ShrlMod32___1(ULONGLONG Value , ULONG
	ShiftCount )
{
	
/*
	__asm {
        mov     ecx, ShiftCount
        mov     eax, dword ptr [Value]
        mov     edx, dword ptr [Value+4]
        shrd    eax, edx, cl
        shr     edx, cl
    
		};
*/
}


#pragma warning(pop)

typedef enum _EVENT_TYPE ;


typedef enum _TIMER_TYPE ;


typedef enum _WAIT_TYPE ;


typedef CHAR ;


typedef const char ;


typedef struct _STRING ;


typedef STRING ;

typedef STRING ;


typedef PSTRING ;

typedef STRING ;


typedef PSTRING ;


typedef struct _CSTRING ;


typedef CSTRING ;


typedef STRING ;


typedef PSTRING ;


typedef struct _UNICODE_STRING ;


typedef UNICODE_STRING ;


typedef const UNICODE_STRING ;


typedef UCHAR ;


typedef BOOLEAN ;


typedef struct _LIST_ENTRY ;


typedef struct _SINGLE_LIST_ENTRY ;


typedef struct LIST_ENTRY32 ;


typedef LIST_ENTRY32 ;

typedef struct LIST_ENTRY64 ;


typedef LIST_ENTRY64 ;


typedef struct _STRING32 ;


typedef STRING32 ;

typedef STRING32 ;


typedef UNICODE_STRING32 ;

typedef STRING32 ;


typedef ANSI_STRING32 ;


typedef struct _STRING64 ;


typedef STRING64 ;

typedef STRING64 ;


typedef UNICODE_STRING64 ;

typedef STRING64 ;


typedef ANSI_STRING64 ;


typedef struct _OBJECT_ATTRIBUTES ;


typedef OBJECT_ATTRIBUTES ;


typedef struct _GUID ;


typedef GUID ;


typedef const GUID ;


typedef GUID ;


typedef IID ;


typedef GUID ;


typedef CLSID ;


typedef GUID ;


typedef FMTID ;



#pragma once

typedef unsigned int ;


typedef struct _OBJECTID ;


struct _CONTEXT ;


struct _EXCEPTION_RECORD ;

typedef EXCEPTION_DISPOSITION ;


typedef UCHAR ;

typedef KIRQL ;


typedef enum _NT_PRODUCT_TYPE ;


typedef enum _SUITE_TYPE ;


typedef struct _KTHREAD ;


typedef struct _ETHREAD ;


typedef struct _EPROCESS ;


typedef struct _PEB ;


typedef struct _KINTERRUPT ;


typedef struct _IO_TIMER ;


typedef struct _OBJECT_TYPE ;


typedef struct _CALLBACK_OBJECT ;


typedef struct _DEVICE_HANDLER_OBJECT ;


typedef struct _BUS_HANDLER ;


typedef union _SLIST_HEADER ;


typedef CCHAR ;

typedef enum _MODE ;


struct _KAPC ;

typedef void ;


typedef void ;


typedef void ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef struct _KAPC ;


struct _KDPC ;

typedef void ;


typedef enum _KDPC_IMPORTANCE ;


typedef struct _KDPC ;


typedef PVOID ;

typedef void ;


typedef struct _KIPI_COUNTS ;


typedef struct _MDL ;


typedef PVOID ;


typedef PVOID ;


typedef PVOID ;

typedef ULONG ;


typedef ACCESS_MASK ;


typedef struct _GENERIC_MAPPING ;


typedef GENERIC_MAPPING ;



#pragma warning(disable:4103)

#pragma pack(push, 4)

typedef struct _LUID_AND_ATTRIBUTES ;


typedef LUID_AND_ATTRIBUTES ;


typedef LUID_AND_ATTRIBUTES_ARRAY ;



#pragma warning(disable:4103)

#pragma pack(pop)

typedef struct _ACL ;


typedef ACL ;


typedef struct _PRIVILEGE_SET ;


typedef enum _SECURITY_IMPERSONATION_LEVEL ;


typedef BOOLEAN ;


typedef struct _SECURITY_QUALITY_OF_SERVICE ;


typedef struct _SE_IMPERSONATION_STATE ;


typedef ULONG ;


typedef ULONG ;


typedef KAFFINITY ;


typedef LONG ;


typedef ULONG_PTR ;


typedef KSPIN_LOCK ;


typedef void ;


typedef enum _KPROFILE_SOURCE ;


typedef NTSTATUS ;


typedef struct _RTL_QUERY_REGISTRY_TABLE ;



#pragma warning(push)

#pragma warning(disable:4035)


#pragma warning(pop)

typedef struct _TIME_FIELDS ;


typedef TIME_FIELDS ;


typedef struct _RTL_BITMAP ;


typedef RTL_BITMAP ;


typedef struct _RTL_BITMAP_RUN ;


typedef RTL_BITMAP_RUN ;


typedef struct _RTL_RANGE ;


typedef struct _RTL_RANGE_LIST ;


typedef struct _RANGE_LIST_ITERATOR ;


typedef BOOLEAN ;


typedef struct _OSVERSIONINFOA ;


typedef struct _OSVERSIONINFOW ;


typedef OSVERSIONINFOA ;


typedef POSVERSIONINFOA ;


typedef LPOSVERSIONINFOA ;


typedef struct _OSVERSIONINFOEXA ;


typedef struct _OSVERSIONINFOEXW ;


typedef OSVERSIONINFOEXA ;


typedef POSVERSIONINFOEXA ;


typedef LPOSVERSIONINFOEXA ;


typedef struct _IO_STATUS_BLOCK ;


typedef void ;


typedef enum _FILE_INFORMATION_CLASS ;


typedef struct _FILE_BASIC_INFORMATION ;


typedef struct _FILE_STANDARD_INFORMATION ;


typedef struct _FILE_POSITION_INFORMATION ;


typedef struct _FILE_ALIGNMENT_INFORMATION ;


typedef struct _FILE_NAME_INFORMATION ;


typedef struct _FILE_NETWORK_OPEN_INFORMATION ;


typedef struct _FILE_ATTRIBUTE_TAG_INFORMATION ;


typedef struct _FILE_DISPOSITION_INFORMATION ;


typedef struct _FILE_END_OF_FILE_INFORMATION ;


typedef struct _FILE_FULL_EA_INFORMATION ;


typedef enum _FSINFOCLASS ;


typedef struct _FILE_FS_DEVICE_INFORMATION ;


typedef union _FILE_SEGMENT_ELEMENT ;


typedef enum _INTERFACE_TYPE ;


typedef enum _DMA_WIDTH ;


typedef enum _DMA_SPEED ;


typedef void ;


typedef void ;


typedef enum _BUS_DATA_TYPE ;


typedef struct _IO_ERROR_LOG_PACKET ;


typedef struct _IO_ERROR_LOG_MESSAGE ;


typedef struct _KEY_BASIC_INFORMATION ;


typedef struct _KEY_NODE_INFORMATION ;


typedef struct _KEY_FULL_INFORMATION ;


typedef struct _KEY_NAME_INFORMATION ;


typedef enum _KEY_INFORMATION_CLASS ;


typedef struct _KEY_WRITE_TIME_INFORMATION ;


typedef enum _KEY_SET_INFORMATION_CLASS ;


typedef struct _KEY_VALUE_BASIC_INFORMATION ;


typedef struct _KEY_VALUE_FULL_INFORMATION ;


typedef struct _KEY_VALUE_PARTIAL_INFORMATION ;


typedef struct _KEY_VALUE_PARTIAL_INFORMATION_ALIGN64 ;


typedef struct _KEY_VALUE_ENTRY ;


typedef enum _KEY_VALUE_INFORMATION_CLASS ;


typedef struct _OBJECT_NAME_INFORMATION ;


typedef enum _SECTION_INHERIT ;


typedef struct _CLIENT_ID ;


typedef CLIENT_ID ;


typedef struct _NT_TIB ;


typedef NT_TIB ;


typedef enum _PROCESSINFOCLASS ;


typedef enum _THREADINFOCLASS ;


typedef struct _PROCESS_WS_WATCH_INFORMATION ;


typedef struct _PROCESS_BASIC_INFORMATION ;


typedef PROCESS_BASIC_INFORMATION ;


typedef struct _PROCESS_DEVICEMAP_INFORMATION ;


typedef struct _PROCESS_SESSION_INFORMATION ;


typedef struct _QUOTA_LIMITS ;


typedef QUOTA_LIMITS ;


typedef struct _IO_COUNTERS ;


typedef IO_COUNTERS ;


typedef struct _VM_COUNTERS ;


typedef VM_COUNTERS ;


typedef struct _POOLED_USAGE_AND_LIMITS ;


typedef POOLED_USAGE_AND_LIMITS ;


typedef struct _PROCESS_ACCESS_TOKEN ;


typedef struct _KERNEL_USER_TIMES ;


typedef KERNEL_USER_TIMES ;


typedef enum _SYSTEM_POWER_STATE ;



typedef enum _DEVICE_POWER_STATE ;


typedef union _POWER_STATE ;


typedef enum _POWER_STATE_TYPE ;


typedef ULONG ;


typedef ULONG ;

typedef LONG ;


typedef ULONG ;


typedef union _MCI_STATS ;


typedef struct _KPCR ;


typedef KPCR ;


typedef struct _KFLOATING_SAVE ;


typedef enum _INTERLOCKED_RESULT ;



#pragma warning(disable:4035)

typedef struct _KSYSTEM_TIME ;



#pragma warning(push)

#pragma warning(disable:4164)


#pragma function(_enable)


#pragma function(_disable)


#pragma warning(pop)

typedef struct _FLOATING_SAVE_AREA ;


typedef FLOATING_SAVE_AREA ;


typedef struct _CONTEXT ;


typedef CONTEXT ;


typedef void ;


typedef enum _ALTERNATIVE_ARCHITECTURE_TYPE ;


typedef struct _KUSER_SHARED_DATA ;


typedef enum _CM_SERVICE_NODE_TYPE ;


typedef enum _CM_SERVICE_LOAD_TYPE ;


typedef enum _CM_ERROR_CONTROL_TYPE ;


typedef int ;


typedef enum _CM_SHARE_DISPOSITION ;


typedef PVOID ;



#pragma warning(disable:4103)

#pragma pack(push, 4)

typedef struct _CM_PARTIAL_RESOURCE_DESCRIPTOR ;



#pragma warning(disable:4103)

#pragma pack(pop)

typedef struct _CM_PARTIAL_RESOURCE_LIST ;


typedef struct _CM_FULL_RESOURCE_DESCRIPTOR ;


typedef struct _CM_RESOURCE_LIST ;


typedef struct _DEVICE_FLAGS ;


typedef struct _CM_COMPONENT_INFORMATION ;


typedef struct _CM_ROM_BLOCK ;



#pragma warning(disable:4103)

#pragma pack(push, 1)

typedef struct _CM_INT13_DRIVE_PARAMETER ;


typedef struct _CM_MCA_POS_DATA ;


typedef struct _EISA_MEMORY_TYPE ;


typedef struct _EISA_MEMORY_CONFIGURATION ;


typedef struct _EISA_IRQ_DESCRIPTOR ;


typedef struct _EISA_IRQ_CONFIGURATION ;


typedef struct _DMA_CONFIGURATION_BYTE0 ;


typedef struct _DMA_CONFIGURATION_BYTE1 ;


typedef struct _EISA_DMA_CONFIGURATION ;


typedef struct _EISA_PORT_DESCRIPTOR ;


typedef struct _EISA_PORT_CONFIGURATION ;


typedef struct _CM_EISA_SLOT_INFORMATION ;


typedef struct _CM_EISA_FUNCTION_INFORMATION ;


typedef struct _CM_PNP_BIOS_DEVICE_NODE ;


typedef struct _CM_PNP_BIOS_INSTALLATION_CHECK ;



#pragma warning(disable:4103)

#pragma pack(pop)

typedef struct _CM_SCSI_DEVICE_DATA ;


typedef struct _CM_VIDEO_DEVICE_DATA ;


typedef struct _CM_SONIC_DEVICE_DATA ;


typedef struct _CM_SERIAL_DEVICE_DATA ;


typedef struct _CM_MONITOR_DEVICE_DATA ;


typedef struct _CM_FLOPPY_DEVICE_DATA ;


typedef struct _CM_KEYBOARD_DEVICE_DATA ;


typedef struct _CM_DISK_GEOMETRY_DEVICE_DATA ;


typedef struct _CM_PCCARD_DEVICE_DATA ;


typedef struct _IO_RESOURCE_DESCRIPTOR ;


typedef struct _IO_RESOURCE_LIST ;


typedef struct _IO_RESOURCE_REQUIREMENTS_LIST ;


typedef struct _EXCEPTION_RECORD ;


typedef EXCEPTION_RECORD ;

typedef struct _EXCEPTION_RECORD32 ;


typedef struct _EXCEPTION_RECORD64 ;


typedef struct _EXCEPTION_POINTERS ;


typedef enum _CONFIGURATION_TYPE ;


typedef enum _KINTERRUPT_MODE ;


typedef enum _KWAIT_REASON ;


typedef struct _DISPATCHER_HEADER ;


typedef struct _KWAIT_BLOCK ;


typedef void ;


typedef struct _KDEVICE_QUEUE ;


typedef struct _KDEVICE_QUEUE_ENTRY ;


typedef struct _KEVENT ;


typedef BOOLEAN ;


typedef struct _KMUTANT ;


typedef struct _KSEMAPHORE ;


typedef struct _KTIMER ;


typedef enum _KBUGCHECK_BUFFER_DUMP_STATE ;


typedef void ;


typedef struct _KBUGCHECK_CALLBACK_RECORD ;


typedef void ;


typedef LOGICAL ;


typedef void ;


typedef enum _MEMORY_CACHING_TYPE_ORIG ;


typedef enum _MEMORY_CACHING_TYPE ;


typedef struct _DBGKD_DEBUG_DATA_HEADER64 ;


typedef enum _POOL_TYPE ;


typedef enum _EX_POOL_PRIORITY ;


typedef struct _FAST_MUTEX ;


typedef PVOID ;


typedef void ;


typedef struct _GENERAL_LOOKASIDE ;


typedef struct _NPAGED_LOOKASIDE_LIST ;


typedef struct _PAGED_LOOKASIDE_LIST ;


typedef enum _WORK_QUEUE_TYPE ;


typedef void ;


typedef struct _WORK_QUEUE_ITEM ;


typedef struct _ZONE_SEGMENT_HEADER ;


typedef struct _ZONE_HEADER ;


typedef ULONG_PTR ;


typedef ERESOURCE_THREAD ;

typedef struct _OWNER_ENTRY ;


typedef struct _ERESOURCE ;


typedef struct _RESOURCE_HASH_ENTRY ;


typedef struct _RESOURCE_PERFORMANCE_DATA ;


typedef struct _CALLBACK_OBJECT ;

typedef void ;


typedef GUID ;


typedef enum _MM_SYSTEM_SIZE ;


typedef enum _LOCK_OPERATION ;


typedef enum _MM_PAGE_PRIORITY ;


typedef struct _PHYSICAL_MEMORY_RANGE ;


typedef NTSTATUS ;


typedef NTSTATUS ;


struct _DRIVER_OBJECT ;


typedef enum _SECURITY_OPERATION_CODE ;


typedef struct _SECURITY_SUBJECT_CONTEXT ;


typedef struct _INITIAL_PRIVILEGE_SET ;


typedef struct _ACCESS_STATE ;


typedef void ;


typedef void ;


typedef struct _IMAGE_INFO ;


typedef void ;


typedef NTSTATUS ;


typedef enum _IO_QUERY_DEVICE_DATA_FORMAT ;


typedef enum _CREATE_FILE_TYPE ;


struct _DEVICE_DESCRIPTION ;


struct _DEVICE_OBJECT ;


struct _DMA_ADAPTER ;


struct _DRIVER_OBJECT ;


struct _DRIVE_LAYOUT_INFORMATION ;


struct _DISK_PARTITION ;


struct _FILE_OBJECT ;


struct _IRP ;


struct _SCSI_REQUEST_BLOCK ;


typedef void ;


typedef void ;


typedef NTSTATUS ;


typedef void ;


typedef void ;


typedef NTSTATUS ;


typedef void ;


typedef void ;


typedef NTSTATUS ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef void ;


typedef void ;


typedef void ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef BOOLEAN ;


typedef struct _FAST_IO_DISPATCH ;


typedef enum _IO_ALLOCATION_ACTION ;


typedef IO_ALLOCATION_ACTION ;


typedef struct _IO_SECURITY_CONTEXT ;


typedef struct _VPB ;


typedef struct _ADAPTER_OBJECT ;


typedef struct _WAIT_CONTEXT_BLOCK ;


typedef struct _CONTROLLER_OBJECT ;


typedef struct _DEVICE_OBJECT ;


typedef struct _DEVICE_OBJECT ;


struct _DEVICE_OBJECT_POWER_EXTENSION ;

typedef struct _DEVOBJ_EXTENSION ;


typedef struct _DRIVER_EXTENSION ;


typedef struct _DRIVER_OBJECT ;


typedef struct _DRIVER_OBJECT ;


typedef struct _SECTION_OBJECT_POINTERS ;


typedef SECTION_OBJECT_POINTERS ;


typedef struct _IO_COMPLETION_CONTEXT ;


typedef struct _FILE_OBJECT ;


typedef struct _FILE_OBJECT ;


typedef struct _IRP ;


typedef NTSTATUS ;


typedef enum _DEVICE_RELATION_TYPE ;


typedef struct _DEVICE_RELATIONS ;


typedef enum _DEVICE_USAGE_NOTIFICATION_TYPE ;


typedef struct _INTERFACE ;


typedef struct _DEVICE_CAPABILITIES ;


typedef struct _POWER_SEQUENCE ;



typedef ULONG ;





#pragma warning(disable:4103)

#pragma pack(push, 4)

typedef struct _IO_STACK_LOCATION ;



#pragma warning(disable:4103)

#pragma pack(pop)

typedef struct _SHARE_ACCESS ;


typedef struct _CONFIGURATION_INFORMATION ;


typedef struct _BOOTDISK_INFORMATION ;


typedef struct _IO_REMOVE_LOCK_TRACKING_BLOCK ;

typedef struct _IO_REMOVE_LOCK_COMMON_BLOCK ;


typedef struct _IO_REMOVE_LOCK_DBG_BLOCK ;


typedef struct _IO_REMOVE_LOCK ;


typedef struct _IO_WORKITEM ;

typedef void ;



typedef BOOLEAN ;


typedef struct _DMA_ADAPTER ;


typedef ULONG ;


typedef struct _PNP_BUS_INFORMATION ;


typedef struct _LEGACY_BUS_INFORMATION ;


typedef struct _BUS_INTERFACE_STANDARD ;


typedef BOOLEAN ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef void ;


typedef NTSTATUS ;


typedef void ;


typedef struct _ACPI_INTERFACE_STANDARD ;


typedef enum _ACPI_REG_TYPE ;


typedef USHORT ;


typedef void ;


typedef struct ACPI_REGS_INTERFACE_STANDARD ;


typedef struct  {
	PVOID LinkNode ;
	ULONG StaticVector ;
	UCHAR Flags ;
} ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef void ;


typedef struct _INT_ROUTE_INTERFACE_STANDARD ;


typedef struct _IO_ASSIGNED_RESOURCES ;


typedef enum _IO_NOTIFICATION_EVENT_CATEGORY ;


typedef NTSTATUS ;


typedef void ;


typedef enum _ARBITER_ACTION ;


typedef struct _ARBITER_CONFLICT_INFO ;


typedef struct _ARBITER_PARAMETERS ;


typedef enum _ARBITER_REQUEST_SOURCE ;


typedef enum _ARBITER_RESULT ;


typedef struct _ARBITER_LIST_ENTRY ;


typedef NTSTATUS ;


typedef struct _ARBITER_INTERFACE ;


typedef enum _RESOURCE_TRANSLATION_DIRECTION ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef struct _TRANSLATOR_INTERFACE ;


typedef NTSTATUS ;


typedef struct _LEGACY_DEVICE_DETECTION_INTERFACE ;


typedef struct _PLUGPLAY_NOTIFICATION_HEADER ;


typedef struct _HWPROFILE_CHANGE_NOTIFICATION ;


typedef struct _DEVICE_INTERFACE_CHANGE_NOTIFICATION ;


typedef struct _TARGET_DEVICE_REMOVAL_NOTIFICATION ;


typedef struct _TARGET_DEVICE_CUSTOM_NOTIFICATION ;


typedef struct _DEVICE_DESCRIPTION ;


typedef BOOLEAN ;


typedef void ;


typedef struct _DEVICE_CONTROL_CONTEXT ;


typedef PBUS_HANDLER ;


typedef void ;


typedef enum _HAL_QUERY_INFORMATION_CLASS ;


typedef enum _HAL_SET_INFORMATION_CLASS ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef void ;


typedef void ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef NTSTATUS ;


typedef struct _PM_DISPATCH_TABLE ;


typedef NTSTATUS ;


typedef struct _DMA_ADAPTER ;


typedef NTSTATUS ;


typedef BOOLEAN ;


typedef NTSTATUS ;


typedef void ;


typedef void ;


typedef BOOLEAN ;


typedef struct  {
	ULONG Version ;
	pHalQuerySystemInformation HalQuerySystemInformation ;
	pHalSetSystemInformation HalSetSystemInformation ;
	pHalQueryBusSlots HalQueryBusSlots ;
	ULONG Spare1 ;
	pHalExamineMBR HalExamineMBR ;
	pHalIoAssignDriveLetters HalIoAssignDriveLetters ;
	pHalIoReadPartitionTable HalIoReadPartitionTable ;
	pHalIoSetPartitionInformation HalIoSetPartitionInformation ;
	pHalIoWritePartitionTable HalIoWritePartitionTable ;
	pHalHandlerForBus HalReferenceHandlerForBus ;
	pHalReferenceBusHandler HalReferenceBusHandler ;
	pHalReferenceBusHandler HalDereferenceBusHandler ;
	pHalInitPnpDriver HalInitPnpDriver ;
	pHalInitPowerManagement HalInitPowerManagement ;
	pHalGetDmaAdapter HalGetDmaAdapter ;
	pHalGetInterruptTranslator HalGetInterruptTranslator ;
} ;


typedef struct _HAL_BUS_INFORMATION ;


typedef struct _HAL_PROFILE_SOURCE_INFORMATION ;


typedef struct _HAL_PROFILE_SOURCE_INTERVAL ;


typedef enum _HAL_DISPLAY_BIOS_INFORMATION ;


typedef struct _HAL_POWER_INFORMATION ;


typedef struct _HAL_PROCESSOR_SPEED_INFO ;


typedef struct _HAL_CALLBACKS ;


typedef struct _HAL_PROCESSOR_FEATURE ;


typedef union _MCI_ADDR ;




typedef struct _MCA_EXCEPTION ;


typedef void ;


typedef struct _MCA_DRIVER_INFO ;


typedef struct _SCATTER_GATHER_ELEMENT ;



#pragma warning(disable:4200)

typedef struct _SCATTER_GATHER_LIST ;



#pragma warning(default:4200)

typedef struct _DMA_OPERATIONS ;

typedef struct _DMA_ADAPTER ;


typedef void ;


typedef PVOID ;


typedef void ;


typedef NTSTATUS ;


typedef BOOLEAN ;


typedef void ;


typedef void ;


typedef PHYSICAL_ADDRESS ;


typedef ULONG ;


typedef ULONG ;


typedef void ;


typedef NTSTATUS ;


typedef void ;


typedef struct _DMA_OPERATIONS ;


typedef void ;


typedef struct _OBJECT_HANDLE_INFORMATION ;


typedef struct _PCI_SLOT_NUMBER ;


typedef struct _PCI_COMMON_CONFIG ;


typedef struct _PCI_CAPABILITIES_HEADER ;


typedef struct _PCI_PMC ;


typedef struct _PCI_PMCSR ;


typedef struct _PCI_PMCSR_BSE ;


typedef struct _PCI_PM_CAPABILITY ;


typedef struct _PCI_AGP_CAPABILITY ;


typedef struct _PCI_MSI_CAPABILITY ;


typedef void ;


typedef void ;


typedef void ;


typedef struct _PCIBUSDATA ;


typedef ULONG ;


typedef void ;


typedef void ;


typedef struct _PCI_BUS_INTERFACE_STANDARD ;


typedef BOOLEAN ;


typedef struct _PCI_DEVICE_PRESENT_INTERFACE ;


extern int s ;
extern int pended ;
extern PIO_COMPLETION_ROUTINE compFptr ;
extern int compRegistered ;
extern int lowerDriverReturn ;
extern int setEventCalled ;
extern int customIrp ;

extern void _BLAST_init() ;

extern NTSTATUS DriverEntry(PDRIVER_OBJECT , PUNICODE_STRING ) ;


void stub_driver_init()
{
	s = NP;
	pended = 0;
	compFptr = 0;
	compRegistered = 0;
	lowerDriverReturn = 0;
	setEventCalled = 0;
	customIrp = 0;
}

int main()
{
	
	DRIVER_OBJECT d ;
	UNICODE_STRING u ;
	NTSTATUS status ;
	int we_should_unload ;
	IRP pirp_obj;
	girp = pirp_obj;
	
	//_BLAST_init();
	
	//status = DriverEntry(& d, & u);
	
	if((NTSTATUS )status >= 0)
	{
		
		int __BLAST_NONDET ;
		int idx ;
		int irp_choice ;
		DEVICE_OBJECT devobj ;
		
		//extern NTSTATUS KbFilter_AddDevice(PDRIVER_OBJECT ,
		//	PDEVICE_OBJECT ) ;
		
		s = NP;
		pended = (compFptr = (compRegistered = (lowerDriverReturn =
			(setEventCalled = (customIrp = 0)))));
		
		(girp.IoStatus).Status = (NTSTATUS )0x00000000L;
		myStatus = (NTSTATUS )0x00000000L;
		
		if(irp_choice == 0)
		{
			
			(girp.IoStatus).Status = (NTSTATUS )0xC00000BBL;
			myStatus = (NTSTATUS )0xC00000BBL;
		}
		
		//status = KbFilter_AddDevice(& d, & devobj);
		
		stub_driver_init();
		
		if(! ((NTSTATUS )status >= 0))
			
			return - 1;
		
		switch(__BLAST_NONDET)
		{
		case 0:
				
				;
			{
				
				//extern NTSTATUS
				//	KbFilter_CreateClose(PDEVICE_OBJECT ) ;
				
				//status = KbFilter_CreateClose(& devobj);
			}
			
			break;
			
		case 1:
				
				;
			{
				
				//extern NTSTATUS
				//	KbFilter_CreateClose(PDEVICE_OBJECT ) ;
				
				//status = KbFilter_CreateClose(& devobj);
			}
			
			break;
			
		case 2:
				
				;
			{
				
				//extern NTSTATUS KbFilter_IoCtl(PDEVICE_OBJECT ) ;
				
				//status = KbFilter_IoCtl(& devobj);
			}
			
			break;
			
		case 3:
				
				;
			{
				
				extern NTSTATUS KbFilter_PnP(PDEVICE_OBJECT ) ;
				
				status = KbFilter_PnP(& devobj);
			}
			
			break;
			
		case 4:
				
				;
			{
				
				//extern NTSTATUS KbFilter_Power(PDEVICE_OBJECT) ;
				
				//status = KbFilter_Power(& devobj);
			}
			
			break;
			
		case 8:
				
				;
			{
				
				//extern NTSTATUS
				//	KbFilter_InternIoCtl(PDEVICE_OBJECT ) ;
				
				//status = KbFilter_InternIoCtl(& devobj);
			}
			
			break;
			
		default :
				
				;
			return - 1;
		}
		
		if(we_should_unload)
		{
			
			extern void KbFilter_Unload(PDRIVER_OBJECT ) ;
			//KbFilter_Unload(& d);
		}
	}
	
/*	RETPT:
	{
		
		if(pended == 1 && s == NP)
		{
			
			s = NP;
		}
		else
		{
			
			if(pended == 1 && s == MPR3)
			{
				
				s = MPR3;
			}
			else
			{
				
				if(s == UNLOADED || status == - 1)
				{
					
					;
				}
				else
				{
					
					if(s != SKIP2 && s != IPC && s != DC)
						
			;//BLAST slice			assert(0); //BUG 2
					else
					{
						
						if(pended == 1)
						{
							
							if(status != 259)
	
                 ;//	assert(0);
						}
						else
						{
							
							if(s == DC)
							{
	
	if(status == 259)
		
		 ; //BLAST slice assert(0); //BUG 1
							}
							else
							{
	
	if(status != lowerDriverReturn)
		
	;//BLAST sliced	assert(0);
							}
						}
					}
				}
			}
		}
	}*/
	return status;
}

char _SLAM_alloc_dummy ;

char *  malloc(int i )
{
	
	int __BLAST_NONDET ;
	
	if(__BLAST_NONDET)
	{
		
		return (char *  )0;
	}
	else
		
		return (char *  )1;
}


__declspec(dllimport) void ExAcquireFastMutex(PFAST_MUTEX FastMutex )
{
	
	return;
}

__declspec(dllimport) void ExReleaseFastMutex(PFAST_MUTEX FastMutex )
{
	
	return;
}


__declspec(dllimport) PVOID __stdcall ExAllocatePoolWithTag(POOL_TYPE PoolType ,
	SIZE_T NumberOfBytes , ULONG Tag )
{
	
	PVOID x ;
	x = malloc(NumberOfBytes);
	return x;
}


__declspec(dllimport) void __stdcall ExFreePool(PVOID P )
{
	
	return;
}

__declspec(dllimport) PLIST_ENTRY ExfInterlockedInsertHeadList(PLIST_ENTRY
	ListHead , PLIST_ENTRY ListEntry , PKSPIN_LOCK Lock )
{
	
	return (void *  )0;
}

__declspec(dllimport) PLIST_ENTRY ExfInterlockedInsertTailList(PLIST_ENTRY
	ListHead , PLIST_ENTRY ListEntry , PKSPIN_LOCK Lock )
{
	
	return (void *  )0;
}

__declspec(dllimport) PLIST_ENTRY ExfInterlockedRemoveHeadList(PLIST_ENTRY
	ListHead , PKSPIN_LOCK Lock )
{
	
	return (void *  )0;
}


__declspec(dllimport) PMDL IoAllocateMdl(PVOID VirtualAddress , ULONG Length ,
	BOOLEAN SecondaryBuffer , BOOLEAN ChargeQuota , PIRP Irp )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (void *  )malloc(sizeof(MDL ));
	default :
			
			;
		
		return (void *  )0;
	}
}

__declspec(dllimport) PDEVICE_OBJECT IoAttachDeviceToDeviceStack(PDEVICE_OBJECT
	SourceDevice , PDEVICE_OBJECT TargetDevice )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return TargetDevice;
	default :
			
			;
		
		return (void *  )0;
	}
}

__declspec(dllimport) PIRP IoBuildAsynchronousFsdRequest(ULONG MajorFunction ,
	PDEVICE_OBJECT DeviceObject , PVOID Buffer , ULONG Length ,
	PLARGE_INTEGER StartingOffset , PIO_STATUS_BLOCK IoStatusBlock )
{
	
	int __BLAST_NONDET ;
	customIrp = 1;
	
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (void *  )malloc(sizeof(IRP ));
	default :
			
			;
		
		return (void *  )0;
	}
}


__declspec(dllimport) PIRP IoBuildDeviceIoControlRequest(ULONG IoControlCode ,
	PDEVICE_OBJECT DeviceObject , PVOID InputBuffer , ULONG
	InputBufferLength , PVOID OutputBuffer , ULONG OutputBufferLength ,
	BOOLEAN InternalDeviceIoControl , PKEVENT Event , PIO_STATUS_BLOCK
	IoStatusBlock )
{
	
	int __BLAST_NONDET ;
	customIrp = 1;
	
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (void *  )malloc(sizeof(IRP ));
	default :
			
			;
		
		return (void *  )0;
	}
}

__declspec(dllimport) NTSTATUS IoCreateDevice(PDRIVER_OBJECT DriverObject ,
	ULONG DeviceExtensionSize , PUNICODE_STRING DeviceName , ULONG
	DeviceType , ULONG DeviceCharacteristics , BOOLEAN Exclusive ,
	PDEVICE_OBJECT *  DeviceObject )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		* DeviceObject = (void *  )malloc(sizeof(DEVICE_OBJECT ));
		return (NTSTATUS )0x00000000L;
		
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}


__declspec(dllimport) NTSTATUS IoCreateSymbolicLink(PUNICODE_STRING
	SymbolicLinkName , PUNICODE_STRING DeviceName )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}

__declspec(dllimport) void IoDeleteDevice(PDEVICE_OBJECT DeviceObject )
{
}


__declspec(dllimport) NTSTATUS IoDeleteSymbolicLink(PUNICODE_STRING
	SymbolicLinkName )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}

__declspec(dllimport) void IoDetachDevice(PDEVICE_OBJECT TargetDevice )
{
}


__declspec(dllimport) void IoFreeIrp(PIRP Irp )
{
}


__declspec(dllimport) void IoFreeMdl(PMDL Mdl )
{
}


__declspec(dllimport) PCONFIGURATION_INFORMATION
	IoGetConfigurationInformation(void  )
{
	
	return (void *  )malloc(sizeof(CONFIGURATION_INFORMATION ));
}

__declspec(dllimport) NTSTATUS IoQueryDeviceDescription(PINTERFACE_TYPE BusType
	, PULONG BusNumber , PCONFIGURATION_TYPE ControllerType , PULONG
	ControllerNumber , PCONFIGURATION_TYPE PeripheralType , PULONG
	PeripheralNumber , PIO_QUERY_DEVICE_ROUTINE CalloutRoutine , PVOID
	Context )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}

__declspec(dllimport) NTSTATUS __stdcall
	IoRegisterDeviceInterface(PDEVICE_OBJECT PhysicalDeviceObject , const
	GUID *  InterfaceClassGuid , PUNICODE_STRING ReferenceString ,
	PUNICODE_STRING SymbolicLinkName )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
	default :
			
			;
		
		return (NTSTATUS )0xC0000010L;
	}
}

__declspec(dllimport) void IoReleaseCancelSpinLock(KIRQL Irql )
{
}


__declspec(dllimport) NTSTATUS IoSetDeviceInterfaceState(PUNICODE_STRING
	SymbolicLinkName , BOOLEAN Enable )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
		
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}


__declspec(dllimport) void IoSetHardErrorOrVerifyDevice(PIRP Irp ,
	PDEVICE_OBJECT DeviceObject )
{
}


void stubMoreProcessingRequired()
{
	
	if(s == NP)
		
		s = MPR1;
	else
		
		;//assert(0);
}

__declspec(dllimport) NTSTATUS IofCallDriver(PDEVICE_OBJECT DeviceObject )
{
	
	int __BLAST_NONDET ;
	NTSTATUS returnVal2 ;
	int compRetStatus ;
	PVOID lcontext ;
	
	if(compRegistered)
	{
		
/*
		compRetStatus = (* compFptr)(DeviceObject, Irp, lcontext);
*/
		compRetStatus = KbFilter_Complete(DeviceObject,  lcontext);
		if(compRetStatus == (NTSTATUS )0xC0000016L)
			
			stubMoreProcessingRequired();
	}
	
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		returnVal2 = (NTSTATUS )0x00000000L;
		
		break;
		
	case 1:
			
			;
		
		returnVal2 = (NTSTATUS )0xC0000001L;
		
		break;
		
	default :
			
			;
		
		returnVal2 = (NTSTATUS )0x00000103L;
		
		break;
	}
	if(s == NP)
	{
		
		s = IPC;
		
		lowerDriverReturn = returnVal2;
	}
	else
	{
		
		if(s == MPR1)
		{
			
			if(returnVal2 == 259)
			{
				
				s = MPR3;
				
				lowerDriverReturn = returnVal2;
			}
			else
			{
				
				s = NP;
				
				lowerDriverReturn = returnVal2;
			}
		}
		else
		{
			
			if(s == SKIP1)
			{
				
				s = SKIP2;
				
				lowerDriverReturn = returnVal2;
			}
			else
				
				;//assert(0);
		}
	}
	return returnVal2;
}


__declspec(dllimport) void IofCompleteRequest( CCHAR PriorityBoost )
{
	int f = 0;
	if(s != NP)
		
		s = DC;
	else
		
		assert(0);
}

__declspec(dllimport) KIRQL KeAcquireSpinLockRaiseToDpc(PKSPIN_LOCK SpinLock )
{
}


__declspec(dllimport) NTSTATUS KeDelayExecutionThread(KPROCESSOR_MODE WaitMode ,
	BOOLEAN Alertable , PLARGE_INTEGER Interval )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
		
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}


__declspec(dllimport) void KeInitializeEvent(PRKEVENT Event , EVENT_TYPE Type ,
	BOOLEAN State )
{
}


__declspec(dllimport) void KeInitializeSemaphore(PRKSEMAPHORE Semaphore , LONG
	Count , LONG Limit )
{
}


__declspec(dllimport) void __stdcall KeInitializeSpinLock(PKSPIN_LOCK SpinLock )
{
}


__declspec(dllimport) LONG KeReleaseSemaphore(PRKSEMAPHORE Semaphore , KPRIORITY
	Increment , LONG Adjustment , BOOLEAN Wait )
{
	
	LONG r ;
	return r;
}

__declspec(dllimport) void KfReleaseSpinLock(PKSPIN_LOCK SpinLock , KIRQL
	NewIrql )
{
}


__declspec(dllimport) LONG KeSetEvent(PRKEVENT Event , KPRIORITY Increment ,
	BOOLEAN Wait )
{
	
	LONG l ;
	
	setEventCalled = 1;
	
	return l;
}

__declspec(dllimport) NTSTATUS KeWaitForSingleObject(PVOID Object , KWAIT_REASON
	WaitReason , KPROCESSOR_MODE WaitMode , BOOLEAN Alertable ,
	PLARGE_INTEGER Timeout )
{
	
	int __BLAST_NONDET ;
	if(s == MPR3 && setEventCalled == 1)
	{
		
		s = NP;
		
		setEventCalled = 0;
	}
	else
	{
		
		if(customIrp == 1)
		{
			
			s = NP;
			
			customIrp = 0;
		}
		else
		{
			
			if(s == MPR3)
				
				;//assert(0);
		}
	}
	
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
		
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}


__declspec(dllimport) PVOID MmAllocateContiguousMemory(SIZE_T NumberOfBytes ,
	PHYSICAL_ADDRESS HighestAcceptableAddress )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return malloc(NumberOfBytes);
	case 1:
			
			;
		
		return (void *  )0;
	}
}

__declspec(dllimport) void MmFreeContiguousMemory(PVOID BaseAddress )
{
}


__declspec(dllimport) PVOID MmMapLockedPagesSpecifyCache(PMDL
	MemoryDescriptorList , KPROCESSOR_MODE AccessMode , MEMORY_CACHING_TYPE
	CacheType , PVOID BaseAddress , ULONG BugCheckOnFailure ,
	MM_PAGE_PRIORITY Priority )
{
	
	return (void *  )0;
}

__declspec(dllimport) PVOID MmPageEntireDriver(PVOID AddressWithinSection )
{
	
	return (void *  )0;
}

__declspec(dllimport) void MmResetDriverPaging(PVOID AddressWithinSection )
{
}


__declspec(dllimport) void MmUnlockPages(PMDL MemoryDescriptorList )
{
}


__declspec(dllimport) NTSTATUS ObReferenceObjectByHandle(HANDLE Handle ,
	ACCESS_MASK DesiredAccess , POBJECT_TYPE ObjectType , KPROCESSOR_MODE
	AccessMode , PVOID *  Object , POBJECT_HANDLE_INFORMATION
	HandleInformation )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
		
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}


__declspec(dllimport) void ObfDereferenceObject(PVOID Object )
{
}


__declspec(dllimport) NTSTATUS PoCallDriver(PDEVICE_OBJECT DeviceObject )
{
	
	int __BLAST_NONDET ;
	int compRetStatus ;
	NTSTATUS returnVal ;
	
	PVOID lcontext ;
	
	if(compRegistered)
	{
		
/*
		compRetStatus = (* compFptr)(DeviceObject, Irp, lcontext);
*/
		compRetStatus = KbFilter_Complete(DeviceObject,  lcontext);
		if(compRetStatus == (NTSTATUS )0xC0000016L)
			
			stubMoreProcessingRequired();
	}
	
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		returnVal = (NTSTATUS )0x00000000L;
		break;
	case 1:
			
			;
		returnVal = (NTSTATUS )0xC0000001L;
		break;
	default :
			
			;
		returnVal = (NTSTATUS )0x00000103L;
		
		break;
	}
	if(s == NP)
	{
		
		s = IPC;
		
		lowerDriverReturn = returnVal;
	}
	else
	{
		
		if(s == MPR1)
		{
			
			if(returnVal == (NTSTATUS )0x00000103L)
			{
				
				s = MPR3;
				
				lowerDriverReturn = returnVal;
			}
			else
			{
				
				s = NP;
				
				lowerDriverReturn = returnVal;
			}
		}
		else
		{
			
			if(s == SKIP1) {
				
				s = SKIP2;
				lowerDriverReturn = returnVal;
			}
			else
				
				;//assert(0);
		}
	}
	return returnVal;
}

__declspec(dllimport) void PoStartNextPowerIrp()
{
}


__declspec(dllimport) NTSTATUS PsCreateSystemThread(PHANDLE ThreadHandle , ULONG
	DesiredAccess , POBJECT_ATTRIBUTES ObjectAttributes , HANDLE
	ProcessHandle , PCLIENT_ID ClientId , PKSTART_ROUTINE StartRoutine ,
	PVOID StartContext )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}

__declspec(dllimport) NTSTATUS PsTerminateSystemThread(NTSTATUS ExitStatus )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}


__declspec(dllimport) NTSTATUS __stdcall
	RtlAnsiStringToUnicodeString(PUNICODE_STRING DestinationString ,
	PANSI_STRING SourceString , BOOLEAN AllocateDestinationString )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}

__declspec(dllimport) SIZE_T __stdcall RtlCompareMemory(const void *  Source1 ,
	const void *  Source2 , SIZE_T Length )
{
	
	SIZE_T r ;
	return r;
}

__declspec(dllimport) void __stdcall RtlCopyUnicodeString(PUNICODE_STRING
	DestinationString , PUNICODE_STRING SourceString )
{
}


__declspec(dllimport) NTSTATUS __stdcall RtlDeleteRegistryValue(ULONG RelativeTo
	, PCWSTR Path , PCWSTR ValueName )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}

__declspec(dllimport) void __stdcall RtlFreeUnicodeString(PUNICODE_STRING
	UnicodeString )
{
}


__declspec(dllimport) void __stdcall RtlInitString(PSTRING DestinationString ,
	PCSZ SourceString )
{
}


__declspec(dllimport) void __stdcall RtlInitUnicodeString(PUNICODE_STRING
	DestinationString , PCWSTR SourceString )
{
}


__declspec(dllimport) NTSTATUS __stdcall RtlQueryRegistryValues(ULONG RelativeTo
	, PCWSTR Path , PRTL_QUERY_REGISTRY_TABLE QueryTable , PVOID Context ,
	PVOID Environment )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
		
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}

__declspec(dllimport) NTSTATUS __stdcall ZwClose(HANDLE Handle )
{
	
	int __BLAST_NONDET ;
	switch(__BLAST_NONDET)
	{
		
	case 0:
			
			;
		
		return (NTSTATUS )0x00000000L;
		
	default :
			
			;
		
		return (NTSTATUS )0xC0000001L;
	}
}

